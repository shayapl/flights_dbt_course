[0m22:00:23.578920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E941E2A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9454B610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E944A3190>]}


============================== 22:00:23.578920 | 20c02575-05e2-4c16-ba32-2b9714b6c15c ==============================
[0m22:00:23.578920 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:00:23.578920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:00:23.723973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20c02575-05e2-4c16-ba32-2b9714b6c15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E944A3ED0>]}
[0m22:00:23.761542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20c02575-05e2-4c16-ba32-2b9714b6c15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E94C16C90>]}
[0m22:00:23.761542 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m22:00:23.805491 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:00:23.806972 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:00:23.807488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20c02575-05e2-4c16-ba32-2b9714b6c15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E94C05D90>]}
[0m22:00:24.892335 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m22:00:24.910550 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m22:00:25.113638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20c02575-05e2-4c16-ba32-2b9714b6c15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E94F32B50>]}
[0m22:00:25.129285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20c02575-05e2-4c16-ba32-2b9714b6c15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E94F86E90>]}
[0m22:00:25.129285 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:00:25.129285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20c02575-05e2-4c16-ba32-2b9714b6c15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E94EFAF10>]}
[0m22:00:25.142395 [info ] [MainThread]: 
[0m22:00:25.145405 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:00:25.145405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m22:00:25.183531 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m22:00:25.183531 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m22:00:25.189627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:25.268083 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:00:25.276318 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m22:00:25.279125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m22:00:25.284673 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m22:00:25.284673 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m22:00:25.284673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:25.364459 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:00:25.366955 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m22:00:25.368353 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m22:00:25.393166 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:00:25.393166 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m22:00:25.393166 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m22:00:25.404699 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:25.404699 [debug] [MainThread]: On master: BEGIN
[0m22:00:25.404699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:25.518810 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:00:25.519331 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:25.519331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:25.581670 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m22:00:25.588210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20c02575-05e2-4c16-ba32-2b9714b6c15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E945791D0>]}
[0m22:00:25.590782 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:25.592459 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:25.592459 [debug] [MainThread]: On master: BEGIN
[0m22:00:25.595491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:00:25.596012 [debug] [MainThread]: On master: COMMIT
[0m22:00:25.596012 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:25.598039 [debug] [MainThread]: On master: COMMIT
[0m22:00:25.598039 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:00:25.598039 [debug] [MainThread]: On master: Close
[0m22:00:25.598039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:00:25.598039 [info ] [MainThread]: 
[0m22:00:25.616101 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m22:00:25.617498 [info ] [Thread-1 (]: 1 of 2 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m22:00:25.621075 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m22:00:25.621636 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m22:00:25.623751 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m22:00:25.641952 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 22:00:25.622700 => 22:00:25.641952
[0m22:00:25.646990 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m22:00:25.753804 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m22:00:25.754381 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:00:25.754381 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m22:00:25.754381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:00:25.884338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:25.884338 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:00:25.884338 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:00:25.911697 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m22:00:25.926682 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:00:25.926682 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:00:25.926682 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:25.974324 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m22:00:25.974324 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:00:25.974324 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m22:00:25.974324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:00:25.989967 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:00:26.005600 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m22:00:26.009368 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:00:26.009368 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 22:00:25.649220 => 22:00:26.009368
[0m22:00:26.009368 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m22:00:26.021391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20c02575-05e2-4c16-ba32-2b9714b6c15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E94FE4C10>]}
[0m22:00:26.021391 [info ] [Thread-1 (]: 1 of 2 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.40s]
[0m22:00:26.026548 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m22:00:26.026548 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m22:00:26.030099 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m22:00:26.031424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m22:00:26.031424 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m22:00:26.031424 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m22:00:26.037935 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 22:00:26.031424 => 22:00:26.037935
[0m22:00:26.037935 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m22:00:26.066525 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m22:00:26.068500 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:00:26.068500 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m22:00:26.070016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:26.146670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:00:26.147216 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:00:26.147216 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m22:00:26.158280 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:00:26.161890 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:00:26.161890 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:00:26.161890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:00:26.168938 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m22:00:26.168938 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:00:26.168938 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m22:00:26.174981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:00:26.178975 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:00:26.178975 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m22:00:26.178975 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:00:26.178975 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 22:00:26.037935 => 22:00:26.178975
[0m22:00:26.178975 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m22:00:26.185505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20c02575-05e2-4c16-ba32-2b9714b6c15c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E94FA2090>]}
[0m22:00:26.186708 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.15s]
[0m22:00:26.188500 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m22:00:26.190872 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:26.190872 [debug] [MainThread]: On master: BEGIN
[0m22:00:26.190872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:26.251416 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:00:26.257733 [debug] [MainThread]: On master: COMMIT
[0m22:00:26.257733 [debug] [MainThread]: Using postgres connection "master"
[0m22:00:26.258911 [debug] [MainThread]: On master: COMMIT
[0m22:00:26.260480 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:00:26.261922 [debug] [MainThread]: On master: Close
[0m22:00:26.261922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:26.261922 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m22:00:26.261922 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m22:00:26.261922 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m22:00:26.261922 [info ] [MainThread]: 
[0m22:00:26.261922 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m22:00:26.268100 [debug] [MainThread]: Command end result
[0m22:00:26.277270 [info ] [MainThread]: 
[0m22:00:26.277270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:26.281356 [info ] [MainThread]: 
[0m22:00:26.281356 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:00:26.284374 [debug] [MainThread]: Command `dbt run` succeeded at 22:00:26.284374 after 2.73 seconds
[0m22:00:26.284374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E926866D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E941FEB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E8E29A290>]}
[0m22:00:26.287663 [debug] [MainThread]: Flushing usage events
[0m22:01:01.064033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B7107250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B783BD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B7332850>]}


============================== 22:01:01.065408 | 769e03c4-5f09-41fd-9f3e-7867b03e1ca9 ==============================
[0m22:01:01.065408 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:01:01.065408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:01:01.171268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '769e03c4-5f09-41fd-9f3e-7867b03e1ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B71C9110>]}
[0m22:01:01.204348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '769e03c4-5f09-41fd-9f3e-7867b03e1ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B71C9110>]}
[0m22:01:01.204348 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m22:01:01.227425 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:01:01.317487 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m22:01:01.317487 [debug] [MainThread]: Partial parsing: deleted file: flight_dbt://models\example\my_first_dbt_model.sql
[0m22:01:01.317487 [debug] [MainThread]: Partial parsing: deleted file: flight_dbt://models\example\my_second_dbt_model.sql
[0m22:01:01.331788 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m22:01:01.331788 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models\example\schema.yml'
[0m22:01:01.419981 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.flight_dbt.unique_my_first_dbt_model_id.16e066b321' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m22:01:01.423025 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.flight_dbt.not_null_my_first_dbt_model_id.5fb22c2710' (models\example\schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m22:01:01.423025 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.flight_dbt.unique_my_second_dbt_model_id.57a0f8c493' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m22:01:01.426401 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.flight_dbt.not_null_my_second_dbt_model_id.151b76d778' (models\example\schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m22:01:01.433028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.flight_dbt.example
[0m22:01:01.441305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '769e03c4-5f09-41fd-9f3e-7867b03e1ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B7BCE810>]}
[0m22:01:01.454995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '769e03c4-5f09-41fd-9f3e-7867b03e1ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B7C98450>]}
[0m22:01:01.454995 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:01:01.457425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '769e03c4-5f09-41fd-9f3e-7867b03e1ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B3868590>]}
[0m22:01:01.458705 [info ] [MainThread]: 
[0m22:01:01.458705 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:01:01.458705 [debug] [MainThread]: Command end result
[0m22:01:01.473115 [debug] [MainThread]: Command `dbt run` succeeded at 22:01:01.473115 after 0.43 seconds
[0m22:01:01.473115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B74CF2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B0F5CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9B0F4A210>]}
[0m22:01:01.473115 [debug] [MainThread]: Flushing usage events
[0m22:02:12.276692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42C397FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42C66B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42C66BC90>]}


============================== 22:02:12.281659 | 9cc015cb-4d8c-48b7-90fd-381ea64cc148 ==============================
[0m22:02:12.281659 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:02:12.281659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:02:12.405320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cc015cb-4d8c-48b7-90fd-381ea64cc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42C361F90>]}
[0m22:02:12.454854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cc015cb-4d8c-48b7-90fd-381ea64cc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42CDA0310>]}
[0m22:02:12.455407 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m22:02:12.483332 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:02:12.588001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m22:02:12.588550 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\example\my_second_dbt_model.sql
[0m22:02:12.588550 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\example\my_first_dbt_model.sql
[0m22:02:12.624419 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m22:02:12.643721 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m22:02:12.674986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cc015cb-4d8c-48b7-90fd-381ea64cc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42C3A98D0>]}
[0m22:02:12.690615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cc015cb-4d8c-48b7-90fd-381ea64cc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42CEF50D0>]}
[0m22:02:12.690615 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:02:12.690615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cc015cb-4d8c-48b7-90fd-381ea64cc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C428AF8590>]}
[0m22:02:12.694559 [info ] [MainThread]: 
[0m22:02:12.694559 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:02:12.698184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m22:02:12.712473 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m22:02:12.712473 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m22:02:12.715013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:12.788009 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:02:12.789061 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m22:02:12.789061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m22:02:12.805202 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m22:02:12.805202 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m22:02:12.805202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:12.877337 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:02:12.877337 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m22:02:12.877337 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m22:02:12.889788 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m22:02:12.889788 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m22:02:12.892797 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m22:02:12.893862 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:12.893862 [debug] [MainThread]: On master: BEGIN
[0m22:02:12.893862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:13.089840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:02:13.089840 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:13.089840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:02:13.121639 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m22:02:13.121639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cc015cb-4d8c-48b7-90fd-381ea64cc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42CAD9550>]}
[0m22:02:13.121639 [debug] [MainThread]: On master: ROLLBACK
[0m22:02:13.121639 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:13.121639 [debug] [MainThread]: On master: BEGIN
[0m22:02:13.121639 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:02:13.121639 [debug] [MainThread]: On master: COMMIT
[0m22:02:13.121639 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:13.121639 [debug] [MainThread]: On master: COMMIT
[0m22:02:13.121639 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:02:13.121639 [debug] [MainThread]: On master: Close
[0m22:02:13.121639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:13.121639 [info ] [MainThread]: 
[0m22:02:13.140991 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m22:02:13.140991 [info ] [Thread-1 (]: 1 of 2 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m22:02:13.143851 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m22:02:13.143851 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m22:02:13.149316 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m22:02:13.153825 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 22:02:13.143851 => 22:02:13.149316
[0m22:02:13.153825 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m22:02:13.253977 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m22:02:13.253977 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:02:13.260090 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m22:02:13.260601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:02:13.322683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:02:13.323781 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:02:13.323781 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m22:02:13.332063 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m22:02:13.332063 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:02:13.332063 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m22:02:13.332063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:02:13.347702 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:02:13.347702 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:02:13.347702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:02:13.379243 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m22:02:13.379243 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:02:13.387245 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m22:02:13.389821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:02:13.400184 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m22:02:13.400184 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m22:02:13.407051 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:02:13.407601 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 22:02:13.156665 => 22:02:13.407601
[0m22:02:13.407601 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m22:02:13.411155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc015cb-4d8c-48b7-90fd-381ea64cc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42C396250>]}
[0m22:02:13.413589 [info ] [Thread-1 (]: 1 of 2 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.27s]
[0m22:02:13.416197 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m22:02:13.416197 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m22:02:13.416197 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m22:02:13.420438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m22:02:13.421703 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m22:02:13.424832 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m22:02:13.429904 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 22:02:13.421703 => 22:02:13.428894
[0m22:02:13.429904 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m22:02:13.459149 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m22:02:13.462705 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:02:13.463880 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m22:02:13.463880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:13.533844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:02:13.535294 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:02:13.536141 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m22:02:13.537180 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:02:13.551192 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:02:13.551192 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:02:13.558256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:02:13.558256 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m22:02:13.558256 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:02:13.558256 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m22:02:13.558256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:02:13.569178 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m22:02:13.570839 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m22:02:13.570839 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:02:13.570839 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 22:02:13.429904 => 22:02:13.570839
[0m22:02:13.570839 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m22:02:13.570839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cc015cb-4d8c-48b7-90fd-381ea64cc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42CF96110>]}
[0m22:02:13.570839 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.15s]
[0m22:02:13.580777 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m22:02:13.583329 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:13.584990 [debug] [MainThread]: On master: BEGIN
[0m22:02:13.584990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:13.656375 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:02:13.656375 [debug] [MainThread]: On master: COMMIT
[0m22:02:13.656375 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:13.656375 [debug] [MainThread]: On master: COMMIT
[0m22:02:13.660442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:02:13.660442 [debug] [MainThread]: On master: Close
[0m22:02:13.662245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:13.662245 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m22:02:13.662245 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m22:02:13.662245 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m22:02:13.662245 [info ] [MainThread]: 
[0m22:02:13.664752 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m22:02:13.664752 [debug] [MainThread]: Command end result
[0m22:02:13.672937 [info ] [MainThread]: 
[0m22:02:13.672937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:02:13.679260 [info ] [MainThread]: 
[0m22:02:13.680332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:02:13.681380 [debug] [MainThread]: Command `dbt run` succeeded at 22:02:13.681380 after 1.43 seconds
[0m22:02:13.682859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42C44FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42617A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42617AF10>]}
[0m22:02:13.683404 [debug] [MainThread]: Flushing usage events
[0m14:04:45.635294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C143A7EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C145CA2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C145DEBCD0>]}


============================== 14:04:45.644731 | b8b35c47-b9bf-447b-ac3f-73b8243016a0 ==============================
[0m14:04:45.644731 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:04:45.650685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:04:45.855924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8b35c47-b9bf-447b-ac3f-73b8243016a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C145DC3510>]}
[0m14:04:45.872498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8b35c47-b9bf-447b-ac3f-73b8243016a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C145E85390>]}
[0m14:04:45.880506 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:04:45.929666 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:04:47.338251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:04:47.339876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:04:47.339876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8b35c47-b9bf-447b-ac3f-73b8243016a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C143B4A650>]}
[0m14:04:47.354157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8b35c47-b9bf-447b-ac3f-73b8243016a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C14654C9D0>]}
[0m14:04:47.354157 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:04:47.354157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b35c47-b9bf-447b-ac3f-73b8243016a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C145EE0450>]}
[0m14:04:47.358047 [info ] [MainThread]: 
[0m14:04:47.358047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:04:47.358047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:04:47.372927 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:04:47.372927 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:04:47.372927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:47.595668 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:04:47.595668 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:04:47.601153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:04:47.602803 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:04:47.602803 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:04:47.602803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:47.672431 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:04:47.673976 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:04:47.673976 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:04:47.685115 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:04:47.685115 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:04:47.685115 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:04:47.691176 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:47.691176 [debug] [MainThread]: On master: BEGIN
[0m14:04:47.691176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:47.739444 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:04:47.739444 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:47.739444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:04:47.768363 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:04:47.771915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b35c47-b9bf-447b-ac3f-73b8243016a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C145EFE810>]}
[0m14:04:47.771915 [debug] [MainThread]: On master: ROLLBACK
[0m14:04:47.771915 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:47.771915 [debug] [MainThread]: On master: BEGIN
[0m14:04:47.775626 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:04:47.775626 [debug] [MainThread]: On master: COMMIT
[0m14:04:47.776772 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:47.776772 [debug] [MainThread]: On master: COMMIT
[0m14:04:47.776772 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:04:47.776772 [debug] [MainThread]: On master: Close
[0m14:04:47.779137 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:47.780143 [info ] [MainThread]: 
[0m14:04:47.789440 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:04:47.789440 [info ] [Thread-1 (]: 1 of 2 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m14:04:47.792222 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:04:47.792222 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:04:47.796013 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:04:47.798611 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:04:47.792222 => 14:04:47.796013
[0m14:04:47.798611 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:04:47.892084 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:04:47.892084 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:47.892084 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:04:47.900589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:47.957770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:04:47.957770 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:47.957770 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:04:47.993843 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:04:48.005356 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:48.005356 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:04:48.005356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:48.022840 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:48.025641 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:04:48.025641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:48.056485 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:04:48.056485 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:48.056485 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:04:48.056485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:04:48.070864 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:48.070864 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:04:48.079133 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:48.082945 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:04:47.800626 => 14:04:48.082945
[0m14:04:48.082945 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:04:48.084955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8b35c47-b9bf-447b-ac3f-73b8243016a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C146258910>]}
[0m14:04:48.084955 [info ] [Thread-1 (]: 1 of 2 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.30s]
[0m14:04:48.088311 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:04:48.090923 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:04:48.090923 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:04:48.090923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:04:48.094809 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:04:48.105125 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:04:48.109385 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:04:48.094809 => 14:04:48.107857
[0m14:04:48.112770 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:04:48.166770 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:04:48.166770 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:48.166770 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:04:48.166770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:48.383069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:04:48.393097 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:48.393097 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:04:48.414629 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:04:48.416258 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:48.416258 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:04:48.424792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:48.424792 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:04:48.424792 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:48.424792 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:04:48.424792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:04:48.440506 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:48.440506 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:04:48.440506 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:04:48.449673 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:04:48.112770 => 14:04:48.449673
[0m14:04:48.449673 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:04:48.449673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8b35c47-b9bf-447b-ac3f-73b8243016a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1466B3E10>]}
[0m14:04:48.456229 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.36s]
[0m14:04:48.456229 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:04:48.466772 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:48.474328 [debug] [MainThread]: On master: BEGIN
[0m14:04:48.476818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:48.642273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:04:48.642273 [debug] [MainThread]: On master: COMMIT
[0m14:04:48.642273 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:48.642273 [debug] [MainThread]: On master: COMMIT
[0m14:04:48.650227 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:04:48.650227 [debug] [MainThread]: On master: Close
[0m14:04:48.650227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:48.650227 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:04:48.650227 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:04:48.657204 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:04:48.657204 [info ] [MainThread]: 
[0m14:04:48.658729 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m14:04:48.658729 [debug] [MainThread]: Command end result
[0m14:04:48.674427 [info ] [MainThread]: 
[0m14:04:48.681212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:48.682769 [info ] [MainThread]: 
[0m14:04:48.682769 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:48.688863 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:48.682769 after 3.10 seconds
[0m14:04:48.688863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C143C61C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C145BA8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C13F92A210>]}
[0m14:04:48.692335 [debug] [MainThread]: Flushing usage events
[0m14:04:56.725755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22C228DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22BFC1C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22BC7F510>]}


============================== 14:04:56.731344 | 8eea2773-8821-41b8-952e-6c2e148e12b5 ==============================
[0m14:04:56.731344 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:04:56.731344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:04:56.826376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8eea2773-8821-41b8-952e-6c2e148e12b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22C67B610>]}
[0m14:04:56.850355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8eea2773-8821-41b8-952e-6c2e148e12b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22C930750>]}
[0m14:04:56.850355 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:04:56.870990 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:04:57.009555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:57.009555 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\example\my_first_dbt_model.sql
[0m14:04:57.036369 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m14:04:57.067938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eea2773-8821-41b8-952e-6c2e148e12b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22BF05750>]}
[0m14:04:57.067938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eea2773-8821-41b8-952e-6c2e148e12b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22CA81010>]}
[0m14:04:57.067938 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:04:57.083578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eea2773-8821-41b8-952e-6c2e148e12b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C228698710>]}
[0m14:04:57.083578 [info ] [MainThread]: 
[0m14:04:57.083578 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:04:57.083578 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:04:57.100606 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:04:57.100606 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:04:57.100606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:57.165674 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:04:57.165674 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:04:57.165674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:04:57.188896 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:04:57.192307 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:04:57.194835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:57.292251 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:04:57.292251 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:04:57.292251 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:04:57.303126 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:04:57.320749 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:04:57.320749 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:04:57.351330 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:57.351330 [debug] [MainThread]: On master: BEGIN
[0m14:04:57.351330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:57.480302 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:04:57.480302 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:57.480302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:04:57.511615 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:04:57.511615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eea2773-8821-41b8-952e-6c2e148e12b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22C440F10>]}
[0m14:04:57.511615 [debug] [MainThread]: On master: ROLLBACK
[0m14:04:57.511615 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:57.511615 [debug] [MainThread]: On master: BEGIN
[0m14:04:57.524693 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:04:57.524693 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.525776 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:57.525776 [debug] [MainThread]: On master: COMMIT
[0m14:04:57.525776 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:04:57.528430 [debug] [MainThread]: On master: Close
[0m14:04:57.528982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:57.528982 [info ] [MainThread]: 
[0m14:04:57.548857 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:04:57.551315 [info ] [Thread-1 (]: 1 of 2 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:04:57.557325 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:04:57.559727 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:04:57.565263 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:04:57.565263 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:04:57.559727 => 14:04:57.565263
[0m14:04:57.565263 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:04:57.613941 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:04:57.613941 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:57.613941 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:04:57.613941 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:57.727726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:04:57.729827 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:57.729827 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:04:57.752651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:04:57.775732 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:57.783264 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:04:57.783264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:57.798925 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:57.798925 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:04:57.808342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:57.878213 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:04:57.878213 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:57.878213 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:04:57.895792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:04:57.896805 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:04:57.910319 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop table if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:04:57.914826 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:57.914826 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:04:57.565263 => 14:04:57.914826
[0m14:04:57.914826 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:04:57.925038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eea2773-8821-41b8-952e-6c2e148e12b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22C95CC50>]}
[0m14:04:57.927617 [info ] [Thread-1 (]: 1 of 2 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.37s]
[0m14:04:57.932933 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:04:57.932933 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:04:57.937234 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:04:57.944974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:04:57.946062 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:04:57.965881 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:04:57.966960 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:04:57.946062 => 14:04:57.966960
[0m14:04:57.966960 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:04:57.999452 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:04:57.999452 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:58.007443 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:04:58.008849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:04:58.133164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:04:58.133741 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:58.136256 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:04:58.151993 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:04:58.158000 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:58.158000 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:04:58.158000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:58.168081 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:04:58.168081 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:58.168081 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:04:58.168081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:04:58.183734 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:04:58.183734 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:04:58.183734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:04:58.192060 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:04:57.974995 => 14:04:58.192060
[0m14:04:58.192060 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:04:58.192060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eea2773-8821-41b8-952e-6c2e148e12b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22C9B9610>]}
[0m14:04:58.199580 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.25s]
[0m14:04:58.203881 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:04:58.207940 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:58.208517 [debug] [MainThread]: On master: BEGIN
[0m14:04:58.208517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:58.355799 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:04:58.357529 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.357529 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:58.357529 [debug] [MainThread]: On master: COMMIT
[0m14:04:58.357529 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:04:58.357529 [debug] [MainThread]: On master: Close
[0m14:04:58.357529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:58.369557 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:04:58.369557 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:04:58.369557 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:04:58.369557 [info ] [MainThread]: 
[0m14:04:58.369557 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m14:04:58.385601 [debug] [MainThread]: Command end result
[0m14:04:58.418420 [info ] [MainThread]: 
[0m14:04:58.418420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:58.423077 [info ] [MainThread]: 
[0m14:04:58.426835 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:04:58.430409 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:58.430409 after 1.72 seconds
[0m14:04:58.432224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22C161290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C22C30F2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C225D8A210>]}
[0m14:04:58.435412 [debug] [MainThread]: Flushing usage events
[0m14:06:11.031994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A16F9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A1429350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A140B8D0>]}


============================== 14:06:11.035400 | 1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe ==============================
[0m14:06:11.035400 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:06:11.035400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:11.118282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A141EA90>]}
[0m14:06:11.142501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A17D8C90>]}
[0m14:06:11.142501 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:06:11.165263 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:06:11.192447 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:06:11.192447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A1B5A910>]}
[0m14:06:12.049735 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m14:06:12.065439 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m14:06:12.159889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.flight_dbt.dimentions
[0m14:06:12.176264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A1ED2710>]}
[0m14:06:12.180451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A1F09310>]}
[0m14:06:12.180451 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:06:12.190550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002729DB58590>]}
[0m14:06:12.192099 [info ] [MainThread]: 
[0m14:06:12.196393 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:12.199276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:06:12.223398 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:06:12.223398 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:06:12.224500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:12.289363 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:06:12.289868 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:06:12.292994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:06:12.298926 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:06:12.299467 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:06:12.299467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:12.354111 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:12.354111 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:06:12.354111 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:06:12.364366 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:06:12.364913 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:06:12.364913 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:06:12.372720 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.372720 [debug] [MainThread]: On master: BEGIN
[0m14:06:12.372720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:12.444255 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:12.444255 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.446690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:12.496934 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:06:12.496934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A1EE2490>]}
[0m14:06:12.496934 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:12.512578 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.514381 [debug] [MainThread]: On master: BEGIN
[0m14:06:12.516010 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:12.517923 [debug] [MainThread]: On master: COMMIT
[0m14:06:12.517923 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.517923 [debug] [MainThread]: On master: COMMIT
[0m14:06:12.517923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:12.517923 [debug] [MainThread]: On master: Close
[0m14:06:12.517923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:12.527216 [info ] [MainThread]: 
[0m14:06:12.540641 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:06:12.540641 [info ] [Thread-1 (]: 1 of 2 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:06:12.546833 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:06:12.547419 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:06:12.558109 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:06:12.562747 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:06:12.549834 => 14:06:12.562747
[0m14:06:12.568777 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:06:12.706949 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:06:12.706949 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:06:12.710982 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:06:12.712621 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:12.813233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:12.813233 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:06:12.813233 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:06:12.828395 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:12.836711 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:06:12.836711 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:06:12.845360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:12.848578 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:06:12.848578 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:06:12.848578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:12.892119 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:06:12.892119 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:06:12.892119 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:06:12.918053 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:12.924129 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:06:12.929157 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:06:12.929157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:12.934943 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:06:12.568777 => 14:06:12.934943
[0m14:06:12.934943 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:06:12.940027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A1FD61D0>]}
[0m14:06:12.940027 [info ] [Thread-1 (]: 1 of 2 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.40s]
[0m14:06:12.947999 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:06:12.957211 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:06:12.960750 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:06:12.967596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:06:12.967596 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:06:12.981317 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:06:12.987524 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:06:12.971035 => 14:06:12.986988
[0m14:06:12.988617 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:06:13.013041 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:06:13.017653 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:06:13.020679 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:06:13.025940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:13.203640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:13.203640 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:06:13.206683 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:06:13.221464 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:13.221464 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:06:13.221464 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:06:13.221464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:13.234963 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:06:13.237532 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:06:13.239405 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:06:13.245741 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:13.248420 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:06:13.253493 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:06:13.255344 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:13.255344 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:06:12.988617 => 14:06:13.255344
[0m14:06:13.255344 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:06:13.261732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1554f0fc-db2b-4e4a-84b4-ab3b908b0cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A1EBE550>]}
[0m14:06:13.261732 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.30s]
[0m14:06:13.267120 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:06:13.271650 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:13.271650 [debug] [MainThread]: On master: BEGIN
[0m14:06:13.271650 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:13.388347 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:13.388347 [debug] [MainThread]: On master: COMMIT
[0m14:06:13.390423 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:13.390423 [debug] [MainThread]: On master: COMMIT
[0m14:06:13.390423 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:13.390423 [debug] [MainThread]: On master: Close
[0m14:06:13.394542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:13.394542 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:06:13.397410 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:06:13.399254 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:06:13.399254 [info ] [MainThread]: 
[0m14:06:13.399254 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m14:06:13.405735 [debug] [MainThread]: Command end result
[0m14:06:13.412809 [info ] [MainThread]: 
[0m14:06:13.424101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:13.425155 [info ] [MainThread]: 
[0m14:06:13.428609 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:06:13.431793 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:13.431279 after 2.43 seconds
[0m14:06:13.433393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A16A6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A1126410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002729B17A210>]}
[0m14:06:13.433393 [debug] [MainThread]: Flushing usage events
[0m14:06:59.204218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F805109E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8049C6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8049C40D0>]}


============================== 14:06:59.208206 | 6dd04506-b937-49fc-8503-169da9df6f26 ==============================
[0m14:06:59.208206 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:06:59.208206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:59.309727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd04506-b937-49fc-8503-169da9df6f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804D9D950>]}
[0m14:06:59.339783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd04506-b937-49fc-8503-169da9df6f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F802B96310>]}
[0m14:06:59.339783 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:06:59.365942 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:06:59.458068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:06:59.458068 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\dimentions\dim_airport.sql
[0m14:06:59.474622 [debug] [MainThread]: 1699: static parser successfully parsed dimentions\dim_airport.sql
[0m14:06:59.507924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd04506-b937-49fc-8503-169da9df6f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8053C4DD0>]}
[0m14:06:59.524943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd04506-b937-49fc-8503-169da9df6f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F805566790>]}
[0m14:06:59.524943 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:06:59.524943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd04506-b937-49fc-8503-169da9df6f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F805130590>]}
[0m14:06:59.524943 [info ] [MainThread]: 
[0m14:06:59.524943 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:59.532321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:06:59.550186 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:06:59.550186 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:06:59.550186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:59.624518 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:06:59.627562 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:06:59.630851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:06:59.636021 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:06:59.636021 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:06:59.636021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:59.686799 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:59.686799 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:06:59.686799 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:06:59.701110 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:06:59.701110 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:06:59.701110 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:06:59.715626 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:59.715626 [debug] [MainThread]: On master: BEGIN
[0m14:06:59.731303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:59.818026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:59.818026 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:59.818026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:59.844710 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:06:59.844710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd04506-b937-49fc-8503-169da9df6f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804BEE650>]}
[0m14:06:59.844710 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:59.844710 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:59.844710 [debug] [MainThread]: On master: BEGIN
[0m14:06:59.844710 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:59.844710 [debug] [MainThread]: On master: COMMIT
[0m14:06:59.844710 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:59.844710 [debug] [MainThread]: On master: COMMIT
[0m14:06:59.844710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:59.844710 [debug] [MainThread]: On master: Close
[0m14:06:59.854480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:59.854480 [info ] [MainThread]: 
[0m14:06:59.861661 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:06:59.861661 [info ] [Thread-1 (]: 1 of 2 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:06:59.861661 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:06:59.864559 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:06:59.867205 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:06:59.868826 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:06:59.864559 => 14:06:59.868826
[0m14:06:59.868826 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:06:59.917831 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:06:59.927636 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:06:59.927636 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:06:59.927636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:59.992101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:59.992101 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:06:59.992101 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:07:00.002223 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:07:00.007508 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:07:00.007508 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:07:00.007508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:00.023575 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:07:00.024083 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:07:00.024083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:00.046740 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:07:00.046740 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:07:00.046740 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:07:00.046740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:07:00.046740 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:07:00.046740 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:07:00.062368 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:07:00.062368 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:06:59.868826 => 14:07:00.062368
[0m14:07:00.062368 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:07:00.062368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd04506-b937-49fc-8503-169da9df6f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8053C5C10>]}
[0m14:07:00.062368 [info ] [Thread-1 (]: 1 of 2 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.20s]
[0m14:07:00.062368 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:07:00.062368 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:07:00.062368 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:07:00.062368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:07:00.077915 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:07:00.083256 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:07:00.085614 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:07:00.077915 => 14:07:00.083256
[0m14:07:00.085614 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:07:00.093710 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:07:00.093710 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:07:00.093710 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:07:00.093710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:00.157672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:07:00.157672 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:07:00.157672 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:07:00.174229 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:07:00.181742 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:07:00.181742 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:07:00.181742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:00.187499 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:07:00.187499 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:07:00.189179 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:07:00.190727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:07:00.197742 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:07:00.197742 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:07:00.197742 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:07:00.197742 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:07:00.085614 => 14:07:00.197742
[0m14:07:00.197742 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:07:00.206624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd04506-b937-49fc-8503-169da9df6f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8050FB690>]}
[0m14:07:00.208298 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.14s]
[0m14:07:00.208298 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:07:00.208298 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:00.213159 [debug] [MainThread]: On master: BEGIN
[0m14:07:00.213159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:00.276446 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:07:00.277458 [debug] [MainThread]: On master: COMMIT
[0m14:07:00.277458 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:00.277458 [debug] [MainThread]: On master: COMMIT
[0m14:07:00.277458 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:07:00.277458 [debug] [MainThread]: On master: Close
[0m14:07:00.277458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:00.277458 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:07:00.282881 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:07:00.282881 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:07:00.283974 [info ] [MainThread]: 
[0m14:07:00.284522 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m14:07:00.285781 [debug] [MainThread]: Command end result
[0m14:07:00.295970 [info ] [MainThread]: 
[0m14:07:00.296747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:00.297730 [info ] [MainThread]: 
[0m14:07:00.299172 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:07:00.300203 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:00.300203 after 1.12 seconds
[0m14:07:00.301740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F804FC2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F87E77AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F87E77A210>]}
[0m14:07:00.302284 [debug] [MainThread]: Flushing usage events
[0m14:10:05.603350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E118849E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11882E550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1188D7B10>]}


============================== 14:10:05.607540 | d950d338-2699-4b86-a2c6-fb0237790624 ==============================
[0m14:10:05.607540 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:10:05.607540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:10:05.705581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd950d338-2699-4b86-a2c6-fb0237790624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11884B550>]}
[0m14:10:05.721061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd950d338-2699-4b86-a2c6-fb0237790624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1185A1F50>]}
[0m14:10:05.721061 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:10:05.737871 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:10:05.877192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:10:05.877192 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\dimentions\schema.yml
[0m14:10:05.957239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd950d338-2699-4b86-a2c6-fb0237790624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E118CDA210>]}
[0m14:10:05.993539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd950d338-2699-4b86-a2c6-fb0237790624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E119121950>]}
[0m14:10:05.993539 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:10:06.003697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd950d338-2699-4b86-a2c6-fb0237790624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E114CD8710>]}
[0m14:10:06.005231 [info ] [MainThread]: 
[0m14:10:06.015307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:10:06.023632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:10:06.080433 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:10:06.080433 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:10:06.080433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:06.210355 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:10:06.223180 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:10:06.226313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:10:06.242927 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:10:06.242927 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:10:06.242927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:06.356065 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:10:06.356065 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:10:06.370674 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:10:06.390883 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:10:06.403952 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:10:06.403952 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:10:06.417978 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:06.417978 [debug] [MainThread]: On master: BEGIN
[0m14:10:06.417978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:06.580896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:10:06.582643 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:06.583214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:10:06.636956 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:10:06.641012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd950d338-2699-4b86-a2c6-fb0237790624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1186308D0>]}
[0m14:10:06.642773 [debug] [MainThread]: On master: ROLLBACK
[0m14:10:06.642773 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:06.642773 [debug] [MainThread]: On master: BEGIN
[0m14:10:06.642773 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:10:06.642773 [debug] [MainThread]: On master: COMMIT
[0m14:10:06.647736 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:06.647736 [debug] [MainThread]: On master: COMMIT
[0m14:10:06.649083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:10:06.649083 [debug] [MainThread]: On master: Close
[0m14:10:06.650817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:06.650817 [info ] [MainThread]: 
[0m14:10:06.657177 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:10:06.657177 [info ] [Thread-1 (]: 1 of 2 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:10:06.663134 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:10:06.663134 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:10:06.668562 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:10:06.670314 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:10:06.664214 => 14:10:06.670314
[0m14:10:06.673186 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:10:06.713759 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:10:06.713759 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:10:06.719743 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:10:06.722087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:06.774256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:10:06.779294 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:10:06.779294 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:10:06.782860 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:10:06.793380 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:10:06.793380 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:10:06.793380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:10:06.793380 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:10:06.793380 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:10:06.793380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:10:06.811374 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:10:06.811374 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:10:06.819652 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:10:06.821768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:10:06.825278 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:10:06.825278 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:10:06.825278 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:10:06.825278 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:10:06.673186 => 14:10:06.825278
[0m14:10:06.825278 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:10:06.825278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd950d338-2699-4b86-a2c6-fb0237790624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1185662D0>]}
[0m14:10:06.836965 [info ] [Thread-1 (]: 1 of 2 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:10:06.838184 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:10:06.838184 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:10:06.841199 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:10:06.842815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:10:06.844426 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:10:06.845462 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:10:06.849475 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:10:06.845462 => 14:10:06.849475
[0m14:10:06.849475 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:10:06.860143 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:10:06.861845 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:10:06.861845 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:10:06.861845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:06.915380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:10:06.915380 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:10:06.923388 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:10:06.923388 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:10:06.939650 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:10:06.939650 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:10:06.939650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:10:06.953854 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:10:06.953854 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:10:06.953854 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:10:06.963763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:10:06.970247 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:10:06.970247 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:10:06.970247 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:10:06.981607 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:10:06.849475 => 14:10:06.981607
[0m14:10:06.981607 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:10:06.981607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd950d338-2699-4b86-a2c6-fb0237790624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1190D4C90>]}
[0m14:10:06.993549 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.14s]
[0m14:10:06.999036 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:10:07.008223 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:07.008223 [debug] [MainThread]: On master: BEGIN
[0m14:10:07.013511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:07.203827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:10:07.206352 [debug] [MainThread]: On master: COMMIT
[0m14:10:07.206352 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:07.206352 [debug] [MainThread]: On master: COMMIT
[0m14:10:07.206352 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:10:07.206352 [debug] [MainThread]: On master: Close
[0m14:10:07.206352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:07.206352 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:10:07.214373 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:10:07.216095 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:10:07.216095 [info ] [MainThread]: 
[0m14:10:07.218701 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m14:10:07.219762 [debug] [MainThread]: Command end result
[0m14:10:07.238678 [info ] [MainThread]: 
[0m14:10:07.238678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:07.238678 [info ] [MainThread]: 
[0m14:10:07.248606 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:10:07.251282 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:07.251282 after 1.67 seconds
[0m14:10:07.253304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11234A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11234A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11234AE10>]}
[0m14:10:07.253304 [debug] [MainThread]: Flushing usage events
[0m14:13:58.245435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF5D1BAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF63753C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF637663D0>]}


============================== 14:13:58.251273 | 51a7cc51-e353-4941-a808-29a6ac9aa55d ==============================
[0m14:13:58.251273 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:13:58.251273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:13:58.346423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a7cc51-e353-4941-a808-29a6ac9aa55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6336B250>]}
[0m14:13:58.369736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a7cc51-e353-4941-a808-29a6ac9aa55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF63D92610>]}
[0m14:13:58.369736 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:13:58.389206 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:13:58.529126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:58.529126 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\dim_airport.sql
[0m14:13:58.562485 [debug] [MainThread]: 1699: static parser successfully parsed dimentions\dim_airport.sql
[0m14:13:58.634069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a7cc51-e353-4941-a808-29a6ac9aa55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF63E74090>]}
[0m14:13:58.649802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a7cc51-e353-4941-a808-29a6ac9aa55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF63EEA310>]}
[0m14:13:58.649802 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:13:58.649802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a7cc51-e353-4941-a808-29a6ac9aa55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF5FAF8590>]}
[0m14:13:58.655523 [info ] [MainThread]: 
[0m14:13:58.655523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:58.655523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:13:58.671470 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:13:58.671470 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:13:58.671470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:58.734353 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:13:58.739429 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:13:58.745147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:13:58.755646 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:13:58.762401 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:13:58.763928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:58.858593 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:13:58.858593 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:13:58.858593 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:13:58.873871 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:13:58.873871 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:13:58.873871 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:13:58.884945 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:58.884945 [debug] [MainThread]: On master: BEGIN
[0m14:13:58.884945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:58.973396 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:58.975457 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:58.975457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:13:59.011796 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:13:59.011796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a7cc51-e353-4941-a808-29a6ac9aa55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF632CE950>]}
[0m14:13:59.011796 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:59.011796 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:59.011796 [debug] [MainThread]: On master: BEGIN
[0m14:13:59.011796 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:59.011796 [debug] [MainThread]: On master: COMMIT
[0m14:13:59.011796 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:59.011796 [debug] [MainThread]: On master: COMMIT
[0m14:13:59.011796 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:13:59.011796 [debug] [MainThread]: On master: Close
[0m14:13:59.011796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:59.025019 [info ] [MainThread]: 
[0m14:13:59.032658 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m14:13:59.033698 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m14:13:59.035678 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_airport'
[0m14:13:59.035678 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m14:13:59.038629 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m14:13:59.041010 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 14:13:59.036888 => 14:13:59.041010
[0m14:13:59.041010 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m14:13:59.101853 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m14:13:59.101853 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m14:13:59.101853 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m14:13:59.101853 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:13:59.163155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:13:59.163155 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m14:13:59.163155 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *
from airports_data
  );
  
[0m14:13:59.163155 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 13: from airports_data
              ^

[0m14:13:59.163155 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: ROLLBACK
[0m14:13:59.174730 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 14:13:59.044024 => 14:13:59.163155
[0m14:13:59.174730 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m14:13:59.317568 [debug] [Thread-1 (]: Database Error in model dim_airport (models\dimentions\dim_airport.sql)
  relation "airports_data" does not exist
  LINE 13: from airports_data
                ^
  compiled Code at target\run\flight_dbt\models\dimentions\dim_airport.sql
[0m14:13:59.317568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a7cc51-e353-4941-a808-29a6ac9aa55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF63681C50>]}
[0m14:13:59.317568 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model flights_wh.dim_airport ................... [[31mERROR[0m in 0.28s]
[0m14:13:59.317568 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m14:13:59.328277 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:13:59.328821 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:13:59.328821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m14:13:59.328821 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:13:59.334427 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:13:59.335446 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:13:59.331283 => 14:13:59.335446
[0m14:13:59.335446 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:13:59.357743 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:13:59.357743 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:13:59.357743 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:13:59.357743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:59.416355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:13:59.416866 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:13:59.416866 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:13:59.432412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:13:59.445514 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:13:59.445514 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:13:59.445514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:13:59.456938 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:13:59.457504 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:13:59.457504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:13:59.494542 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:13:59.495054 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:13:59.495054 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:13:59.502230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:13:59.511870 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:13:59.511870 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:13:59.511870 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:13:59.519940 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:13:59.336769 => 14:13:59.519940
[0m14:13:59.519940 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:13:59.519940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a7cc51-e353-4941-a808-29a6ac9aa55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF63F7E290>]}
[0m14:13:59.527691 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.19s]
[0m14:13:59.531000 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:13:59.531000 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:13:59.531000 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:13:59.537587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:13:59.539185 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:13:59.546592 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:13:59.549780 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:13:59.539185 => 14:13:59.547667
[0m14:13:59.549780 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:13:59.552791 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:13:59.561838 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:13:59.561838 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:13:59.561838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:59.806762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:13:59.807329 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:13:59.807329 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:13:59.822342 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:13:59.829727 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:13:59.829727 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:13:59.829727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:13:59.829727 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:13:59.829727 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:13:59.829727 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:13:59.846654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:13:59.846654 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:13:59.846654 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:13:59.846654 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:13:59.846654 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:13:59.549780 => 14:13:59.846654
[0m14:13:59.846654 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:13:59.862298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a7cc51-e353-4941-a808-29a6ac9aa55d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF63F803D0>]}
[0m14:13:59.862298 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.33s]
[0m14:13:59.867816 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:13:59.871713 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:59.871713 [debug] [MainThread]: On master: BEGIN
[0m14:13:59.871713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:59.985207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:59.985781 [debug] [MainThread]: On master: COMMIT
[0m14:13:59.985781 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:59.988068 [debug] [MainThread]: On master: COMMIT
[0m14:13:59.988068 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:13:59.989992 [debug] [MainThread]: On master: Close
[0m14:13:59.992003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:59.994453 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:13:59.994453 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:13:59.996421 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:13:59.996421 [info ] [MainThread]: 
[0m14:13:59.999586 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m14:14:00.001891 [debug] [MainThread]: Command end result
[0m14:14:00.024402 [info ] [MainThread]: 
[0m14:14:00.032444 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:14:00.032444 [info ] [MainThread]: 
[0m14:14:00.040430 [error] [MainThread]: [33mDatabase Error in model dim_airport (models\dimentions\dim_airport.sql)[0m
[0m14:14:00.040430 [error] [MainThread]:   relation "airports_data" does not exist
[0m14:14:00.050904 [error] [MainThread]:   LINE 13: from airports_data
[0m14:14:00.055515 [error] [MainThread]:                 ^
[0m14:14:00.056552 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\dimentions\dim_airport.sql
[0m14:14:00.056552 [info ] [MainThread]: 
[0m14:14:00.064812 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:14:00.068519 [debug] [MainThread]: Command `dbt run` failed at 14:14:00.068519 after 1.84 seconds
[0m14:14:00.068519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF63386DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF634591D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF636FF250>]}
[0m14:14:00.074562 [debug] [MainThread]: Flushing usage events
[0m14:17:25.795957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47C5D3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47C5D0D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47C5FE350>]}


============================== 14:17:25.795957 | cfffbe3a-e0d3-4f10-8355-f025eecae36f ==============================
[0m14:17:25.795957 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:17:25.795957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:17:25.908403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfffbe3a-e0d3-4f10-8355-f025eecae36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47C2F7450>]}
[0m14:17:25.923927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfffbe3a-e0d3-4f10-8355-f025eecae36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47CCBD050>]}
[0m14:17:25.931929 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:17:25.953846 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:17:26.148973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:26.148973 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\schema.yml
[0m14:17:26.211888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfffbe3a-e0d3-4f10-8355-f025eecae36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47CD665D0>]}
[0m14:17:26.211888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfffbe3a-e0d3-4f10-8355-f025eecae36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47C5D28D0>]}
[0m14:17:26.211888 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:17:26.224084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfffbe3a-e0d3-4f10-8355-f025eecae36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B478A58590>]}
[0m14:17:26.225312 [info ] [MainThread]: 
[0m14:17:26.229294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:17:26.229806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:17:26.245136 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:17:26.245136 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:17:26.245136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:26.324032 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:17:26.325554 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:17:26.325554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:17:26.333744 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:17:26.333744 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:17:26.333744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:26.408004 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:17:26.408004 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:17:26.413516 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:17:26.424151 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:17:26.429209 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:17:26.429209 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:17:26.433064 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:26.433064 [debug] [MainThread]: On master: BEGIN
[0m14:17:26.433064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:26.556148 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:17:26.556148 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:26.556148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:17:26.621849 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:17:26.623845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfffbe3a-e0d3-4f10-8355-f025eecae36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47C383F10>]}
[0m14:17:26.623845 [debug] [MainThread]: On master: ROLLBACK
[0m14:17:26.623845 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:26.623845 [debug] [MainThread]: On master: BEGIN
[0m14:17:26.623845 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:17:26.623845 [debug] [MainThread]: On master: COMMIT
[0m14:17:26.633163 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:26.633669 [debug] [MainThread]: On master: COMMIT
[0m14:17:26.635044 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:17:26.635044 [debug] [MainThread]: On master: Close
[0m14:17:26.637337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:26.638513 [info ] [MainThread]: 
[0m14:17:26.640261 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m14:17:26.640261 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m14:17:26.650253 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_airport'
[0m14:17:26.650253 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m14:17:26.654934 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m14:17:26.657006 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 14:17:26.650253 => 14:17:26.654934
[0m14:17:26.658520 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m14:17:26.708659 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m14:17:26.715177 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m14:17:26.715177 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m14:17:26.715177 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:26.764232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:26.764232 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m14:17:26.764232 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *
from airports_data
  );
  
[0m14:17:26.764232 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 13: from airports_data
              ^

[0m14:17:26.764232 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: ROLLBACK
[0m14:17:26.772292 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 14:17:26.658520 => 14:17:26.764232
[0m14:17:26.772674 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m14:17:26.775393 [debug] [Thread-1 (]: Database Error in model dim_airport (models\dimentions\dim_airport.sql)
  relation "airports_data" does not exist
  LINE 13: from airports_data
                ^
  compiled Code at target\run\flight_dbt\models\dimentions\dim_airport.sql
[0m14:17:26.775393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfffbe3a-e0d3-4f10-8355-f025eecae36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47CE59C50>]}
[0m14:17:26.775393 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model flights_wh.dim_airport ................... [[31mERROR[0m in 0.14s]
[0m14:17:26.775393 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m14:17:26.782087 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:17:26.782087 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:17:26.782087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m14:17:26.782087 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:17:26.788102 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:17:26.789699 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:17:26.782087 => 14:17:26.789699
[0m14:17:26.789699 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:17:26.857977 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:17:26.861127 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:17:26.861127 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:17:26.863905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:26.917446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:26.917446 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:17:26.917446 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:17:26.940613 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:17:26.948968 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:17:26.948968 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:17:26.948968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:26.948968 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:17:26.948968 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:17:26.948968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:26.980639 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:17:26.980639 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:17:26.980639 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:17:26.992058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:26.996668 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:17:26.996668 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:17:26.996668 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:17:27.007159 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:17:26.789699 => 14:17:26.996668
[0m14:17:27.007741 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:17:27.007741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfffbe3a-e0d3-4f10-8355-f025eecae36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47CD66590>]}
[0m14:17:27.012766 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.23s]
[0m14:17:27.012766 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:17:27.024056 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:17:27.028649 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:17:27.033026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:17:27.036533 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:17:27.053446 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:17:27.057879 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:17:27.039329 => 14:17:27.057879
[0m14:17:27.061941 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:17:27.078421 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:17:27.090899 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:17:27.092145 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:17:27.099084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:27.216771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:17:27.216771 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:17:27.216771 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:17:27.247930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:17:27.250321 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:17:27.250321 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:17:27.265767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:17:27.273933 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:17:27.273933 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:17:27.273933 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:17:27.290866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:17:27.298012 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:17:27.298012 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:17:27.306808 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:17:27.314050 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:17:27.061941 => 14:17:27.311889
[0m14:17:27.314050 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:17:27.316359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfffbe3a-e0d3-4f10-8355-f025eecae36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47CF66590>]}
[0m14:17:27.316359 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.28s]
[0m14:17:27.329131 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:17:27.336768 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:27.336768 [debug] [MainThread]: On master: BEGIN
[0m14:17:27.336768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:27.544911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:17:27.546479 [debug] [MainThread]: On master: COMMIT
[0m14:17:27.546479 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:27.546479 [debug] [MainThread]: On master: COMMIT
[0m14:17:27.546479 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:17:27.546479 [debug] [MainThread]: On master: Close
[0m14:17:27.556168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:27.556168 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:17:27.556168 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:17:27.559679 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:17:27.559679 [info ] [MainThread]: 
[0m14:17:27.559679 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m14:17:27.559679 [debug] [MainThread]: Command end result
[0m14:17:27.575316 [info ] [MainThread]: 
[0m14:17:27.576985 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:17:27.578078 [info ] [MainThread]: 
[0m14:17:27.578078 [error] [MainThread]: [33mDatabase Error in model dim_airport (models\dimentions\dim_airport.sql)[0m
[0m14:17:27.581162 [error] [MainThread]:   relation "airports_data" does not exist
[0m14:17:27.581162 [error] [MainThread]:   LINE 13: from airports_data
[0m14:17:27.583674 [error] [MainThread]:                 ^
[0m14:17:27.583674 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\dimentions\dim_airport.sql
[0m14:17:27.587452 [info ] [MainThread]: 
[0m14:17:27.587452 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:17:27.591382 [debug] [MainThread]: Command `dbt run` failed at 14:17:27.591382 after 1.81 seconds
[0m14:17:27.591382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47A25EE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B47C6CEA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B479A3A110>]}
[0m14:17:27.591382 [debug] [MainThread]: Flushing usage events
[0m14:18:56.723378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9E066050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9E7AA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9E1F1CD0>]}


============================== 14:18:56.725423 | e4369cc1-bdce-4887-8a0b-10efb51f99c8 ==============================
[0m14:18:56.725423 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:18:56.725423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:18:56.823103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4369cc1-bdce-4887-8a0b-10efb51f99c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9E662210>]}
[0m14:18:56.850000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4369cc1-bdce-4887-8a0b-10efb51f99c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9E7AA710>]}
[0m14:18:56.850000 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:18:56.867829 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:18:57.033189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:57.033189 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\schema.yml
[0m14:18:57.073647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4369cc1-bdce-4887-8a0b-10efb51f99c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9EB448D0>]}
[0m14:18:57.085294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4369cc1-bdce-4887-8a0b-10efb51f99c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9EA5E250>]}
[0m14:18:57.085294 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:18:57.085294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4369cc1-bdce-4887-8a0b-10efb51f99c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9E3CAF90>]}
[0m14:18:57.088720 [info ] [MainThread]: 
[0m14:18:57.088720 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:18:57.088720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:18:57.094940 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:18:57.094940 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:18:57.094940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:57.176631 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:18:57.184962 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:18:57.190958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:18:57.201089 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:18:57.209098 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:18:57.209098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:57.349537 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:18:57.352293 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:18:57.352293 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:18:57.382552 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:18:57.382552 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:18:57.382552 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:18:57.414397 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:57.414397 [debug] [MainThread]: On master: BEGIN
[0m14:18:57.414397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:57.540371 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:18:57.540371 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:57.555996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:18:57.634069 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:18:57.634069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4369cc1-bdce-4887-8a0b-10efb51f99c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9E3D5750>]}
[0m14:18:57.634069 [debug] [MainThread]: On master: ROLLBACK
[0m14:18:57.634069 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:57.634069 [debug] [MainThread]: On master: BEGIN
[0m14:18:57.634069 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:18:57.649078 [debug] [MainThread]: On master: COMMIT
[0m14:18:57.650101 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:57.651286 [debug] [MainThread]: On master: COMMIT
[0m14:18:57.653007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:18:57.653007 [debug] [MainThread]: On master: Close
[0m14:18:57.653007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:57.657430 [info ] [MainThread]: 
[0m14:18:57.667932 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m14:18:57.667932 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m14:18:57.676408 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_airport'
[0m14:18:57.676408 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m14:18:57.682117 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m14:18:57.682117 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 14:18:57.676408 => 14:18:57.682117
[0m14:18:57.682117 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m14:18:57.763396 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m14:18:57.763396 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m14:18:57.765422 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m14:18:57.765422 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:57.849375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:57.849375 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m14:18:57.849375 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    select *
from airports_data
  );
  
[0m14:18:57.849375 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 13: from airports_data
              ^

[0m14:18:57.858962 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: ROLLBACK
[0m14:18:57.860788 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 14:18:57.691163 => 14:18:57.860788
[0m14:18:57.860788 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m14:18:57.874687 [debug] [Thread-1 (]: Database Error in model dim_airport (models\dimentions\dim_airport.sql)
  relation "airports_data" does not exist
  LINE 13: from airports_data
                ^
  compiled Code at target\run\flight_dbt\models\dimentions\dim_airport.sql
[0m14:18:57.874687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4369cc1-bdce-4887-8a0b-10efb51f99c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9EB968D0>]}
[0m14:18:57.874687 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model flights_wh.dim_airport ................... [[31mERROR[0m in 0.20s]
[0m14:18:57.874687 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m14:18:57.874687 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:18:57.874687 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:18:57.893444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m14:18:57.894993 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:18:57.907216 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:18:57.916253 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:18:57.898521 => 14:18:57.916253
[0m14:18:57.916253 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:18:57.988675 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:18:57.998641 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:18:57.998641 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:18:57.998641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:58.125134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:58.125134 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:18:58.125134 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:18:58.141035 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:18:58.172378 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:18:58.172378 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:18:58.182205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:58.188225 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:18:58.188225 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:18:58.188225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:58.248107 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:18:58.248107 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:18:58.248107 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:18:58.263069 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:58.279195 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:18:58.279195 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:18:58.279195 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:18:58.299121 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:18:57.922791 => 14:18:58.299121
[0m14:18:58.299121 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:18:58.299121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4369cc1-bdce-4887-8a0b-10efb51f99c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9E7C3C10>]}
[0m14:18:58.308302 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.41s]
[0m14:18:58.316085 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:18:58.316085 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:18:58.316085 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:18:58.326634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:18:58.333692 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:18:58.343121 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:18:58.353958 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:18:58.335801 => 14:18:58.352699
[0m14:18:58.357403 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:18:58.385675 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:18:58.385675 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:18:58.392237 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:18:58.392237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:58.543126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:18:58.543126 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:18:58.551700 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:18:58.567681 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:18:58.583396 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:18:58.583396 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:18:58.598624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:18:58.598624 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:18:58.598624 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:18:58.598624 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:18:58.616149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:18:58.630175 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:18:58.630175 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:18:58.630175 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:18:58.630175 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:18:58.359421 => 14:18:58.630175
[0m14:18:58.630175 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:18:58.630175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4369cc1-bdce-4887-8a0b-10efb51f99c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9ECE7F90>]}
[0m14:18:58.630175 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.30s]
[0m14:18:58.647069 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:18:58.652648 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:58.652648 [debug] [MainThread]: On master: BEGIN
[0m14:18:58.652648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:58.774692 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:18:58.774692 [debug] [MainThread]: On master: COMMIT
[0m14:18:58.774692 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:58.774692 [debug] [MainThread]: On master: COMMIT
[0m14:18:58.774692 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:18:58.774692 [debug] [MainThread]: On master: Close
[0m14:18:58.774692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:58.790393 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:18:58.792731 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:18:58.792731 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:18:58.794090 [info ] [MainThread]: 
[0m14:18:58.794090 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m14:18:58.794090 [debug] [MainThread]: Command end result
[0m14:18:58.820387 [info ] [MainThread]: 
[0m14:18:58.824223 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:18:58.824223 [info ] [MainThread]: 
[0m14:18:58.830749 [error] [MainThread]: [33mDatabase Error in model dim_airport (models\dimentions\dim_airport.sql)[0m
[0m14:18:58.830749 [error] [MainThread]:   relation "airports_data" does not exist
[0m14:18:58.830749 [error] [MainThread]:   LINE 13: from airports_data
[0m14:18:58.840563 [error] [MainThread]:                 ^
[0m14:18:58.844868 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\dimentions\dim_airport.sql
[0m14:18:58.846889 [info ] [MainThread]: 
[0m14:18:58.846889 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:18:58.853648 [debug] [MainThread]: Command `dbt run` failed at 14:18:58.853648 after 2.15 seconds
[0m14:18:58.855381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9E432050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9EA94A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D9EA94490>]}
[0m14:18:58.855381 [debug] [MainThread]: Flushing usage events
[0m14:22:29.422647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF21201C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF255FB710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF2562E710>]}


============================== 14:22:29.424263 | 12b35f0d-f40b-4c22-b1d0-3a2671d52057 ==============================
[0m14:22:29.424263 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:22:29.424263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:22:29.591411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12b35f0d-f40b-4c22-b1d0-3a2671d52057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF25D4BD50>]}
[0m14:22:29.624669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12b35f0d-f40b-4c22-b1d0-3a2671d52057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF256B1790>]}
[0m14:22:29.624669 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:22:29.649672 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:22:29.672976 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:22:29.672976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12b35f0d-f40b-4c22-b1d0-3a2671d52057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF25FE3F10>]}
[0m14:22:30.640498 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m14:22:30.662532 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m14:22:30.764445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12b35f0d-f40b-4c22-b1d0-3a2671d52057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF2562DE50>]}
[0m14:22:30.781949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12b35f0d-f40b-4c22-b1d0-3a2671d52057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF260AFD50>]}
[0m14:22:30.783386 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:22:30.783942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12b35f0d-f40b-4c22-b1d0-3a2671d52057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF2605B150>]}
[0m14:22:30.785231 [info ] [MainThread]: 
[0m14:22:30.785231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:22:30.790177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:22:30.850090 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:22:30.853675 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:22:30.858730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:31.023998 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:22:31.031040 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:22:31.042605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:22:31.062955 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:22:31.062955 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:22:31.062955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:31.341848 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:22:31.356144 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:22:31.357662 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:22:31.373333 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:22:31.389966 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:22:31.389966 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:22:31.407052 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:31.407052 [debug] [MainThread]: On master: BEGIN
[0m14:22:31.420079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:31.556489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:22:31.556489 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:31.563501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:22:31.611262 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:22:31.622473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12b35f0d-f40b-4c22-b1d0-3a2671d52057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF260FA1D0>]}
[0m14:22:31.622473 [debug] [MainThread]: On master: ROLLBACK
[0m14:22:31.626998 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:31.626998 [debug] [MainThread]: On master: BEGIN
[0m14:22:31.628764 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:22:31.628764 [debug] [MainThread]: On master: COMMIT
[0m14:22:31.631052 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:31.631052 [debug] [MainThread]: On master: COMMIT
[0m14:22:31.632572 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:22:31.632572 [debug] [MainThread]: On master: Close
[0m14:22:31.632572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:31.636111 [info ] [MainThread]: 
[0m14:22:31.645628 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:22:31.645628 [info ] [Thread-1 (]: 1 of 2 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:22:31.645628 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:22:31.645628 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:22:31.655760 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:22:31.659773 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:22:31.651273 => 14:22:31.655760
[0m14:22:31.659773 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:22:31.717195 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:22:31.717195 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:22:31.717195 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:22:31.717195 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:31.774155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:22:31.774155 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:22:31.774155 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:22:31.788325 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:22:31.806222 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:22:31.806222 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:22:31.808644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:22:31.813034 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:22:31.822401 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:22:31.824431 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:22:31.865134 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:22:31.872891 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:22:31.872891 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:22:31.879482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:22:31.879482 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:22:31.879482 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:22:31.896861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:22:31.899969 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:22:31.659773 => 14:22:31.899969
[0m14:22:31.899969 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:22:31.907906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b35f0d-f40b-4c22-b1d0-3a2671d52057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF26154A90>]}
[0m14:22:31.912207 [info ] [Thread-1 (]: 1 of 2 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.26s]
[0m14:22:31.917968 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:22:31.922837 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:22:31.925691 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:22:31.931179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:22:31.932776 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:22:31.948285 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:22:31.952905 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:22:31.934980 => 14:22:31.951874
[0m14:22:31.952905 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:22:31.975224 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:22:31.976738 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:22:31.976738 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:22:31.976738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:32.104166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:22:32.104166 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:22:32.111192 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:22:32.134036 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:22:32.144415 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:22:32.144415 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:22:32.152605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:22:32.160374 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:22:32.160374 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:22:32.160374 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:22:32.180631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:22:32.183990 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:22:32.188704 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:22:32.190632 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:22:32.193428 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:22:31.960006 => 14:22:32.193428
[0m14:22:32.193428 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:22:32.193428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12b35f0d-f40b-4c22-b1d0-3a2671d52057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF2600CA50>]}
[0m14:22:32.199295 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.26s]
[0m14:22:32.201258 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:22:32.206843 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:32.208534 [debug] [MainThread]: On master: BEGIN
[0m14:22:32.208993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:32.317443 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:22:32.319716 [debug] [MainThread]: On master: COMMIT
[0m14:22:32.320726 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:32.320855 [debug] [MainThread]: On master: COMMIT
[0m14:22:32.322540 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:22:32.322540 [debug] [MainThread]: On master: Close
[0m14:22:32.325858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:32.325858 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:22:32.325858 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:22:32.325858 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:22:32.325858 [info ] [MainThread]: 
[0m14:22:32.325858 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m14:22:32.334643 [debug] [MainThread]: Command end result
[0m14:22:32.346719 [info ] [MainThread]: 
[0m14:22:32.353234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:32.353234 [info ] [MainThread]: 
[0m14:22:32.361619 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:22:32.364997 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:32.364997 after 2.99 seconds
[0m14:22:32.364997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF25BB4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF25353750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF26108650>]}
[0m14:22:32.364997 [debug] [MainThread]: Flushing usage events
[0m14:23:21.456531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140F85E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140F5604D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140F783C10>]}


============================== 14:23:21.456531 | 4669120e-01dd-48ee-a055-53a044a45a4a ==============================
[0m14:23:21.456531 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:23:21.456531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:23:21.555248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4669120e-01dd-48ee-a055-53a044a45a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140F8CE090>]}
[0m14:23:21.581760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4669120e-01dd-48ee-a055-53a044a45a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140F9317D0>]}
[0m14:23:21.581760 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:23:21.594321 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:23:21.715016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:23:21.715016 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\example\dim.sql
[0m14:23:21.754973 [debug] [MainThread]: 1699: static parser successfully parsed example\dim.sql
[0m14:23:21.786718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4669120e-01dd-48ee-a055-53a044a45a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141000DBD0>]}
[0m14:23:21.798198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4669120e-01dd-48ee-a055-53a044a45a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141000EF50>]}
[0m14:23:21.802753 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:23:21.802753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4669120e-01dd-48ee-a055-53a044a45a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140BCC8710>]}
[0m14:23:21.802753 [info ] [MainThread]: 
[0m14:23:21.802753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:21.802753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:23:21.820129 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:23:21.825505 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:23:21.825505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:21.891827 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:23:21.891827 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:23:21.891827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:23:21.900053 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:23:21.900053 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:23:21.900053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:21.973006 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:23:21.976716 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:23:21.977272 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:23:21.987842 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:23:21.987842 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:23:21.987842 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:23:22.003484 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:22.003484 [debug] [MainThread]: On master: BEGIN
[0m14:23:22.003484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:22.104867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:22.104867 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:22.113361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:22.130802 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:23:22.130802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4669120e-01dd-48ee-a055-53a044a45a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140F854F10>]}
[0m14:23:22.130802 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:22.144853 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:22.145956 [debug] [MainThread]: On master: BEGIN
[0m14:23:22.147383 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:22.147383 [debug] [MainThread]: On master: COMMIT
[0m14:23:22.147383 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:22.147383 [debug] [MainThread]: On master: COMMIT
[0m14:23:22.149186 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:23:22.149186 [debug] [MainThread]: On master: Close
[0m14:23:22.151461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:22.152685 [info ] [MainThread]: 
[0m14:23:22.155123 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:23:22.160634 [info ] [Thread-1 (]: 1 of 2 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:23:22.161809 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:23:22.163825 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:23:22.168084 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:23:22.170169 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:23:22.163825 => 14:23:22.169094
[0m14:23:22.171804 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:23:22.242615 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:23:22.242615 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:23:22.242615 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:23:22.242615 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:22.291633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:23:22.291633 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:23:22.296177 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:23:22.297206 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:23:22.307718 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:23:22.307718 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:23:22.307718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:22.307718 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:23:22.307718 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:23:22.307718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:22.338983 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:23:22.338983 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:23:22.338983 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:23:22.349344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:23:22.355969 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:23:22.356481 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:23:22.356481 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:23:22.356481 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:23:22.172349 => 14:23:22.356481
[0m14:23:22.356481 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:23:22.356481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4669120e-01dd-48ee-a055-53a044a45a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214100215D0>]}
[0m14:23:22.356481 [info ] [Thread-1 (]: 1 of 2 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.19s]
[0m14:23:22.366254 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:23:22.366254 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:23:22.366254 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:23:22.366254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:23:22.370762 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:23:22.372923 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:23:22.372923 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:23:22.371868 => 14:23:22.372923
[0m14:23:22.372923 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:23:22.383883 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:23:22.383883 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:23:22.387431 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:23:22.387431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:22.436310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:23:22.444320 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:23:22.444320 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:23:22.452752 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:23:22.452752 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:23:22.452752 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:23:22.460260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:22.460260 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:23:22.460260 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:23:22.460260 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:23:22.469673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:23:22.469673 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:23:22.469673 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:23:22.469673 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:23:22.469673 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:23:22.372923 => 14:23:22.469673
[0m14:23:22.469673 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:23:22.477185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4669120e-01dd-48ee-a055-53a044a45a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140FFE9F10>]}
[0m14:23:22.477185 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.11s]
[0m14:23:22.480223 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:23:22.481999 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:22.481999 [debug] [MainThread]: On master: BEGIN
[0m14:23:22.481999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:22.533884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:22.533884 [debug] [MainThread]: On master: COMMIT
[0m14:23:22.533884 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:22.533884 [debug] [MainThread]: On master: COMMIT
[0m14:23:22.533884 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:23:22.533884 [debug] [MainThread]: On master: Close
[0m14:23:22.541901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:22.541901 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:23:22.543561 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:23:22.544074 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:23:22.544074 [info ] [MainThread]: 
[0m14:23:22.544074 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m14:23:22.548292 [debug] [MainThread]: Command end result
[0m14:23:22.559500 [info ] [MainThread]: 
[0m14:23:22.563549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:22.565573 [info ] [MainThread]: 
[0m14:23:22.565573 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:23:22.574629 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:22.573605 after 1.14 seconds
[0m14:23:22.574629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140F61A990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140FC9BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002140FC9BE50>]}
[0m14:23:22.574629 [debug] [MainThread]: Flushing usage events
[0m14:25:12.782540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40A2AB8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40A5ABCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40A5C4D10>]}


============================== 14:25:12.790190 | 0f1c3ccc-ed48-4360-b4d7-47dba2930407 ==============================
[0m14:25:12.790190 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:25:12.790190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:25:12.915796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f1c3ccc-ed48-4360-b4d7-47dba2930407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40ACD9ED0>]}
[0m14:25:12.964026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f1c3ccc-ed48-4360-b4d7-47dba2930407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40AA321D0>]}
[0m14:25:12.973222 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:25:12.989900 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:25:13.144980 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:25:13.146372 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\example\d.sql
[0m14:25:13.147437 [debug] [MainThread]: Partial parsing: deleted file: flight_dbt://models\example\dim.sql
[0m14:25:13.173156 [debug] [MainThread]: 1699: static parser successfully parsed example\d.sql
[0m14:25:13.198402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f1c3ccc-ed48-4360-b4d7-47dba2930407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40ACF3BD0>]}
[0m14:25:13.214083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f1c3ccc-ed48-4360-b4d7-47dba2930407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40AE0BB90>]}
[0m14:25:13.214083 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:25:13.215838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1c3ccc-ed48-4360-b4d7-47dba2930407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40AD56CD0>]}
[0m14:25:13.217163 [info ] [MainThread]: 
[0m14:25:13.217163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:13.217163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:25:13.233331 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:25:13.233331 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:25:13.233331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:13.320183 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:25:13.323598 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:25:13.328620 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:25:13.352814 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:25:13.356370 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:25:13.356370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:13.488414 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:25:13.492581 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:25:13.492581 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:25:13.518129 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:25:13.522778 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:25:13.522778 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:25:13.544500 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:13.544500 [debug] [MainThread]: On master: BEGIN
[0m14:25:13.544500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:13.697264 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:13.698630 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:13.698630 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:25:13.719181 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:25:13.738626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1c3ccc-ed48-4360-b4d7-47dba2930407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40A6ADA90>]}
[0m14:25:13.738626 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:13.740410 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:13.740410 [debug] [MainThread]: On master: BEGIN
[0m14:25:13.741896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:13.741896 [debug] [MainThread]: On master: COMMIT
[0m14:25:13.741896 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:13.743384 [debug] [MainThread]: On master: COMMIT
[0m14:25:13.743384 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:25:13.744852 [debug] [MainThread]: On master: Close
[0m14:25:13.745357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:13.747211 [info ] [MainThread]: 
[0m14:25:13.754256 [debug] [Thread-1 (]: Began running node model.flight_dbt.d
[0m14:25:13.754256 [info ] [Thread-1 (]: 1 of 3 START sql view model flights_wh.d ....................................... [RUN]
[0m14:25:13.756311 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.d'
[0m14:25:13.756932 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.d
[0m14:25:13.758471 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.d"
[0m14:25:13.758471 [debug] [Thread-1 (]: Timing info for model.flight_dbt.d (compile): 14:25:13.757960 => 14:25:13.758471
[0m14:25:13.762577 [debug] [Thread-1 (]: Began executing node model.flight_dbt.d
[0m14:25:13.816298 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.d"
[0m14:25:13.818338 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.d"
[0m14:25:13.819846 [debug] [Thread-1 (]: On model.flight_dbt.d: BEGIN
[0m14:25:13.819846 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:13.934486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:25:13.934486 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.d"
[0m14:25:13.938593 [debug] [Thread-1 (]: On model.flight_dbt.d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.d"} */

  create view "flights_dbt_course"."flights_wh"."d__dbt_tmp"
    
    
  as (
    
  );
[0m14:25:13.940926 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m14:25:13.943426 [debug] [Thread-1 (]: On model.flight_dbt.d: ROLLBACK
[0m14:25:13.945452 [debug] [Thread-1 (]: Timing info for model.flight_dbt.d (execute): 14:25:13.763680 => 14:25:13.945452
[0m14:25:13.946982 [debug] [Thread-1 (]: On model.flight_dbt.d: Close
[0m14:25:13.955012 [debug] [Thread-1 (]: Database Error in model d (models\example\d.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled Code at target\run\flight_dbt\models\example\d.sql
[0m14:25:13.963015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f1c3ccc-ed48-4360-b4d7-47dba2930407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40ACC5C50>]}
[0m14:25:13.965356 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model flights_wh.d .............................. [[31mERROR[0m in 0.21s]
[0m14:25:13.965356 [debug] [Thread-1 (]: Finished running node model.flight_dbt.d
[0m14:25:13.969523 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:25:13.971352 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:25:13.972463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.d, now model.flight_dbt.my_first_dbt_model)
[0m14:25:13.972463 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:25:13.972463 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:25:13.972463 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:25:13.972463 => 14:25:13.972463
[0m14:25:13.989983 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:25:14.005279 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:25:14.007058 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:25:14.009545 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:25:14.011560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:14.132916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:25:14.134791 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:25:14.135368 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:25:14.151110 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:14.165303 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:25:14.172074 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:25:14.173907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:14.181437 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:25:14.188563 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:25:14.189083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:14.214191 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:25:14.214701 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:25:14.214701 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:25:14.229969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:25:14.229969 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:25:14.229969 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:25:14.229969 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:14.229969 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:25:13.990539 => 14:25:14.229969
[0m14:25:14.229969 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:25:14.229969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f1c3ccc-ed48-4360-b4d7-47dba2930407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40AF18050>]}
[0m14:25:14.244481 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.26s]
[0m14:25:14.246701 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:25:14.247207 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:25:14.248557 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:25:14.252407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:25:14.254778 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:25:14.260938 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:25:14.260938 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:25:14.255886 => 14:25:14.260938
[0m14:25:14.260938 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:25:14.277086 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:25:14.277086 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:25:14.286689 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:25:14.289513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:14.399437 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:25:14.399437 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:25:14.404971 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:25:14.428671 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:25:14.434763 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:25:14.444859 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:25:14.444859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:25:14.444859 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:25:14.444859 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:25:14.460584 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:25:14.460584 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:25:14.480330 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:25:14.488385 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:25:14.488385 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:25:14.496425 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:25:14.268974 => 14:25:14.496425
[0m14:25:14.496425 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:25:14.504706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f1c3ccc-ed48-4360-b4d7-47dba2930407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40AA55790>]}
[0m14:25:14.510360 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.26s]
[0m14:25:14.515384 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:25:14.520430 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:14.525846 [debug] [MainThread]: On master: BEGIN
[0m14:25:14.525846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:14.671788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:25:14.671788 [debug] [MainThread]: On master: COMMIT
[0m14:25:14.683308 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:14.683308 [debug] [MainThread]: On master: COMMIT
[0m14:25:14.683308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:25:14.683308 [debug] [MainThread]: On master: Close
[0m14:25:14.683308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:14.691647 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:25:14.692164 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:25:14.693724 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:25:14.693724 [info ] [MainThread]: 
[0m14:25:14.696146 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m14:25:14.701086 [debug] [MainThread]: Command end result
[0m14:25:14.718834 [info ] [MainThread]: 
[0m14:25:14.720434 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:25:14.723295 [info ] [MainThread]: 
[0m14:25:14.724728 [error] [MainThread]: [33mDatabase Error in model d (models\example\d.sql)[0m
[0m14:25:14.726885 [error] [MainThread]:   syntax error at or near ")"
[0m14:25:14.730907 [error] [MainThread]:   LINE 8:   );
[0m14:25:14.736941 [error] [MainThread]:             ^
[0m14:25:14.740588 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\example\d.sql
[0m14:25:14.740588 [info ] [MainThread]: 
[0m14:25:14.740588 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:25:14.750337 [debug] [MainThread]: Command `dbt run` failed at 14:25:14.750337 after 2.00 seconds
[0m14:25:14.750337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A40A0C1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4040EA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A404392D10>]}
[0m14:25:14.750337 [debug] [MainThread]: Flushing usage events
[0m14:26:21.326614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8B9DBE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8B98C9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8BA051390>]}


============================== 14:26:21.334861 | 3bffbfb9-3c19-494c-9fd9-0be296180f7b ==============================
[0m14:26:21.334861 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:26:21.340566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:26:21.550132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bffbfb9-3c19-494c-9fd9-0be296180f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8BA19BD90>]}
[0m14:26:21.586162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bffbfb9-3c19-494c-9fd9-0be296180f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8BA19BD90>]}
[0m14:26:21.586162 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:26:21.629482 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:26:21.735197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:26:21.736337 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\example\d.sql
[0m14:26:21.762410 [debug] [MainThread]: 1699: static parser successfully parsed example\d.sql
[0m14:26:21.778394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bffbfb9-3c19-494c-9fd9-0be296180f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8BA4E0C90>]}
[0m14:26:21.796299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bffbfb9-3c19-494c-9fd9-0be296180f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8BA5E6910>]}
[0m14:26:21.796299 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:26:21.796299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bffbfb9-3c19-494c-9fd9-0be296180f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8B61B8590>]}
[0m14:26:21.801623 [info ] [MainThread]: 
[0m14:26:21.801623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:26:21.801623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:26:21.829910 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:26:21.833178 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:26:21.834201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:21.942583 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:26:21.942583 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:26:21.946898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:26:21.948156 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:26:21.948156 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:26:21.948156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:22.191024 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:26:22.191024 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:26:22.194791 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:26:22.218048 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:26:22.225134 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:26:22.225134 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:26:22.240837 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:22.256499 [debug] [MainThread]: On master: BEGIN
[0m14:26:22.256499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:22.437287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:26:22.437287 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:22.443879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:26:22.539057 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:26:22.548965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bffbfb9-3c19-494c-9fd9-0be296180f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8B61B8590>]}
[0m14:26:22.548965 [debug] [MainThread]: On master: ROLLBACK
[0m14:26:22.551835 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:22.553596 [debug] [MainThread]: On master: BEGIN
[0m14:26:22.555123 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:26:22.556400 [debug] [MainThread]: On master: COMMIT
[0m14:26:22.556400 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:22.556400 [debug] [MainThread]: On master: COMMIT
[0m14:26:22.556400 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:26:22.556400 [debug] [MainThread]: On master: Close
[0m14:26:22.556400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:22.564454 [info ] [MainThread]: 
[0m14:26:22.577309 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:26:22.579322 [info ] [Thread-1 (]: 1 of 2 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:26:22.582655 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:26:22.582655 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:26:22.593255 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:26:22.597664 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:26:22.582655 => 14:26:22.596465
[0m14:26:22.598724 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:26:22.669283 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:26:22.669283 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:26:22.669283 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:26:22.669283 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:26:22.741092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:26:22.741092 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:26:22.744885 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:26:22.759823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:26:22.772976 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:26:22.772976 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:26:22.780568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:26:22.789151 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:26:22.789151 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:26:22.789151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:26:22.821103 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:26:22.826832 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:26:22.826832 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:26:22.827943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:26:22.832148 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:26:22.832148 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:26:22.836496 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:26:22.839311 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:26:22.598724 => 14:26:22.839311
[0m14:26:22.839858 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:26:22.839858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bffbfb9-3c19-494c-9fd9-0be296180f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8BA5BF990>]}
[0m14:26:22.841527 [info ] [Thread-1 (]: 1 of 2 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.26s]
[0m14:26:22.841527 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:26:22.844151 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:26:22.845627 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:26:22.846157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:26:22.846157 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:26:22.848158 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:26:22.848158 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:26:22.846157 => 14:26:22.848158
[0m14:26:22.848158 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:26:22.855035 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:26:22.858622 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:26:22.858622 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:26:22.860630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:22.917725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:26:22.918953 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:26:22.918953 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:26:22.926954 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:26:22.927459 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:26:22.927459 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:26:22.932121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:26:22.933965 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:26:22.934507 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:26:22.934507 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:26:22.936798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:26:22.937093 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:26:22.937093 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:26:22.937093 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:26:22.942102 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:26:22.852205 => 14:26:22.942102
[0m14:26:22.942102 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:26:22.942102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bffbfb9-3c19-494c-9fd9-0be296180f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8BA57BFD0>]}
[0m14:26:22.942102 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m14:26:22.947158 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:26:22.949287 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:22.949793 [debug] [MainThread]: On master: BEGIN
[0m14:26:22.949793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:26:23.003851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:26:23.005188 [debug] [MainThread]: On master: COMMIT
[0m14:26:23.005188 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:23.005188 [debug] [MainThread]: On master: COMMIT
[0m14:26:23.006699 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:26:23.006699 [debug] [MainThread]: On master: Close
[0m14:26:23.006699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:23.006699 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:26:23.006699 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:26:23.006699 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:26:23.006699 [info ] [MainThread]: 
[0m14:26:23.006699 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m14:26:23.012110 [debug] [MainThread]: Command end result
[0m14:26:23.023263 [info ] [MainThread]: 
[0m14:26:23.024917 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:23.025940 [info ] [MainThread]: 
[0m14:26:23.025940 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:26:23.027463 [debug] [MainThread]: Command `dbt run` succeeded at 14:26:23.027463 after 1.74 seconds
[0m14:26:23.029202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8B9AE5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8B3B03AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8B3819390>]}
[0m14:26:23.029710 [debug] [MainThread]: Flushing usage events
[0m14:37:54.453756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D399D9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D39BEBF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3A04BD50>]}


============================== 14:37:54.453756 | 11afcfc4-b14c-4cf2-b81a-bfa0519ad1f7 ==============================
[0m14:37:54.453756 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:37:54.453756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:37:54.595247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11afcfc4-b14c-4cf2-b81a-bfa0519ad1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D39C84110>]}
[0m14:37:54.628691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11afcfc4-b14c-4cf2-b81a-bfa0519ad1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3A32C210>]}
[0m14:37:54.628691 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:37:54.645295 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:37:54.728590 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m14:37:54.728590 [debug] [MainThread]: Partial parsing: deleted file: flight_dbt://models\example\d.sql
[0m14:37:54.745314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11afcfc4-b14c-4cf2-b81a-bfa0519ad1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3965E150>]}
[0m14:37:54.759370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11afcfc4-b14c-4cf2-b81a-bfa0519ad1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D39928F90>]}
[0m14:37:54.761099 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:37:54.761659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11afcfc4-b14c-4cf2-b81a-bfa0519ad1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D36078710>]}
[0m14:37:54.764278 [info ] [MainThread]: 
[0m14:37:54.764278 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:54.767792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:37:54.785631 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:37:54.785631 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:37:54.785631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:54.961266 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:37:54.968339 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:37:54.975575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:37:54.984001 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:37:54.984001 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:37:54.984001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:55.147034 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:37:55.147034 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:37:55.147034 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:37:55.177691 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:37:55.178263 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:37:55.178263 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:37:55.195308 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:55.195308 [debug] [MainThread]: On master: BEGIN
[0m14:37:55.195308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:55.328194 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:37:55.328194 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:55.328194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:55.351922 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:37:55.361554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11afcfc4-b14c-4cf2-b81a-bfa0519ad1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D39E1EC50>]}
[0m14:37:55.365583 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:55.370354 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:55.371720 [debug] [MainThread]: On master: BEGIN
[0m14:37:55.374384 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:37:55.376158 [debug] [MainThread]: On master: COMMIT
[0m14:37:55.376158 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:55.376158 [debug] [MainThread]: On master: COMMIT
[0m14:37:55.376158 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:37:55.381681 [debug] [MainThread]: On master: Close
[0m14:37:55.381681 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:55.381681 [info ] [MainThread]: 
[0m14:37:55.404880 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:37:55.408721 [info ] [Thread-1 (]: 1 of 2 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:37:55.414711 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:37:55.414711 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:37:55.427990 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:37:55.436369 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:37:55.414711 => 14:37:55.435338
[0m14:37:55.436369 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:37:55.535058 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:37:55.543959 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:37:55.543959 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:37:55.545329 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:37:55.643415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:37:55.643415 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:37:55.645486 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:37:55.660851 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:37:55.661425 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:37:55.661425 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:37:55.676938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:37:55.679975 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:37:55.679975 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:37:55.679975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:37:55.708375 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:37:55.708375 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:37:55.708375 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:37:55.711741 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:37:55.714309 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:37:55.714309 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:37:55.721005 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:37:55.724257 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:37:55.436369 => 14:37:55.724257
[0m14:37:55.725385 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:37:55.725916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11afcfc4-b14c-4cf2-b81a-bfa0519ad1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3A4B9410>]}
[0m14:37:55.727428 [info ] [Thread-1 (]: 1 of 2 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.31s]
[0m14:37:55.729938 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:37:55.729938 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:37:55.729938 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:37:55.733940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:37:55.733940 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:37:55.733940 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:37:55.740006 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:37:55.733940 => 14:37:55.733940
[0m14:37:55.740006 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:37:55.744340 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:37:55.744340 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:37:55.744340 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:37:55.744340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:55.808555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:37:55.808555 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:37:55.808555 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:37:55.818379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:37:55.821933 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:37:55.821933 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:37:55.821933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:37:55.825979 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:37:55.827102 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:37:55.827102 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:37:55.829018 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:37:55.832648 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:37:55.832648 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:37:55.832648 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:37:55.837837 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:37:55.740006 => 14:37:55.836791
[0m14:37:55.837837 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:37:55.838936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11afcfc4-b14c-4cf2-b81a-bfa0519ad1f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3A45AED0>]}
[0m14:37:55.838936 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m14:37:55.842207 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:37:55.843474 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:55.844608 [debug] [MainThread]: On master: BEGIN
[0m14:37:55.845151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:55.925863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:37:55.926871 [debug] [MainThread]: On master: COMMIT
[0m14:37:55.926871 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:55.926871 [debug] [MainThread]: On master: COMMIT
[0m14:37:55.926871 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:37:55.926871 [debug] [MainThread]: On master: Close
[0m14:37:55.926871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:55.926871 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:37:55.931915 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:37:55.931915 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:37:55.931915 [info ] [MainThread]: 
[0m14:37:55.934156 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m14:37:55.935163 [debug] [MainThread]: Command end result
[0m14:37:55.943179 [info ] [MainThread]: 
[0m14:37:55.943179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:55.943179 [info ] [MainThread]: 
[0m14:37:55.943179 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:37:55.943179 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:55.943179 after 1.52 seconds
[0m14:37:55.943179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3372B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3372A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3372B390>]}
[0m14:37:55.943179 [debug] [MainThread]: Flushing usage events
[0m14:39:43.569141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099C5F7B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099C62BE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099CA8BD50>]}


============================== 14:39:43.576675 | 28537602-cc33-42c6-a831-5a6c4591e148 ==============================
[0m14:39:43.576675 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:39:43.576675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:39:43.685476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28537602-cc33-42c6-a831-5a6c4591e148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099C6C6250>]}
[0m14:39:43.703724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28537602-cc33-42c6-a831-5a6c4591e148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099C6C6250>]}
[0m14:39:43.703724 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:39:43.717181 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:39:43.822146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:39:43.822146 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\example\dim.sql
[0m14:39:43.861644 [debug] [MainThread]: 1699: static parser successfully parsed example\dim.sql
[0m14:39:43.899515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28537602-cc33-42c6-a831-5a6c4591e148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099CAA6750>]}
[0m14:39:43.913937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28537602-cc33-42c6-a831-5a6c4591e148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099CEE6710>]}
[0m14:39:43.913937 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:39:43.928108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28537602-cc33-42c6-a831-5a6c4591e148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020998AB8710>]}
[0m14:39:43.930576 [info ] [MainThread]: 
[0m14:39:43.936625 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:43.938614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m14:39:43.994246 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m14:39:43.994246 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m14:39:44.002326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:44.165072 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:39:44.165072 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m14:39:44.171153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m14:39:44.188379 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:39:44.188379 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m14:39:44.190394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:44.332425 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:39:44.332425 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m14:39:44.337641 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:39:44.363637 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:39:44.371740 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m14:39:44.371740 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m14:39:44.384192 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:44.384192 [debug] [MainThread]: On master: BEGIN
[0m14:39:44.399920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:44.555752 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:39:44.555752 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:44.555752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:44.591161 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:39:44.608619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28537602-cc33-42c6-a831-5a6c4591e148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099C4199D0>]}
[0m14:39:44.608619 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:44.614231 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:44.614231 [debug] [MainThread]: On master: BEGIN
[0m14:39:44.615993 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:39:44.615993 [debug] [MainThread]: On master: COMMIT
[0m14:39:44.617411 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:44.617411 [debug] [MainThread]: On master: COMMIT
[0m14:39:44.617411 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:39:44.620155 [debug] [MainThread]: On master: Close
[0m14:39:44.621587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:44.622596 [info ] [MainThread]: 
[0m14:39:44.632465 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m14:39:44.632465 [info ] [Thread-1 (]: 1 of 2 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m14:39:44.637095 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.my_first_dbt_model'
[0m14:39:44.638475 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m14:39:44.639638 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m14:39:44.645542 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 14:39:44.638475 => 14:39:44.644529
[0m14:39:44.645542 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m14:39:44.702485 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m14:39:44.703681 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:39:44.705246 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m14:39:44.706962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:44.796018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:39:44.796018 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:39:44.799488 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m14:39:44.818038 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:44.830062 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:39:44.830062 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:39:44.830062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:44.845773 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:39:44.854043 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:39:44.854043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:44.892842 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:39:44.892842 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:39:44.892842 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m14:39:44.908521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:39:44.912370 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m14:39:44.912370 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:39:44.920492 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:44.924502 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 14:39:44.645542 => 14:39:44.920492
[0m14:39:44.924502 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m14:39:44.924502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28537602-cc33-42c6-a831-5a6c4591e148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099C36AB90>]}
[0m14:39:44.924502 [info ] [Thread-1 (]: 1 of 2 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.29s]
[0m14:39:44.924502 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m14:39:44.929380 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m14:39:44.929380 [info ] [Thread-1 (]: 2 of 2 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:39:44.929380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m14:39:44.929380 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m14:39:44.929380 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m14:39:44.929380 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 14:39:44.929380 => 14:39:44.929380
[0m14:39:44.929380 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m14:39:44.941879 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m14:39:44.941879 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:39:44.941879 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m14:39:44.941879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:45.014277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:39:45.015832 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:39:45.015832 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:39:45.025228 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:45.025228 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:39:45.025228 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:39:45.030737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:45.033926 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:39:45.035625 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:39:45.035625 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m14:39:45.037445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:39:45.041383 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m14:39:45.041383 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:39:45.041383 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:45.041383 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 14:39:44.929380 => 14:39:45.041383
[0m14:39:45.047436 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m14:39:45.049025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28537602-cc33-42c6-a831-5a6c4591e148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099CDB9690>]}
[0m14:39:45.049025 [info ] [Thread-1 (]: 2 of 2 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.12s]
[0m14:39:45.052825 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m14:39:45.056007 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:45.056007 [debug] [MainThread]: On master: BEGIN
[0m14:39:45.056007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:45.125252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:39:45.126622 [debug] [MainThread]: On master: COMMIT
[0m14:39:45.126622 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:45.128112 [debug] [MainThread]: On master: COMMIT
[0m14:39:45.128112 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:39:45.129410 [debug] [MainThread]: On master: Close
[0m14:39:45.130416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:45.130416 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m14:39:45.131425 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m14:39:45.131425 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m14:39:45.131425 [info ] [MainThread]: 
[0m14:39:45.131425 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m14:39:45.131425 [debug] [MainThread]: Command end result
[0m14:39:45.144719 [info ] [MainThread]: 
[0m14:39:45.146245 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:45.149167 [info ] [MainThread]: 
[0m14:39:45.149167 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:39:45.152804 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:45.152804 after 1.61 seconds
[0m14:39:45.152804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099615B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099615A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099615B390>]}
[0m14:39:45.154313 [debug] [MainThread]: Flushing usage events
[0m14:59:07.837226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03761AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D5123D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D91BFD0>]}


============================== 14:59:07.854113 | e9039b5e-85d0-4424-8df7-4ef74dca52b6 ==============================
[0m14:59:07.854113 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:59:07.860742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:59:07.862827 [info ] [MainThread]: dbt version: 1.5.2
[0m14:59:07.864966 [info ] [MainThread]: python version: 3.11.4
[0m14:59:07.866938 [info ] [MainThread]: python path: C:\Users\oa\AppData\Local\Programs\Python\Python311\python.exe
[0m14:59:07.866938 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m14:59:07.866938 [info ] [MainThread]: Using profiles.yml file at C:\Users\oa\.dbt\profiles.yml
[0m14:59:07.872173 [info ] [MainThread]: Using dbt_project.yml file at C:\flights_dbt_course\flight_dbt\dbt_project.yml
[0m14:59:07.874186 [info ] [MainThread]: Configuration:
[0m14:59:07.948246 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:59:08.013690 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:59:08.013690 [info ] [MainThread]: Required dependencies:
[0m14:59:08.019766 [debug] [MainThread]: Executing "git --help"
[0m14:59:08.068030 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:59:08.068540 [debug] [MainThread]: STDERR: "b''"
[0m14:59:08.069551 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:59:08.069551 [info ] [MainThread]: Connection:
[0m14:59:08.069551 [info ] [MainThread]:   host: localhost
[0m14:59:08.072559 [info ] [MainThread]:   port: 5432
[0m14:59:08.073564 [info ] [MainThread]:   user: postgres
[0m14:59:08.074601 [info ] [MainThread]:   database: flights_dbt_course
[0m14:59:08.075140 [info ] [MainThread]:   schema: flights_wh
[0m14:59:08.076574 [info ] [MainThread]:   search_path: None
[0m14:59:08.077677 [info ] [MainThread]:   keepalives_idle: 0
[0m14:59:08.079362 [info ] [MainThread]:   sslmode: None
[0m14:59:08.079362 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m14:59:08.084679 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:59:08.084679 [debug] [MainThread]: Using postgres connection "debug"
[0m14:59:08.084679 [debug] [MainThread]: On debug: select 1 as id
[0m14:59:08.084679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:08.316133 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:59:08.316133 [debug] [MainThread]: On debug: Close
[0m14:59:08.324218 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:59:08.327373 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:59:08.329052 [debug] [MainThread]: Command `dbt debug` succeeded at 14:59:08.329052 after 0.51 seconds
[0m14:59:08.329052 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:59:08.329052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D86AB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D88AF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D88B910>]}
[0m14:59:08.329052 [debug] [MainThread]: Flushing usage events
[0m15:18:18.909324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226546EE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022654C4F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022654D0EF10>]}


============================== 15:18:18.913215 | 99f23bb7-c9f0-4f4e-ba1a-e4f5c3a5af50 ==============================
[0m15:18:18.913215 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:18:18.913215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:18:18.913215 [info ] [MainThread]: dbt version: 1.5.2
[0m15:18:18.913215 [info ] [MainThread]: python version: 3.11.4
[0m15:18:18.913215 [info ] [MainThread]: python path: C:\Users\oa\AppData\Local\Programs\Python\Python311\python.exe
[0m15:18:18.919274 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:18:18.920842 [info ] [MainThread]: Using profiles.yml file at C:\Users\oa\.dbt\profiles.yml
[0m15:18:18.921785 [info ] [MainThread]: Using dbt_project.yml file at C:\flights_dbt_course\flight_dbt\dbt_project.yml
[0m15:18:18.923086 [info ] [MainThread]: Configuration:
[0m15:18:19.004216 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:18:19.052676 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:18:19.052676 [info ] [MainThread]: Required dependencies:
[0m15:18:19.052676 [debug] [MainThread]: Executing "git --help"
[0m15:18:19.114312 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:18:19.114312 [debug] [MainThread]: STDERR: "b''"
[0m15:18:19.116838 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:18:19.119621 [info ] [MainThread]: Connection:
[0m15:18:19.120937 [info ] [MainThread]:   host: localhost
[0m15:18:19.120937 [info ] [MainThread]:   port: 5432
[0m15:18:19.122646 [info ] [MainThread]:   user: postgres
[0m15:18:19.123320 [info ] [MainThread]:   database: flights_dbt_course
[0m15:18:19.125133 [info ] [MainThread]:   schema: flights_wh
[0m15:18:19.125746 [info ] [MainThread]:   search_path: None
[0m15:18:19.126924 [info ] [MainThread]:   keepalives_idle: 0
[0m15:18:19.128142 [info ] [MainThread]:   sslmode: None
[0m15:18:19.129384 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m15:18:19.129384 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:18:19.129384 [debug] [MainThread]: Using postgres connection "debug"
[0m15:18:19.132893 [debug] [MainThread]: On debug: select 1 as id
[0m15:18:19.132893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:19.205378 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:18:19.213887 [debug] [MainThread]: On debug: Close
[0m15:18:19.213887 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:18:19.213887 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:18:19.216427 [debug] [MainThread]: Command `dbt debug` succeeded at 15:18:19.216427 after 0.33 seconds
[0m15:18:19.216427 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:18:19.216427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022654A29FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022654A29390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022654FA40D0>]}
[0m15:18:19.220322 [debug] [MainThread]: Flushing usage events
[0m15:18:28.700708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A855C27B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A855F3C8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A855C526D0>]}


============================== 15:18:28.704732 | 7b52f862-6c93-4c36-8067-b8bb553c329d ==============================
[0m15:18:28.704732 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:18:28.704732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:18:28.810159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b52f862-6c93-4c36-8067-b8bb553c329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85635BF90>]}
[0m15:18:28.838657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b52f862-6c93-4c36-8067-b8bb553c329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85635BF90>]}
[0m15:18:28.838657 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m15:18:28.845206 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:18:28.942564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:28.942564 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\example\dim.sql
[0m15:18:28.970081 [debug] [MainThread]: 1699: static parser successfully parsed example\dim.sql
[0m15:18:29.014597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b52f862-6c93-4c36-8067-b8bb553c329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8566F6110>]}
[0m15:18:29.030303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b52f862-6c93-4c36-8067-b8bb553c329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8567B6B10>]}
[0m15:18:29.045412 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:18:29.047684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b52f862-6c93-4c36-8067-b8bb553c329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A852388710>]}
[0m15:18:29.047684 [info ] [MainThread]: 
[0m15:18:29.055407 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:29.058765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m15:18:29.095937 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m15:18:29.095937 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m15:18:29.095937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:29.185675 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:18:29.187517 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m15:18:29.191454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m15:18:29.201988 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m15:18:29.209988 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m15:18:29.209988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:29.343301 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:29.345381 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m15:18:29.346626 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m15:18:29.377071 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:18:29.392683 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m15:18:29.392683 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m15:18:29.409962 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:29.409962 [debug] [MainThread]: On master: BEGIN
[0m15:18:29.424013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:29.667127 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:29.669301 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:29.670492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:29.740333 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m15:18:29.740333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b52f862-6c93-4c36-8067-b8bb553c329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A855E4E650>]}
[0m15:18:29.740333 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:29.750731 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:29.751304 [debug] [MainThread]: On master: BEGIN
[0m15:18:29.752485 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:29.753788 [debug] [MainThread]: On master: COMMIT
[0m15:18:29.753788 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:29.755669 [debug] [MainThread]: On master: COMMIT
[0m15:18:29.756783 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:29.757336 [debug] [MainThread]: On master: Close
[0m15:18:29.758634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:29.758634 [info ] [MainThread]: 
[0m15:18:29.770406 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim
[0m15:18:29.771439 [info ] [Thread-1 (]: 1 of 3 START sql view model flights_wh.dim ..................................... [RUN]
[0m15:18:29.774462 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim'
[0m15:18:29.776632 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim
[0m15:18:29.781961 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim"
[0m15:18:29.786457 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (compile): 15:18:29.776632 => 15:18:29.783909
[0m15:18:29.788011 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim
[0m15:18:29.836037 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim"
[0m15:18:29.836037 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m15:18:29.845224 [debug] [Thread-1 (]: On model.flight_dbt.dim: BEGIN
[0m15:18:29.845739 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:29.915469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:18:29.916545 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m15:18:29.917779 [debug] [Thread-1 (]: On model.flight_dbt.dim: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim"} */

  create view "flights_dbt_course"."flights_wh"."dim__dbt_tmp"
    
    
  as (
    

select *
from airport_data
  );
[0m15:18:29.920326 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airport_data" does not exist
LINE 10: from airport_data
              ^

[0m15:18:29.920889 [debug] [Thread-1 (]: On model.flight_dbt.dim: ROLLBACK
[0m15:18:29.923595 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (execute): 15:18:29.788011 => 15:18:29.920889
[0m15:18:29.923595 [debug] [Thread-1 (]: On model.flight_dbt.dim: Close
[0m15:18:29.937230 [debug] [Thread-1 (]: Database Error in model dim (models\example\dim.sql)
  relation "airport_data" does not exist
  LINE 10: from airport_data
                ^
  compiled Code at target\run\flight_dbt\models\example\dim.sql
[0m15:18:29.937805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b52f862-6c93-4c36-8067-b8bb553c329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8567A1550>]}
[0m15:18:29.939735 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model flights_wh.dim ............................ [[31mERROR[0m in 0.16s]
[0m15:18:29.939735 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim
[0m15:18:29.939735 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m15:18:29.939735 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m15:18:29.949807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim, now model.flight_dbt.my_first_dbt_model)
[0m15:18:29.950897 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m15:18:29.955977 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m15:18:29.958758 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 15:18:29.951460 => 15:18:29.958758
[0m15:18:29.964272 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m15:18:29.977174 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m15:18:29.980829 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:18:29.980829 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m15:18:29.984557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:30.071916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:18:30.075976 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:18:30.075976 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m15:18:30.079038 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:18:30.087368 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:18:30.087368 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:18:30.087368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:18:30.093876 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:18:30.093876 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:18:30.093876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:18:30.109514 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m15:18:30.109514 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:18:30.109514 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m15:18:30.123253 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:18:30.125263 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:18:30.125263 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m15:18:30.136913 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:18:30.140921 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 15:18:29.964272 => 15:18:30.140921
[0m15:18:30.140921 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m15:18:30.140921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b52f862-6c93-4c36-8067-b8bb553c329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A855C26050>]}
[0m15:18:30.140921 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.19s]
[0m15:18:30.140921 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m15:18:30.140921 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m15:18:30.140921 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m15:18:30.140921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m15:18:30.140921 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m15:18:30.140921 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m15:18:30.157883 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 15:18:30.140921 => 15:18:30.157883
[0m15:18:30.157883 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m15:18:30.161736 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m15:18:30.161736 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:18:30.161736 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m15:18:30.161736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:30.228980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:18:30.230345 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:18:30.230345 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m15:18:30.237528 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:18:30.242583 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:18:30.242583 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:18:30.244903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:18:30.247021 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m15:18:30.247021 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:18:30.247021 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m15:18:30.253712 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:18:30.255255 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:18:30.255255 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m15:18:30.255255 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:18:30.261808 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 15:18:30.157883 => 15:18:30.261808
[0m15:18:30.261808 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m15:18:30.261808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b52f862-6c93-4c36-8067-b8bb553c329d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8568A2110>]}
[0m15:18:30.265999 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.12s]
[0m15:18:30.265999 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m15:18:30.270005 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:30.271088 [debug] [MainThread]: On master: BEGIN
[0m15:18:30.271615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:30.329734 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:30.329734 [debug] [MainThread]: On master: COMMIT
[0m15:18:30.331162 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:30.331162 [debug] [MainThread]: On master: COMMIT
[0m15:18:30.331162 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:30.331162 [debug] [MainThread]: On master: Close
[0m15:18:30.331162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:30.334706 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m15:18:30.335761 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m15:18:30.335761 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m15:18:30.335761 [info ] [MainThread]: 
[0m15:18:30.339153 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m15:18:30.341983 [debug] [MainThread]: Command end result
[0m15:18:30.342992 [info ] [MainThread]: 
[0m15:18:30.351002 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:18:30.353277 [info ] [MainThread]: 
[0m15:18:30.353277 [error] [MainThread]: [33mDatabase Error in model dim (models\example\dim.sql)[0m
[0m15:18:30.355533 [error] [MainThread]:   relation "airport_data" does not exist
[0m15:18:30.357540 [error] [MainThread]:   LINE 10: from airport_data
[0m15:18:30.359275 [error] [MainThread]:                 ^
[0m15:18:30.359275 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\example\dim.sql
[0m15:18:30.361573 [info ] [MainThread]: 
[0m15:18:30.361573 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:18:30.361573 [debug] [MainThread]: Command `dbt run` failed at 15:18:30.361573 after 1.70 seconds
[0m15:18:30.361573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A853B7F690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A84F9CADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A855E4E410>]}
[0m15:18:30.361573 [debug] [MainThread]: Flushing usage events
[0m15:25:00.044563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018943007190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001894336AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018942FF3710>]}


============================== 15:25:00.050065 | d307f905-33ba-4766-bb02-d7deec5ed80e ==============================
[0m15:25:00.050065 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:25:00.050065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:25:00.161127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd307f905-33ba-4766-bb02-d7deec5ed80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189436DF1D0>]}
[0m15:25:00.191720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd307f905-33ba-4766-bb02-d7deec5ed80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018943A11E90>]}
[0m15:25:00.193785 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m15:25:00.212888 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:25:00.308925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:00.308925 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\example\dim.sql
[0m15:25:00.341611 [debug] [MainThread]: 1699: static parser successfully parsed example\dim.sql
[0m15:25:00.362754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd307f905-33ba-4766-bb02-d7deec5ed80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018943006850>]}
[0m15:25:00.377931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd307f905-33ba-4766-bb02-d7deec5ed80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001894301B990>]}
[0m15:25:00.379082 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:25:00.379667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd307f905-33ba-4766-bb02-d7deec5ed80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001893F768710>]}
[0m15:25:00.381745 [info ] [MainThread]: 
[0m15:25:00.381745 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:25:00.384641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m15:25:00.402295 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m15:25:00.402295 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m15:25:00.402295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:00.478445 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:25:00.480480 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m15:25:00.481022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m15:25:00.485065 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m15:25:00.485065 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m15:25:00.485065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:00.532853 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:25:00.532853 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m15:25:00.532853 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m15:25:00.553396 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:25:00.553396 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m15:25:00.553396 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m15:25:00.564408 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:00.564408 [debug] [MainThread]: On master: BEGIN
[0m15:25:00.564408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:00.643595 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:25:00.643595 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:00.649464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:25:00.731042 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m15:25:00.739119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd307f905-33ba-4766-bb02-d7deec5ed80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001893F768590>]}
[0m15:25:00.747124 [debug] [MainThread]: On master: ROLLBACK
[0m15:25:00.747124 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:00.747124 [debug] [MainThread]: On master: BEGIN
[0m15:25:00.747124 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:25:00.755839 [debug] [MainThread]: On master: COMMIT
[0m15:25:00.758614 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:00.758614 [debug] [MainThread]: On master: COMMIT
[0m15:25:00.758614 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:25:00.758614 [debug] [MainThread]: On master: Close
[0m15:25:00.758614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:00.771033 [info ] [MainThread]: 
[0m15:25:00.793022 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim
[0m15:25:00.795700 [info ] [Thread-1 (]: 1 of 3 START sql view model flights_wh.dim ..................................... [RUN]
[0m15:25:00.803969 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim'
[0m15:25:00.803969 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim
[0m15:25:00.828018 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim"
[0m15:25:00.836011 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (compile): 15:25:00.812016 => 15:25:00.828018
[0m15:25:00.836011 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim
[0m15:25:00.899743 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim"
[0m15:25:00.899743 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m15:25:00.899743 [debug] [Thread-1 (]: On model.flight_dbt.dim: BEGIN
[0m15:25:00.907827 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:00.957800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:25:00.957800 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m15:25:00.957800 [debug] [Thread-1 (]: On model.flight_dbt.dim: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim"} */

  create view "flights_dbt_course"."flights_wh"."dim__dbt_tmp"
    
    
  as (
    

select *
from airports_data
  );
[0m15:25:00.957800 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 10: from airports_data
              ^

[0m15:25:00.957800 [debug] [Thread-1 (]: On model.flight_dbt.dim: ROLLBACK
[0m15:25:00.962794 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (execute): 15:25:00.843704 => 15:25:00.962286
[0m15:25:00.962794 [debug] [Thread-1 (]: On model.flight_dbt.dim: Close
[0m15:25:00.970312 [debug] [Thread-1 (]: Database Error in model dim (models\example\dim.sql)
  relation "airports_data" does not exist
  LINE 10: from airports_data
                ^
  compiled Code at target\run\flight_dbt\models\example\dim.sql
[0m15:25:00.970312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd307f905-33ba-4766-bb02-d7deec5ed80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189439F6990>]}
[0m15:25:00.970312 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model flights_wh.dim ............................ [[31mERROR[0m in 0.17s]
[0m15:25:00.970312 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim
[0m15:25:00.974973 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m15:25:00.974973 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m15:25:00.977306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim, now model.flight_dbt.my_first_dbt_model)
[0m15:25:00.977852 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m15:25:00.981964 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m15:25:00.982990 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 15:25:00.977852 => 15:25:00.982990
[0m15:25:00.984229 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m15:25:00.991062 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m15:25:00.997307 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:25:00.999482 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m15:25:00.999482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:01.126192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:25:01.126192 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:25:01.126192 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m15:25:01.143567 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:25:01.158286 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:25:01.158286 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:25:01.158286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:25:01.168579 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:25:01.174996 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:25:01.176634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:25:01.224896 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m15:25:01.224896 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:25:01.224896 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m15:25:01.233805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:25:01.257759 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m15:25:01.258334 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m15:25:01.263254 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:25:01.265782 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 15:25:00.984229 => 15:25:01.265782
[0m15:25:01.265782 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m15:25:01.273807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd307f905-33ba-4766-bb02-d7deec5ed80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018943A76D10>]}
[0m15:25:01.277903 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.30s]
[0m15:25:01.278427 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m15:25:01.283369 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m15:25:01.283369 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m15:25:01.285440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m15:25:01.285440 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m15:25:01.294637 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m15:25:01.298212 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 15:25:01.289974 => 15:25:01.298212
[0m15:25:01.298212 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m15:25:01.306238 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m15:25:01.315249 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:25:01.315249 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m15:25:01.315249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:01.410196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:25:01.411423 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:25:01.411423 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m15:25:01.420630 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:25:01.426917 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:25:01.428542 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:25:01.428542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:25:01.435554 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m15:25:01.435554 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:25:01.435554 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m15:25:01.435554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:25:01.435554 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m15:25:01.435554 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m15:25:01.451354 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:25:01.453045 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 15:25:01.298212 => 15:25:01.453045
[0m15:25:01.453045 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m15:25:01.453045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd307f905-33ba-4766-bb02-d7deec5ed80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189432DB090>]}
[0m15:25:01.455368 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.17s]
[0m15:25:01.458196 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m15:25:01.459985 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:01.459985 [debug] [MainThread]: On master: BEGIN
[0m15:25:01.459985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:01.691209 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:25:01.694721 [debug] [MainThread]: On master: COMMIT
[0m15:25:01.694721 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:01.694721 [debug] [MainThread]: On master: COMMIT
[0m15:25:01.697758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:25:01.697758 [debug] [MainThread]: On master: Close
[0m15:25:01.700065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:01.700065 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m15:25:01.700065 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m15:25:01.700065 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m15:25:01.700065 [info ] [MainThread]: 
[0m15:25:01.700065 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m15:25:01.700065 [debug] [MainThread]: Command end result
[0m15:25:01.718649 [info ] [MainThread]: 
[0m15:25:01.721782 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:25:01.726844 [info ] [MainThread]: 
[0m15:25:01.726844 [error] [MainThread]: [33mDatabase Error in model dim (models\example\dim.sql)[0m
[0m15:25:01.742872 [error] [MainThread]:   relation "airports_data" does not exist
[0m15:25:01.750883 [error] [MainThread]:   LINE 10: from airports_data
[0m15:25:01.753166 [error] [MainThread]:                 ^
[0m15:25:01.754463 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\example\dim.sql
[0m15:25:01.754463 [info ] [MainThread]: 
[0m15:25:01.756875 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:25:01.759389 [debug] [MainThread]: Command `dbt run` failed at 15:25:01.759389 after 1.75 seconds
[0m15:25:01.759389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189433E6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189433E6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001894374AA90>]}
[0m15:25:01.759389 [debug] [MainThread]: Flushing usage events
[0m16:02:49.800689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C189E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C1B69D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2BECB9D0>]}


============================== 16:02:49.800689 | a63bdbb5-7f79-48e6-a1a8-7983133af4c2 ==============================
[0m16:02:49.800689 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:02:49.810752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:02:49.899765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a63bdbb5-7f79-48e6-a1a8-7983133af4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C18B1D0>]}
[0m16:02:49.924033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a63bdbb5-7f79-48e6-a1a8-7983133af4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C6085D0>]}
[0m16:02:49.924033 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m16:02:49.964095 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:02:50.101052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:50.101052 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\example\schema.yml
[0m16:02:50.195568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a63bdbb5-7f79-48e6-a1a8-7983133af4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C933F90>]}
[0m16:02:50.211223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a63bdbb5-7f79-48e6-a1a8-7983133af4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C919F10>]}
[0m16:02:50.211223 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:02:50.213731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a63bdbb5-7f79-48e6-a1a8-7983133af4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C4A7E90>]}
[0m16:02:50.213731 [info ] [MainThread]: 
[0m16:02:50.213731 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:50.213731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m16:02:50.228470 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m16:02:50.228470 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m16:02:50.228470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:50.364921 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:02:50.371945 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m16:02:50.380123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m16:02:50.397638 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:02:50.397638 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m16:02:50.397638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:50.521252 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:02:50.521252 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:02:50.522764 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m16:02:50.539474 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:02:50.542499 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m16:02:50.542499 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m16:02:50.554387 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:50.554387 [debug] [MainThread]: On master: BEGIN
[0m16:02:50.554387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:50.636103 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:50.636103 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:50.636103 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:50.680690 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:02:50.685601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a63bdbb5-7f79-48e6-a1a8-7983133af4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C8CA1D0>]}
[0m16:02:50.685601 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:50.685601 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:50.685601 [debug] [MainThread]: On master: BEGIN
[0m16:02:50.688086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:50.688086 [debug] [MainThread]: On master: COMMIT
[0m16:02:50.689238 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:50.689745 [debug] [MainThread]: On master: COMMIT
[0m16:02:50.689745 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:50.690769 [debug] [MainThread]: On master: Close
[0m16:02:50.690769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:50.692582 [info ] [MainThread]: 
[0m16:02:50.699070 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim
[0m16:02:50.699070 [info ] [Thread-1 (]: 1 of 3 START sql view model flights_wh.dim ..................................... [RUN]
[0m16:02:50.701561 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim'
[0m16:02:50.701561 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim
[0m16:02:50.704143 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim"
[0m16:02:50.707089 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (compile): 16:02:50.702606 => 16:02:50.707089
[0m16:02:50.707089 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim
[0m16:02:50.759577 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim"
[0m16:02:50.761124 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m16:02:50.761124 [debug] [Thread-1 (]: On model.flight_dbt.dim: BEGIN
[0m16:02:50.761124 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:02:50.809951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:50.817922 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m16:02:50.819171 [debug] [Thread-1 (]: On model.flight_dbt.dim: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim"} */

  create view "flights_dbt_course"."flights_wh"."dim__dbt_tmp"
    
    
  as (
    

select *
from airports_data
  );
[0m16:02:50.819683 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 10: from airports_data
              ^

[0m16:02:50.821326 [debug] [Thread-1 (]: On model.flight_dbt.dim: ROLLBACK
[0m16:02:50.821326 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (execute): 16:02:50.708462 => 16:02:50.821326
[0m16:02:50.821326 [debug] [Thread-1 (]: On model.flight_dbt.dim: Close
[0m16:02:50.827245 [debug] [Thread-1 (]: Database Error in model dim (models\example\dim.sql)
  relation "airports_data" does not exist
  LINE 10: from airports_data
                ^
  compiled Code at target\run\flight_dbt\models\example\dim.sql
[0m16:02:50.827245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a63bdbb5-7f79-48e6-a1a8-7983133af4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C89F390>]}
[0m16:02:50.827245 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model flights_wh.dim ............................ [[31mERROR[0m in 0.13s]
[0m16:02:50.834255 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim
[0m16:02:50.834255 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m16:02:50.834255 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m16:02:50.834255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim, now model.flight_dbt.my_first_dbt_model)
[0m16:02:50.834255 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m16:02:50.842478 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m16:02:50.845462 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 16:02:50.834255 => 16:02:50.844422
[0m16:02:50.845981 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m16:02:50.850500 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m16:02:50.850500 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:02:50.858193 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m16:02:50.858193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:50.916222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:50.916222 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:02:50.916222 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m16:02:50.923474 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:02:50.931534 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:02:50.931534 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:02:50.931534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:50.936917 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:02:50.936917 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:02:50.939930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:50.956637 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:02:50.956637 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:02:50.956637 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:02:50.977019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:02:50.990057 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:02:50.990057 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m16:02:50.990057 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:02:50.990057 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 16:02:50.845981 => 16:02:50.990057
[0m16:02:50.990057 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m16:02:51.004075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a63bdbb5-7f79-48e6-a1a8-7983133af4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2C4A7F10>]}
[0m16:02:51.005729 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.17s]
[0m16:02:51.007290 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m16:02:51.007290 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m16:02:51.007290 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m16:02:51.014650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m16:02:51.014650 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m16:02:51.019735 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m16:02:51.019735 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 16:02:51.014650 => 16:02:51.019735
[0m16:02:51.023882 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m16:02:51.024395 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m16:02:51.030909 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:02:51.030909 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m16:02:51.030909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:51.087596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:51.088768 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:02:51.089314 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m16:02:51.098996 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:02:51.103940 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:02:51.103940 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:02:51.103940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:02:51.111515 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:02:51.111515 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:02:51.111515 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:02:51.120573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:02:51.120573 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:02:51.120573 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m16:02:51.120573 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:02:51.136842 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 16:02:51.024395 => 16:02:51.136270
[0m16:02:51.136842 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m16:02:51.136842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a63bdbb5-7f79-48e6-a1a8-7983133af4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2CA7B590>]}
[0m16:02:51.141705 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.13s]
[0m16:02:51.144827 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m16:02:51.151084 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:51.153847 [debug] [MainThread]: On master: BEGIN
[0m16:02:51.153847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:51.282233 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:51.282233 [debug] [MainThread]: On master: COMMIT
[0m16:02:51.282233 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:51.282233 [debug] [MainThread]: On master: COMMIT
[0m16:02:51.282233 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:51.282233 [debug] [MainThread]: On master: Close
[0m16:02:51.297878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:51.297878 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m16:02:51.297878 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m16:02:51.297878 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m16:02:51.297878 [info ] [MainThread]: 
[0m16:02:51.297878 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m16:02:51.306426 [debug] [MainThread]: Command end result
[0m16:02:51.317344 [info ] [MainThread]: 
[0m16:02:51.322366 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:02:51.322366 [info ] [MainThread]: 
[0m16:02:51.326874 [error] [MainThread]: [33mDatabase Error in model dim (models\example\dim.sql)[0m
[0m16:02:51.328871 [error] [MainThread]:   relation "airports_data" does not exist
[0m16:02:51.330432 [error] [MainThread]:   LINE 10: from airports_data
[0m16:02:51.330432 [error] [MainThread]:                 ^
[0m16:02:51.334446 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\example\dim.sql
[0m16:02:51.338547 [info ] [MainThread]: 
[0m16:02:51.338547 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:02:51.338547 [debug] [MainThread]: Command `dbt run` failed at 16:02:51.338547 after 1.57 seconds
[0m16:02:51.346577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C2BCA1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C25CFADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C25CFAF10>]}
[0m16:02:51.346577 [debug] [MainThread]: Flushing usage events
[0m16:03:54.920286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4CD8EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4EB03FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F1F97D0>]}


============================== 16:03:54.920286 | e044fa9a-8898-4357-a059-0209d6430f23 ==============================
[0m16:03:54.920286 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:03:54.920286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:03:55.026022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e044fa9a-8898-4357-a059-0209d6430f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F207310>]}
[0m16:03:55.050323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e044fa9a-8898-4357-a059-0209d6430f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4EE48C90>]}
[0m16:03:55.050323 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m16:03:55.066601 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:03:55.203498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:55.203498 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\example\schema.yml
[0m16:03:55.220844 [debug] [MainThread]: 1699: static parser successfully parsed example\dim.sql
[0m16:03:55.282002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e044fa9a-8898-4357-a059-0209d6430f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4EE268D0>]}
[0m16:03:55.282002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e044fa9a-8898-4357-a059-0209d6430f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F9CE890>]}
[0m16:03:55.282002 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:03:55.282002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e044fa9a-8898-4357-a059-0209d6430f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4B588590>]}
[0m16:03:55.282002 [info ] [MainThread]: 
[0m16:03:55.282002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:55.298396 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m16:03:55.317908 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m16:03:55.317908 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m16:03:55.317908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:55.387082 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:03:55.390136 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m16:03:55.392848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m16:03:55.398551 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:03:55.398551 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m16:03:55.398551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:55.636411 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:03:55.636411 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:03:55.636411 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m16:03:55.656298 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:03:55.659463 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m16:03:55.659463 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m16:03:55.681625 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:55.681625 [debug] [MainThread]: On master: BEGIN
[0m16:03:55.681625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:55.765417 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:55.765417 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:55.766927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:55.783003 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:03:55.798683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e044fa9a-8898-4357-a059-0209d6430f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4B588590>]}
[0m16:03:55.798683 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:55.798683 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:55.803076 [debug] [MainThread]: On master: BEGIN
[0m16:03:55.803583 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:55.803583 [debug] [MainThread]: On master: COMMIT
[0m16:03:55.803583 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:55.805680 [debug] [MainThread]: On master: COMMIT
[0m16:03:55.805680 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:55.805680 [debug] [MainThread]: On master: Close
[0m16:03:55.807747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:55.809273 [info ] [MainThread]: 
[0m16:03:55.819886 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim
[0m16:03:55.819886 [info ] [Thread-1 (]: 1 of 3 START sql view model flights_wh.dim ..................................... [RUN]
[0m16:03:55.822894 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim'
[0m16:03:55.822894 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim
[0m16:03:55.822894 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim"
[0m16:03:55.822894 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (compile): 16:03:55.822894 => 16:03:55.822894
[0m16:03:55.822894 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim
[0m16:03:55.931657 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim"
[0m16:03:55.931657 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m16:03:55.934227 [debug] [Thread-1 (]: On model.flight_dbt.dim: BEGIN
[0m16:03:55.934227 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:55.989955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:55.989955 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m16:03:55.991381 [debug] [Thread-1 (]: On model.flight_dbt.dim: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim"} */

  create view "flights_dbt_course"."flights_wh"."dim__dbt_tmp"
    
    
  as (
    

select *
from airports_data
  );
[0m16:03:55.992578 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airports_data" does not exist
LINE 10: from airports_data
              ^

[0m16:03:55.993129 [debug] [Thread-1 (]: On model.flight_dbt.dim: ROLLBACK
[0m16:03:55.994248 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (execute): 16:03:55.822894 => 16:03:55.993129
[0m16:03:55.994248 [debug] [Thread-1 (]: On model.flight_dbt.dim: Close
[0m16:03:56.000114 [debug] [Thread-1 (]: Database Error in model dim (models\example\dim.sql)
  relation "airports_data" does not exist
  LINE 10: from airports_data
                ^
  compiled Code at target\run\flight_dbt\models\example\dim.sql
[0m16:03:56.000114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e044fa9a-8898-4357-a059-0209d6430f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F8B8D50>]}
[0m16:03:56.002590 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model flights_wh.dim ............................ [[31mERROR[0m in 0.18s]
[0m16:03:56.003095 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim
[0m16:03:56.004350 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m16:03:56.004905 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m16:03:56.006061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim, now model.flight_dbt.my_first_dbt_model)
[0m16:03:56.007266 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m16:03:56.009563 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m16:03:56.009563 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 16:03:56.007813 => 16:03:56.009563
[0m16:03:56.009563 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m16:03:56.017725 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m16:03:56.018446 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:03:56.018446 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m16:03:56.020273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:56.073800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:56.073800 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:03:56.081814 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m16:03:56.091089 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:03:56.098099 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:03:56.098099 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:03:56.099525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:56.104739 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:03:56.106281 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:03:56.107438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:56.122466 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:03:56.130466 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:03:56.130466 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:03:56.130466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:03:56.140140 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:03:56.140140 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m16:03:56.146655 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:03:56.149186 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 16:03:56.009563 => 16:03:56.147864
[0m16:03:56.149733 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m16:03:56.149733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e044fa9a-8898-4357-a059-0209d6430f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F103290>]}
[0m16:03:56.151930 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.14s]
[0m16:03:56.153236 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m16:03:56.154743 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m16:03:56.155882 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m16:03:56.157048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m16:03:56.157048 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m16:03:56.157048 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m16:03:56.157048 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 16:03:56.157048 => 16:03:56.157048
[0m16:03:56.163058 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m16:03:56.166868 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m16:03:56.166868 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:03:56.166868 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m16:03:56.166868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:56.230777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:56.235609 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:03:56.237130 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m16:03:56.257533 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:03:56.269992 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:03:56.269992 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:03:56.269992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:56.269992 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:03:56.269992 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:03:56.269992 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:03:56.285620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:03:56.285620 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:03:56.285620 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m16:03:56.301307 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:03:56.301307 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 16:03:56.163058 => 16:03:56.301307
[0m16:03:56.301307 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m16:03:56.301307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e044fa9a-8898-4357-a059-0209d6430f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4FA85A90>]}
[0m16:03:56.316872 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.14s]
[0m16:03:56.321008 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m16:03:56.328958 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:56.328958 [debug] [MainThread]: On master: BEGIN
[0m16:03:56.332982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:56.604315 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:56.604315 [debug] [MainThread]: On master: COMMIT
[0m16:03:56.604315 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:56.611483 [debug] [MainThread]: On master: COMMIT
[0m16:03:56.614394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:56.614394 [debug] [MainThread]: On master: Close
[0m16:03:56.618252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:56.620274 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m16:03:56.620274 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m16:03:56.620274 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m16:03:56.620274 [info ] [MainThread]: 
[0m16:03:56.620274 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m16:03:56.635939 [debug] [MainThread]: Command end result
[0m16:03:56.664182 [info ] [MainThread]: 
[0m16:03:56.668379 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:56.668379 [info ] [MainThread]: 
[0m16:03:56.668379 [error] [MainThread]: [33mDatabase Error in model dim (models\example\dim.sql)[0m
[0m16:03:56.678571 [error] [MainThread]:   relation "airports_data" does not exist
[0m16:03:56.684772 [error] [MainThread]:   LINE 10: from airports_data
[0m16:03:56.684772 [error] [MainThread]:                 ^
[0m16:03:56.692812 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\example\dim.sql
[0m16:03:56.692812 [info ] [MainThread]: 
[0m16:03:56.703491 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:03:56.713045 [debug] [MainThread]: Command `dbt run` failed at 16:03:56.713045 after 1.81 seconds
[0m16:03:56.718032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4EECF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A48BCA250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A4F207310>]}
[0m16:03:56.719057 [debug] [MainThread]: Flushing usage events
[0m16:12:07.693773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE5B19D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE56C4CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE5B0BD50>]}


============================== 16:12:07.699961 | 333f92a0-ec79-4f57-8b96-5196fc26988b ==============================
[0m16:12:07.699961 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:12:07.701494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:12:07.811199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '333f92a0-ec79-4f57-8b96-5196fc26988b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE53D6810>]}
[0m16:12:07.830545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '333f92a0-ec79-4f57-8b96-5196fc26988b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE5DDC890>]}
[0m16:12:07.830545 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m16:12:07.870183 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:12:08.055302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:12:08.055302 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\example\dim.sql
[0m16:12:08.070988 [debug] [MainThread]: 1699: static parser successfully parsed example\dim.sql
[0m16:12:08.134866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '333f92a0-ec79-4f57-8b96-5196fc26988b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE56C2CD0>]}
[0m16:12:08.150584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '333f92a0-ec79-4f57-8b96-5196fc26988b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE5DDE810>]}
[0m16:12:08.150584 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:12:08.150584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '333f92a0-ec79-4f57-8b96-5196fc26988b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE1B38590>]}
[0m16:12:08.150584 [info ] [MainThread]: 
[0m16:12:08.167305 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:12:08.168357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m16:12:08.190844 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m16:12:08.190844 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m16:12:08.194384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:08.423923 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:12:08.423923 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m16:12:08.441108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m16:12:08.455651 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:12:08.455651 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m16:12:08.471325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:08.581032 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:12:08.581032 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:12:08.581032 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m16:12:08.596656 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:12:08.614017 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m16:12:08.614017 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m16:12:08.630196 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:08.630196 [debug] [MainThread]: On master: BEGIN
[0m16:12:08.630196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:12:08.684800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:12:08.684800 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:08.684800 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:12:08.716056 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:12:08.716056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '333f92a0-ec79-4f57-8b96-5196fc26988b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE5DE38D0>]}
[0m16:12:08.716056 [debug] [MainThread]: On master: ROLLBACK
[0m16:12:08.716056 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:08.716056 [debug] [MainThread]: On master: BEGIN
[0m16:12:08.716056 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:12:08.716056 [debug] [MainThread]: On master: COMMIT
[0m16:12:08.716056 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:08.716056 [debug] [MainThread]: On master: COMMIT
[0m16:12:08.716056 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:12:08.716056 [debug] [MainThread]: On master: Close
[0m16:12:08.716056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:08.731640 [info ] [MainThread]: 
[0m16:12:08.732648 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim
[0m16:12:08.732648 [info ] [Thread-1 (]: 1 of 3 START sql view model flights_wh.dim ..................................... [RUN]
[0m16:12:08.732648 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim'
[0m16:12:08.743011 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim
[0m16:12:08.744445 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim"
[0m16:12:08.744445 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (compile): 16:12:08.744445 => 16:12:08.744445
[0m16:12:08.750729 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim
[0m16:12:08.791560 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim"
[0m16:12:08.799559 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m16:12:08.799559 [debug] [Thread-1 (]: On model.flight_dbt.dim: BEGIN
[0m16:12:08.800971 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:12:08.896871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:12:08.896871 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m16:12:08.896871 [debug] [Thread-1 (]: On model.flight_dbt.dim: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim"} */

  create view "flights_dbt_course"."flights_wh"."dim__dbt_tmp"
    
    
  as (
    

select *
from stg.airports_data
  );
[0m16:12:08.930691 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:12:08.944221 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m16:12:08.946399 [debug] [Thread-1 (]: On model.flight_dbt.dim: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim"} */
alter table "flights_dbt_course"."flights_wh"."dim__dbt_tmp" rename to "dim"
[0m16:12:08.946399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:12:08.976026 [debug] [Thread-1 (]: On model.flight_dbt.dim: COMMIT
[0m16:12:08.976026 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m16:12:08.976026 [debug] [Thread-1 (]: On model.flight_dbt.dim: COMMIT
[0m16:12:08.984201 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:12:08.991736 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim"
[0m16:12:08.991736 [debug] [Thread-1 (]: On model.flight_dbt.dim: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim"} */
drop view if exists "flights_dbt_course"."flights_wh"."dim__dbt_backup" cascade
[0m16:12:08.991736 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:12:08.991736 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim (execute): 16:12:08.750729 => 16:12:08.991736
[0m16:12:08.991736 [debug] [Thread-1 (]: On model.flight_dbt.dim: Close
[0m16:12:08.991736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '333f92a0-ec79-4f57-8b96-5196fc26988b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE5DD6990>]}
[0m16:12:09.004669 [info ] [Thread-1 (]: 1 of 3 OK created sql view model flights_wh.dim ................................ [[32mCREATE VIEW[0m in 0.26s]
[0m16:12:09.009158 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim
[0m16:12:09.009158 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m16:12:09.009158 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m16:12:09.009158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim, now model.flight_dbt.my_first_dbt_model)
[0m16:12:09.015949 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m16:12:09.015949 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m16:12:09.015949 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 16:12:09.015949 => 16:12:09.015949
[0m16:12:09.024516 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m16:12:09.024516 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m16:12:09.032069 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:12:09.032069 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m16:12:09.032069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:09.080564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:12:09.080564 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:12:09.080564 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m16:12:09.088560 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:12:09.098307 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:12:09.098307 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:12:09.104878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:12:09.110530 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:12:09.110530 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:12:09.113058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:12:09.121087 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:12:09.121087 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:12:09.121087 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:12:09.129345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:12:09.129345 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:12:09.129345 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m16:12:09.129345 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:12:09.145035 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 16:12:09.024516 => 16:12:09.145035
[0m16:12:09.145035 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m16:12:09.145035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '333f92a0-ec79-4f57-8b96-5196fc26988b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE5F57390>]}
[0m16:12:09.145035 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.14s]
[0m16:12:09.153892 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m16:12:09.153892 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m16:12:09.153892 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m16:12:09.161220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m16:12:09.162263 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m16:12:09.165103 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m16:12:09.169267 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 16:12:09.162781 => 16:12:09.165103
[0m16:12:09.169267 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m16:12:09.175005 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m16:12:09.175005 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:12:09.177516 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m16:12:09.177516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:09.230829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:12:09.232503 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:12:09.232503 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m16:12:09.234980 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:12:09.243592 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:12:09.243592 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:12:09.243592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:12:09.243592 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:12:09.243592 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:12:09.243592 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:12:09.251145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:12:09.251145 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:12:09.251145 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m16:12:09.251145 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:12:09.259729 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 16:12:09.170303 => 16:12:09.259729
[0m16:12:09.260277 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m16:12:09.260277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '333f92a0-ec79-4f57-8b96-5196fc26988b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE5AAF150>]}
[0m16:12:09.263172 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.11s]
[0m16:12:09.263172 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m16:12:09.265327 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:09.267343 [debug] [MainThread]: On master: BEGIN
[0m16:12:09.267343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:12:09.315922 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:12:09.315922 [debug] [MainThread]: On master: COMMIT
[0m16:12:09.323934 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:09.323934 [debug] [MainThread]: On master: COMMIT
[0m16:12:09.325505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:12:09.325505 [debug] [MainThread]: On master: Close
[0m16:12:09.327382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:09.329148 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m16:12:09.329667 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m16:12:09.330691 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m16:12:09.330691 [info ] [MainThread]: 
[0m16:12:09.332574 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m16:12:09.332574 [debug] [MainThread]: Command end result
[0m16:12:09.340321 [info ] [MainThread]: 
[0m16:12:09.342773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:09.343857 [info ] [MainThread]: 
[0m16:12:09.343857 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:12:09.347432 [debug] [MainThread]: Command `dbt run` succeeded at 16:12:09.345768 after 1.68 seconds
[0m16:12:09.347974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECDF189390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECDF1DCA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE579E550>]}
[0m16:12:09.347974 [debug] [MainThread]: Flushing usage events
[0m16:21:53.251809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C444CEF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C44472350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C4489BD50>]}


============================== 16:21:53.267414 | d09ca643-f683-4db9-b90a-c7fae531cfe0 ==============================
[0m16:21:53.267414 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:21:53.267414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:21:53.353738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd09ca643-f683-4db9-b90a-c7fae531cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C43FDBF10>]}
[0m16:21:53.381739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd09ca643-f683-4db9-b90a-c7fae531cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C4418D390>]}
[0m16:21:53.384092 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m16:21:53.394273 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:21:53.461019 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:21:53.462016 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\example\dim_airport.sql
[0m16:21:53.463021 [debug] [MainThread]: Partial parsing: deleted file: flight_dbt://models\example\dim.sql
[0m16:21:53.490017 [debug] [MainThread]: 1699: static parser successfully parsed example\dim_airport.sql
[0m16:21:53.514677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd09ca643-f683-4db9-b90a-c7fae531cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C44BEA4D0>]}
[0m16:21:53.514677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd09ca643-f683-4db9-b90a-c7fae531cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C44D068D0>]}
[0m16:21:53.514677 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:21:53.514677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd09ca643-f683-4db9-b90a-c7fae531cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C408C8710>]}
[0m16:21:53.525686 [info ] [MainThread]: 
[0m16:21:53.525686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:53.525686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m16:21:53.525686 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m16:21:53.525686 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m16:21:53.525686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:53.597457 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:21:53.599415 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m16:21:53.602421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m16:21:53.607455 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:21:53.608456 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m16:21:53.608456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:53.643747 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:21:53.643747 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:21:53.643747 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m16:21:53.659379 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:21:53.659379 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m16:21:53.659379 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m16:21:53.659379 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:53.659379 [debug] [MainThread]: On master: BEGIN
[0m16:21:53.659379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:53.715258 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:21:53.715258 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:53.715258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:21:53.737903 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:21:53.737903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd09ca643-f683-4db9-b90a-c7fae531cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C4441E250>]}
[0m16:21:53.737903 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:53.737903 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:53.737903 [debug] [MainThread]: On master: BEGIN
[0m16:21:53.737903 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:21:53.737903 [debug] [MainThread]: On master: COMMIT
[0m16:21:53.737903 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:53.737903 [debug] [MainThread]: On master: COMMIT
[0m16:21:53.737903 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:21:53.737903 [debug] [MainThread]: On master: Close
[0m16:21:53.753528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:53.753528 [info ] [MainThread]: 
[0m16:21:53.753528 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m16:21:53.753528 [info ] [Thread-1 (]: 1 of 3 START sql view model flights_wh.dim_airport ............................. [RUN]
[0m16:21:53.765151 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_airport'
[0m16:21:53.765151 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m16:21:53.768165 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m16:21:53.774165 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 16:21:53.766166 => 16:21:53.773438
[0m16:21:53.774165 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m16:21:53.819900 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m16:21:53.820906 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:21:53.821921 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m16:21:53.821921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:21:53.869111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:21:53.869111 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:21:53.870156 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  create view "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
    
    
  as (
    

select *
from stg.airports_data
  );
[0m16:21:53.877093 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:21:53.878183 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:21:53.878183 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m16:21:53.878183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:21:53.893853 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:21:53.893853 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:21:53.893853 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:21:53.893853 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:21:53.909503 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:21:53.909503 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
drop view if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m16:21:53.909503 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:21:53.909503 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 16:21:53.775166 => 16:21:53.909503
[0m16:21:53.909503 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m16:21:53.915514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd09ca643-f683-4db9-b90a-c7fae531cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C44BDB710>]}
[0m16:21:53.915514 [info ] [Thread-1 (]: 1 of 3 OK created sql view model flights_wh.dim_airport ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m16:21:53.915514 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m16:21:53.915514 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m16:21:53.915514 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m16:21:53.915514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m16:21:53.915514 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m16:21:53.915514 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m16:21:53.925526 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 16:21:53.915514 => 16:21:53.915514
[0m16:21:53.926703 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m16:21:53.931712 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m16:21:53.932712 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:21:53.933714 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m16:21:53.934747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:53.983729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:21:53.984775 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:21:53.984775 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m16:21:53.990262 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:21:53.994296 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:21:53.994296 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:21:53.995306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:21:53.998297 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:21:53.999294 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:21:54.000263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:21:54.004310 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:21:54.004310 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:21:54.005310 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:21:54.007916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:21:54.010946 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:21:54.011960 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m16:21:54.013925 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:21:54.015468 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 16:21:53.926703 => 16:21:54.015468
[0m16:21:54.015468 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m16:21:54.016474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd09ca643-f683-4db9-b90a-c7fae531cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C44472090>]}
[0m16:21:54.017480 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.10s]
[0m16:21:54.019476 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m16:21:54.020497 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m16:21:54.021512 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m16:21:54.022475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m16:21:54.023512 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m16:21:54.026510 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m16:21:54.027578 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 16:21:54.023512 => 16:21:54.026510
[0m16:21:54.027578 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m16:21:54.027578 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m16:21:54.027578 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:21:54.027578 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m16:21:54.027578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:54.084409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:21:54.085445 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:21:54.085445 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m16:21:54.092446 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:21:54.096459 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:21:54.097495 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:21:54.099462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:21:54.101485 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:21:54.101485 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:21:54.102489 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:21:54.104586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:21:54.107489 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:21:54.107489 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m16:21:54.108492 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:21:54.110487 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 16:21:54.027578 => 16:21:54.110487
[0m16:21:54.110487 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m16:21:54.111451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd09ca643-f683-4db9-b90a-c7fae531cfe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C44D83F10>]}
[0m16:21:54.112452 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m16:21:54.114455 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m16:21:54.115453 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:54.116491 [debug] [MainThread]: On master: BEGIN
[0m16:21:54.116491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:54.166780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:21:54.167820 [debug] [MainThread]: On master: COMMIT
[0m16:21:54.167820 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:54.168816 [debug] [MainThread]: On master: COMMIT
[0m16:21:54.168816 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:21:54.169781 [debug] [MainThread]: On master: Close
[0m16:21:54.170781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:54.170781 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m16:21:54.171791 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m16:21:54.171791 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m16:21:54.172783 [info ] [MainThread]: 
[0m16:21:54.172783 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m16:21:54.175201 [debug] [MainThread]: Command end result
[0m16:21:54.183168 [info ] [MainThread]: 
[0m16:21:54.185169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:54.185169 [info ] [MainThread]: 
[0m16:21:54.186168 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:21:54.188166 [debug] [MainThread]: Command `dbt run` succeeded at 16:21:54.188166 after 0.94 seconds
[0m16:21:54.188166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C43FECF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C3DEB9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C445482D0>]}
[0m16:21:54.189165 [debug] [MainThread]: Flushing usage events
[0m16:24:49.678613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141A4B9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141AB6AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141A806F10>]}


============================== 16:24:49.694230 | 18e3fc3d-5e3d-4e92-a09b-32ceb5701682 ==============================
[0m16:24:49.694230 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:24:49.694230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:24:49.780139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141A806F10>]}
[0m16:24:49.798142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141A806F10>]}
[0m16:24:49.800141 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m16:24:49.811174 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:24:49.827181 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:24:49.829144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141AE22B50>]}
[0m16:24:50.492622 [debug] [MainThread]: 1699: static parser successfully parsed dimentions\dim_airport.sql
[0m16:24:50.508246 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m16:24:50.523876 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m16:24:50.617617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141AF12D50>]}
[0m16:24:50.617617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141AF9A450>]}
[0m16:24:50.617617 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:24:50.617617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141A44E610>]}
[0m16:24:50.617617 [info ] [MainThread]: 
[0m16:24:50.617617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:50.633206 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m16:24:50.645334 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m16:24:50.646335 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m16:24:50.646335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:50.704288 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:24:50.705283 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m16:24:50.707252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m16:24:50.713284 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:24:50.714282 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m16:24:50.714282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:50.748393 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:24:50.748393 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:24:50.748393 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m16:24:50.764022 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:24:50.764022 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m16:24:50.764022 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m16:24:50.764022 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:50.764022 [debug] [MainThread]: On master: BEGIN
[0m16:24:50.764022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:50.810935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:24:50.810935 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:50.810935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:50.842189 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m16:24:50.842189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141AEAFC50>]}
[0m16:24:50.842189 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:50.842189 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:50.842189 [debug] [MainThread]: On master: BEGIN
[0m16:24:50.842189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:24:50.842189 [debug] [MainThread]: On master: COMMIT
[0m16:24:50.842189 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:50.842189 [debug] [MainThread]: On master: COMMIT
[0m16:24:50.842189 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:24:50.842189 [debug] [MainThread]: On master: Close
[0m16:24:50.842189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:50.842189 [info ] [MainThread]: 
[0m16:24:50.857776 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m16:24:50.857776 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m16:24:50.857776 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_airport'
[0m16:24:50.865804 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m16:24:50.868842 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m16:24:50.870815 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 16:24:50.865804 => 16:24:50.869814
[0m16:24:50.870815 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m16:24:50.921848 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m16:24:50.922849 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:24:50.923811 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m16:24:50.923811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:24:50.970850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:24:50.971811 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:24:50.972811 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    

select *
from stg.airports_data
  );
  
[0m16:24:50.990173 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m16:24:50.998185 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:24:50.998185 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m16:24:50.998185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:24:50.998185 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:24:50.998185 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m16:24:50.998185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:24:51.029490 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:24:51.029490 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:24:51.029490 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:24:51.029490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:24:51.029490 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:24:51.045117 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
drop view if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m16:24:51.045117 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:24:51.045117 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 16:24:50.871853 => 16:24:51.045117
[0m16:24:51.045117 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m16:24:51.045117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141A6D3810>]}
[0m16:24:51.045117 [info ] [Thread-1 (]: 1 of 3 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.19s]
[0m16:24:51.045117 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m16:24:51.045117 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m16:24:51.045117 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m16:24:51.045117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m16:24:51.045117 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m16:24:51.045117 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m16:24:51.045117 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 16:24:51.045117 => 16:24:51.045117
[0m16:24:51.045117 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m16:24:51.080859 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m16:24:51.082863 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:24:51.083878 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m16:24:51.084862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:51.245234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:24:51.245234 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:24:51.245234 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m16:24:51.245234 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:24:51.245234 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:24:51.245234 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:24:51.260892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:24:51.260892 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:24:51.260892 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:24:51.260892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:24:51.260892 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:24:51.260892 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:24:51.260892 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:24:51.274470 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:24:51.277031 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:24:51.277031 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m16:24:51.277031 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:24:51.277031 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 16:24:51.060732 => 16:24:51.277031
[0m16:24:51.277031 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m16:24:51.277031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141AF12850>]}
[0m16:24:51.277031 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.23s]
[0m16:24:51.277031 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m16:24:51.277031 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m16:24:51.277031 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m16:24:51.277031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m16:24:51.277031 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m16:24:51.292708 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m16:24:51.294874 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 16:24:51.277031 => 16:24:51.293865
[0m16:24:51.294874 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m16:24:51.299882 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m16:24:51.301886 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:24:51.302894 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m16:24:51.302894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:51.353716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:24:51.353716 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:24:51.354683 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m16:24:51.360676 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:24:51.364677 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:24:51.365680 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:24:51.367678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:24:51.369716 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:24:51.370712 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:24:51.370712 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:24:51.372676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:24:51.375714 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:24:51.375714 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m16:24:51.376676 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:24:51.377714 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 16:24:51.295873 => 16:24:51.377714
[0m16:24:51.378716 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m16:24:51.379675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e3fc3d-5e3d-4e92-a09b-32ceb5701682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141A4B8590>]}
[0m16:24:51.380678 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m16:24:51.383701 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m16:24:51.386676 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:51.386676 [debug] [MainThread]: On master: BEGIN
[0m16:24:51.387676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:51.435060 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:24:51.436059 [debug] [MainThread]: On master: COMMIT
[0m16:24:51.436059 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:51.437069 [debug] [MainThread]: On master: COMMIT
[0m16:24:51.438063 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:24:51.439068 [debug] [MainThread]: On master: Close
[0m16:24:51.441063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:51.442066 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m16:24:51.442066 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m16:24:51.443058 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m16:24:51.443058 [info ] [MainThread]: 
[0m16:24:51.444056 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m16:24:51.446091 [debug] [MainThread]: Command end result
[0m16:24:51.455055 [info ] [MainThread]: 
[0m16:24:51.457057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:51.457418 [info ] [MainThread]: 
[0m16:24:51.458428 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:24:51.459430 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:51.459430 after 1.78 seconds
[0m16:24:51.460458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141A29A490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214141E9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141422A210>]}
[0m16:24:51.460458 [debug] [MainThread]: Flushing usage events
[0m16:38:42.594643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A110E58DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A110F0F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A110DF3A10>]}


============================== 16:38:42.594643 | 484509fc-bda6-4dca-9fa5-26b52c778b92 ==============================
[0m16:38:42.594643 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:38:42.594643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:38:42.685047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '484509fc-bda6-4dca-9fa5-26b52c778b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A110E1B510>]}
[0m16:38:42.709780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '484509fc-bda6-4dca-9fa5-26b52c778b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A110B6F390>]}
[0m16:38:42.711735 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m16:38:42.724405 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:38:42.790586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:42.791588 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\dim_airport.sql
[0m16:38:42.815582 [debug] [MainThread]: 1699: static parser successfully parsed dimentions\dim_airport.sql
[0m16:38:42.874366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '484509fc-bda6-4dca-9fa5-26b52c778b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1116B3B10>]}
[0m16:38:42.874366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '484509fc-bda6-4dca-9fa5-26b52c778b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A111699650>]}
[0m16:38:42.874366 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:38:42.889973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '484509fc-bda6-4dca-9fa5-26b52c778b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10D2A8590>]}
[0m16:38:42.889973 [info ] [MainThread]: 
[0m16:38:42.889973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:42.889973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m16:38:42.906976 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m16:38:42.906976 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m16:38:42.907989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:42.965007 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:38:42.967035 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m16:38:42.970006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m16:38:42.976004 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:38:42.976004 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m16:38:42.977005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:43.139089 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:38:43.139089 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:38:43.139089 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m16:38:43.154742 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:38:43.154742 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m16:38:43.154742 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m16:38:43.154742 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:43.154742 [debug] [MainThread]: On master: BEGIN
[0m16:38:43.154742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:43.346780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:38:43.347787 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:43.347787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:43.360957 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:38:43.360957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '484509fc-bda6-4dca-9fa5-26b52c778b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1112885D0>]}
[0m16:38:43.360957 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:43.360957 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:43.376652 [debug] [MainThread]: On master: BEGIN
[0m16:38:43.376652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:38:43.376652 [debug] [MainThread]: On master: COMMIT
[0m16:38:43.376652 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:43.376652 [debug] [MainThread]: On master: COMMIT
[0m16:38:43.376652 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:38:43.376652 [debug] [MainThread]: On master: Close
[0m16:38:43.376652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:43.376652 [info ] [MainThread]: 
[0m16:38:43.376652 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m16:38:43.376652 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m16:38:43.376652 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_airport'
[0m16:38:43.390829 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m16:38:43.393841 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m16:38:43.395855 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 16:38:43.390829 => 16:38:43.395855
[0m16:38:43.396843 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m16:38:43.439873 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m16:38:43.440872 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:38:43.441843 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m16:38:43.441843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:38:43.489452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:38:43.489452 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:38:43.490477 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    

select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
from stg.airports_data
  );
  
[0m16:38:43.505962 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m16:38:43.511103 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:38:43.511103 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m16:38:43.511103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:43.511103 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:38:43.511103 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m16:38:43.511103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:43.526768 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:38:43.526768 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:38:43.526768 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:38:43.542357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:38:43.542357 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:38:43.542357 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m16:38:43.542357 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:38:43.542357 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 16:38:43.396843 => 16:38:43.542357
[0m16:38:43.542357 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m16:38:43.542357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '484509fc-bda6-4dca-9fa5-26b52c778b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A111628510>]}
[0m16:38:43.542357 [info ] [Thread-1 (]: 1 of 3 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.17s]
[0m16:38:43.557987 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m16:38:43.557987 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m16:38:43.557987 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m16:38:43.557987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m16:38:43.557987 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m16:38:43.557987 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m16:38:43.557987 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 16:38:43.557987 => 16:38:43.557987
[0m16:38:43.557987 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m16:38:43.588833 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m16:38:43.589836 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:38:43.590808 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m16:38:43.590808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:43.639668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:38:43.639668 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:38:43.640706 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m16:38:43.648769 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:38:43.652787 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:38:43.652787 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:38:43.654764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:43.657789 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:38:43.657789 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:38:43.658763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:43.660764 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:38:43.661787 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:38:43.662764 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:38:43.664030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:38:43.666080 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:38:43.667079 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m16:38:43.669086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:38:43.671092 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 16:38:43.557987 => 16:38:43.670080
[0m16:38:43.671092 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m16:38:43.672042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '484509fc-bda6-4dca-9fa5-26b52c778b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A11156B9D0>]}
[0m16:38:43.673046 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.11s]
[0m16:38:43.675040 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m16:38:43.676043 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m16:38:43.677048 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m16:38:43.679041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m16:38:43.679041 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m16:38:43.682066 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m16:38:43.683070 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 16:38:43.680041 => 16:38:43.683070
[0m16:38:43.683070 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m16:38:43.688044 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m16:38:43.689045 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:38:43.690046 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m16:38:43.690046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:43.867536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:38:43.868517 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:38:43.869477 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m16:38:43.875478 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:38:43.877337 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:38:43.877337 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:38:43.877337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:43.877337 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:38:43.877337 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:38:43.877337 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:38:43.890067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:38:43.892614 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:38:43.892614 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m16:38:43.892614 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:38:43.892614 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 16:38:43.684039 => 16:38:43.892614
[0m16:38:43.892614 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m16:38:43.892614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '484509fc-bda6-4dca-9fa5-26b52c778b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A111744C50>]}
[0m16:38:43.892614 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.21s]
[0m16:38:43.892614 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m16:38:43.892614 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:43.892614 [debug] [MainThread]: On master: BEGIN
[0m16:38:43.892614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:43.949276 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:38:43.950305 [debug] [MainThread]: On master: COMMIT
[0m16:38:43.951324 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:43.951324 [debug] [MainThread]: On master: COMMIT
[0m16:38:43.952271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:38:43.953306 [debug] [MainThread]: On master: Close
[0m16:38:43.954311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:43.955270 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m16:38:43.955270 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m16:38:43.955270 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m16:38:43.956269 [info ] [MainThread]: 
[0m16:38:43.957280 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m16:38:43.959363 [debug] [MainThread]: Command end result
[0m16:38:43.967688 [info ] [MainThread]: 
[0m16:38:43.968695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:43.969597 [info ] [MainThread]: 
[0m16:38:43.970608 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:38:43.971607 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:43.971607 after 1.38 seconds
[0m16:38:43.971607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A110DF37D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A11103F210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10A8FAE10>]}
[0m16:38:43.972646 [debug] [MainThread]: Flushing usage events
[0m16:40:25.785024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217366A6C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217366642D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738896F10>]}


============================== 16:40:25.785024 | 92a3b54d-8181-43ee-8360-4e37b462ca15 ==============================
[0m16:40:25.785024 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:40:25.785024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:40:25.876789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92a3b54d-8181-43ee-8360-4e37b462ca15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173894B490>]}
[0m16:40:25.898782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92a3b54d-8181-43ee-8360-4e37b462ca15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738C20D50>]}
[0m16:40:25.900739 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m16:40:25.915836 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:40:25.983868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:40:25.984870 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\dim_airport.sql
[0m16:40:26.011835 [debug] [MainThread]: 1603: static parser failed on dimentions\dim_airport.sql
[0m16:40:26.026127 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimentions\dim_airport.sql
[0m16:40:26.073048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92a3b54d-8181-43ee-8360-4e37b462ca15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217391C6110>]}
[0m16:40:26.073048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92a3b54d-8181-43ee-8360-4e37b462ca15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217391A3890>]}
[0m16:40:26.073048 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:40:26.073048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a3b54d-8181-43ee-8360-4e37b462ca15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021734DD8710>]}
[0m16:40:26.073048 [info ] [MainThread]: 
[0m16:40:26.088633 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:26.088633 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m16:40:26.088633 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m16:40:26.088633 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m16:40:26.088633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:26.168398 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:40:26.170404 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m16:40:26.172400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m16:40:26.179445 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:40:26.179445 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m16:40:26.180451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:26.225960 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:40:26.225960 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:40:26.225960 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m16:40:26.225960 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:40:26.225960 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m16:40:26.225960 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m16:40:26.240971 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:26.240971 [debug] [MainThread]: On master: BEGIN
[0m16:40:26.240971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:26.287910 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:40:26.287910 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:26.287910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:26.303514 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:40:26.319147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a3b54d-8181-43ee-8360-4e37b462ca15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738988650>]}
[0m16:40:26.319147 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:26.319147 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:26.319147 [debug] [MainThread]: On master: BEGIN
[0m16:40:26.319147 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:40:26.319147 [debug] [MainThread]: On master: COMMIT
[0m16:40:26.319147 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:26.319147 [debug] [MainThread]: On master: COMMIT
[0m16:40:26.319147 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:40:26.319147 [debug] [MainThread]: On master: Close
[0m16:40:26.319147 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:26.319147 [info ] [MainThread]: 
[0m16:40:26.319147 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m16:40:26.319147 [info ] [Thread-1 (]: 1 of 3 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m16:40:26.334277 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_airport'
[0m16:40:26.334277 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m16:40:26.338286 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m16:40:26.340290 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 16:40:26.335317 => 16:40:26.339285
[0m16:40:26.342889 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m16:40:26.399937 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m16:40:26.400901 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:40:26.401899 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m16:40:26.401899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:26.442468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:40:26.442468 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:40:26.442468 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    

select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 13:40:25' as run_time
from stg.airports_data
  );
  
[0m16:40:26.461320 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m16:40:26.461320 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:40:26.461320 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m16:40:26.461320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:26.473723 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:40:26.473723 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m16:40:26.477233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:26.492917 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:40:26.492917 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:40:26.492917 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:40:26.492917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:40:26.508498 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:40:26.508498 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m16:40:26.508498 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:40:26.508498 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 16:40:26.343906 => 16:40:26.508498
[0m16:40:26.508498 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m16:40:26.508498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a3b54d-8181-43ee-8360-4e37b462ca15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217390F0AD0>]}
[0m16:40:26.508498 [info ] [Thread-1 (]: 1 of 3 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.19s]
[0m16:40:26.508498 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m16:40:26.508498 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m16:40:26.508498 [info ] [Thread-1 (]: 2 of 3 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m16:40:26.508498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m16:40:26.508498 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m16:40:26.527378 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m16:40:26.529373 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 16:40:26.508498 => 16:40:26.528374
[0m16:40:26.529373 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m16:40:26.553407 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m16:40:26.554408 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:40:26.556374 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m16:40:26.557373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:26.606653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:40:26.606653 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:40:26.607617 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m16:40:26.614082 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:40:26.617046 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:40:26.618047 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:40:26.620047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:26.623047 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:40:26.623047 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:40:26.624047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:26.627047 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:40:26.627047 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:40:26.628047 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:40:26.630767 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:40:26.633780 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:40:26.633780 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m16:40:26.636228 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:40:26.638270 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 16:40:26.530373 => 16:40:26.638270
[0m16:40:26.638270 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m16:40:26.639269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a3b54d-8181-43ee-8360-4e37b462ca15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021739271250>]}
[0m16:40:26.641231 [info ] [Thread-1 (]: 2 of 3 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.13s]
[0m16:40:26.642338 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m16:40:26.642338 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m16:40:26.642338 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m16:40:26.642338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m16:40:26.642338 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m16:40:26.642338 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m16:40:26.642338 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 16:40:26.642338 => 16:40:26.642338
[0m16:40:26.642338 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m16:40:26.642338 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m16:40:26.657967 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:40:26.657967 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m16:40:26.660168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:26.821843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:40:26.821843 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:40:26.821843 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m16:40:26.821843 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:40:26.837474 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:40:26.837474 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:40:26.837474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:40:26.837474 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:40:26.837474 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:40:26.837474 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:40:26.837474 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:40:26.837474 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:40:26.837474 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m16:40:26.837474 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:40:26.837474 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 16:40:26.642338 => 16:40:26.837474
[0m16:40:26.837474 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m16:40:26.837474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a3b54d-8181-43ee-8360-4e37b462ca15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173924BED0>]}
[0m16:40:26.853055 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.20s]
[0m16:40:26.853055 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m16:40:26.853055 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:26.853055 [debug] [MainThread]: On master: BEGIN
[0m16:40:26.853055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:26.905822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:40:26.906857 [debug] [MainThread]: On master: COMMIT
[0m16:40:26.906857 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:26.907821 [debug] [MainThread]: On master: COMMIT
[0m16:40:26.907821 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:40:26.908823 [debug] [MainThread]: On master: Close
[0m16:40:26.910822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:26.911829 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m16:40:26.912824 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m16:40:26.913846 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m16:40:26.914825 [info ] [MainThread]: 
[0m16:40:26.915822 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m16:40:26.917917 [debug] [MainThread]: Command end result
[0m16:40:26.924728 [info ] [MainThread]: 
[0m16:40:26.925727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:26.927726 [info ] [MainThread]: 
[0m16:40:26.928728 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:40:26.931727 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:26.931727 after 1.16 seconds
[0m16:40:26.932763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738446810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217323C9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021738896E10>]}
[0m16:40:26.932763 [debug] [MainThread]: Flushing usage events
[0m16:59:44.472440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA58E9C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA761C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA9F9C210>]}


============================== 16:59:44.472440 | 5aa18772-3d2b-4441-8728-89205808b275 ==============================
[0m16:59:44.472440 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:59:44.472440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:59:44.604252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA9F84D90>]}
[0m16:59:44.635538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA9F85390>]}
[0m16:59:44.635538 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m16:59:44.658467 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:59:44.744510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:59:44.744510 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\dimentions\dim_aircraft.sql
[0m16:59:44.770840 [debug] [MainThread]: 1699: static parser successfully parsed dimentions\dim_aircraft.sql
[0m16:59:44.802126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AAA6EA010>]}
[0m16:59:44.802126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AAA82CA50>]}
[0m16:59:44.802126 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:59:44.802126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA63F8710>]}
[0m16:59:44.802126 [info ] [MainThread]: 
[0m16:59:44.802126 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:59:44.819198 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m16:59:44.832242 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m16:59:44.833256 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m16:59:44.833256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:44.898088 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:59:44.899089 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m16:59:44.901099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m16:59:44.908095 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:59:44.909128 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m16:59:44.909128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:44.954078 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:59:44.954078 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m16:59:44.954078 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m16:59:44.954078 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:59:44.954078 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m16:59:44.954078 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m16:59:44.969122 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:44.969122 [debug] [MainThread]: On master: BEGIN
[0m16:59:44.969122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:45.000424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:45.000424 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:45.000424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:59:45.037561 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m16:59:45.037561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA9A52010>]}
[0m16:59:45.037561 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:45.037561 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:45.037561 [debug] [MainThread]: On master: BEGIN
[0m16:59:45.037561 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:45.037561 [debug] [MainThread]: On master: COMMIT
[0m16:59:45.037561 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:45.037561 [debug] [MainThread]: On master: COMMIT
[0m16:59:45.037561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:59:45.037561 [debug] [MainThread]: On master: Close
[0m16:59:45.037561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:45.053200 [info ] [MainThread]: 
[0m16:59:45.053200 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m16:59:45.053200 [info ] [Thread-1 (]: 1 of 4 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m16:59:45.053200 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m16:59:45.062152 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m16:59:45.064195 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m16:59:45.066163 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 16:59:45.063191 => 16:59:45.065190
[0m16:59:45.067163 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m16:59:45.118198 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m16:59:45.119159 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m16:59:45.120159 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m16:59:45.120159 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:59:45.295698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:45.295698 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m16:59:45.295698 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
[0m16:59:45.343021 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m16:59:45.343021 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m16:59:45.343021 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m16:59:45.343021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:45.374281 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m16:59:45.374281 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m16:59:45.374281 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m16:59:45.374281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:45.374281 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m16:59:45.374281 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m16:59:45.374281 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:59:45.389908 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 16:59:45.067163 => 16:59:45.374281
[0m16:59:45.389908 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m16:59:45.389908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AAA6DD190>]}
[0m16:59:45.389908 [info ] [Thread-1 (]: 1 of 4 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.34s]
[0m16:59:45.389908 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m16:59:45.389908 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m16:59:45.389908 [info ] [Thread-1 (]: 2 of 4 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m16:59:45.389908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m16:59:45.389908 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m16:59:45.389908 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m16:59:45.389908 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 16:59:45.389908 => 16:59:45.389908
[0m16:59:45.389908 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m16:59:45.409627 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m16:59:45.410624 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:59:45.411630 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m16:59:45.412627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:45.633517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:45.633517 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:59:45.633517 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    

select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 13:59:44' as run_time
from stg.airports_data
  );
  
[0m16:59:45.649078 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m16:59:45.649078 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:59:45.649078 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m16:59:45.664701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:45.664701 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:59:45.664701 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m16:59:45.664701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:45.664701 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:59:45.664701 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:59:45.664701 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m16:59:45.664701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:45.680367 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m16:59:45.680367 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m16:59:45.680367 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:59:45.680367 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 16:59:45.389908 => 16:59:45.680367
[0m16:59:45.680367 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m16:59:45.680367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AAA814650>]}
[0m16:59:45.680367 [info ] [Thread-1 (]: 2 of 4 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.29s]
[0m16:59:45.680367 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m16:59:45.680367 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m16:59:45.680367 [info ] [Thread-1 (]: 3 of 4 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m16:59:45.680367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m16:59:45.680367 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m16:59:45.697035 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m16:59:45.698080 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 16:59:45.680367 => 16:59:45.698080
[0m16:59:45.699043 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m16:59:45.722051 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m16:59:45.724049 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:59:45.725121 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m16:59:45.726043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:45.866242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:45.881866 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:59:45.881866 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m16:59:45.881866 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:59:45.881866 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:59:45.881866 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m16:59:45.881866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:45.897537 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:59:45.897537 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:59:45.897537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:45.897537 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:59:45.897537 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:59:45.897537 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m16:59:45.908964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:45.908964 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m16:59:45.908964 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m16:59:45.913473 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:59:45.913473 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 16:59:45.699043 => 16:59:45.913473
[0m16:59:45.913473 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m16:59:45.913473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AAA898150>]}
[0m16:59:45.913473 [info ] [Thread-1 (]: 3 of 4 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.23s]
[0m16:59:45.913473 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m16:59:45.913473 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m16:59:45.913473 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m16:59:45.913473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m16:59:45.913473 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m16:59:45.913473 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m16:59:45.929111 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 16:59:45.913473 => 16:59:45.913473
[0m16:59:45.929111 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m16:59:45.934351 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m16:59:45.935352 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:59:45.936357 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m16:59:45.937354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:45.989239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:59:45.990240 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:59:45.991260 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m16:59:45.997414 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:59:46.000451 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:59:46.001450 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:59:46.002415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:59:46.005510 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:59:46.006418 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:59:46.006418 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m16:59:46.008416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:59:46.011453 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m16:59:46.012450 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m16:59:46.013454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:59:46.014415 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 16:59:45.930338 => 16:59:46.014415
[0m16:59:46.015465 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m16:59:46.016419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aa18772-3d2b-4441-8728-89205808b275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AAA6CBC10>]}
[0m16:59:46.016419 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m16:59:46.018416 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m16:59:46.020416 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:46.020416 [debug] [MainThread]: On master: BEGIN
[0m16:59:46.020416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:46.066179 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:59:46.066179 [debug] [MainThread]: On master: COMMIT
[0m16:59:46.067223 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:46.067223 [debug] [MainThread]: On master: COMMIT
[0m16:59:46.068223 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:59:46.069194 [debug] [MainThread]: On master: Close
[0m16:59:46.070192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:46.071194 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m16:59:46.071194 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m16:59:46.072193 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m16:59:46.073196 [info ] [MainThread]: 
[0m16:59:46.074216 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m16:59:46.077192 [debug] [MainThread]: Command end result
[0m16:59:46.084189 [info ] [MainThread]: 
[0m16:59:46.086207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:46.087191 [info ] [MainThread]: 
[0m16:59:46.088191 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:59:46.089191 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:46.089191 after 1.63 seconds
[0m16:59:46.090191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA3A1ADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA3A1A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA7BEF850>]}
[0m16:59:46.090191 [debug] [MainThread]: Flushing usage events
[0m17:03:01.600486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C34D7E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C3C28B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C3AE40D0>]}


============================== 17:03:01.600486 | b6b862c6-42dd-4260-bba4-3ae982463d62 ==============================
[0m17:03:01.600486 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:03:01.600486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:03:01.740019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C34B6DD0>]}
[0m17:03:01.755642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C34B6DD0>]}
[0m17:03:01.755642 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m17:03:01.778526 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:03:01.846874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:03:01.848853 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\schema.yml
[0m17:03:01.875787 [debug] [MainThread]: 1603: static parser failed on dimentions\dim_airport.sql
[0m17:03:01.890802 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimentions\dim_airport.sql
[0m17:03:01.968943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C32A2290>]}
[0m17:03:01.985138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C37BF210>]}
[0m17:03:01.986157 [info ] [MainThread]: Found 4 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:03:01.987151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BFC48710>]}
[0m17:03:01.991146 [info ] [MainThread]: 
[0m17:03:01.994148 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:01.997150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:03:02.024373 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:03:02.025374 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:03:02.027375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:02.108223 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:03:02.108223 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:03:02.108223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m17:03:02.123238 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:03:02.123238 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:03:02.123238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:02.170128 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.170128 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:03:02.170128 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:03:02.185750 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:03:02.185750 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:03:02.185750 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:03:02.185750 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:02.185750 [debug] [MainThread]: On master: BEGIN
[0m17:03:02.185750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:02.232626 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.232626 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:02.232626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:02.263877 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:03:02.263877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C34E6950>]}
[0m17:03:02.263877 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:02.263877 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:02.263877 [debug] [MainThread]: On master: BEGIN
[0m17:03:02.263877 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.263877 [debug] [MainThread]: On master: COMMIT
[0m17:03:02.279505 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:02.279505 [debug] [MainThread]: On master: COMMIT
[0m17:03:02.279505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.279505 [debug] [MainThread]: On master: Close
[0m17:03:02.279505 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:02.279505 [info ] [MainThread]: 
[0m17:03:02.279505 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m17:03:02.279505 [info ] [Thread-1 (]: 1 of 4 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m17:03:02.292254 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m17:03:02.292254 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m17:03:02.294264 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m17:03:02.296267 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 17:03:02.293263 => 17:03:02.295261
[0m17:03:02.297266 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m17:03:02.343289 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m17:03:02.345290 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:03:02.346276 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m17:03:02.347275 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:03:02.391267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.391267 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:03:02.391267 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
[0m17:03:02.406942 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:03:02.406942 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:03:02.406942 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m17:03:02.406942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.422521 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:03:02.422521 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m17:03:02.422521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.438151 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:03:02.438151 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:03:02.438151 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:03:02.438151 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.453824 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:03:02.453824 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m17:03:02.453824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:02.453824 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 17:03:02.297266 => 17:03:02.453824
[0m17:03:02.453824 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m17:03:02.453824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C38C8090>]}
[0m17:03:02.469397 [info ] [Thread-1 (]: 1 of 4 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.17s]
[0m17:03:02.469397 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m17:03:02.469397 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m17:03:02.469397 [info ] [Thread-1 (]: 2 of 4 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m17:03:02.469397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m17:03:02.475835 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m17:03:02.478848 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m17:03:02.479845 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 17:03:02.475835 => 17:03:02.479845
[0m17:03:02.480842 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m17:03:02.487877 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m17:03:02.488880 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:03:02.489841 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m17:03:02.489841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:02.537189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.538221 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:03:02.538221 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    

select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 14:03:01' as run_time
from stg.airports_data
  );
  
[0m17:03:02.551868 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:03:02.554867 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:03:02.555840 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m17:03:02.556840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.559840 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:03:02.559840 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m17:03:02.560840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.563845 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:03:02.563845 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:03:02.564845 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:03:02.566494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.569541 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:03:02.569541 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m17:03:02.573507 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:03:02.575549 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 17:03:02.481859 => 17:03:02.574509
[0m17:03:02.575549 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m17:03:02.576507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C406A050>]}
[0m17:03:02.577543 [info ] [Thread-1 (]: 2 of 4 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.11s]
[0m17:03:02.579509 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m17:03:02.579509 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m17:03:02.580508 [info ] [Thread-1 (]: 3 of 4 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m17:03:02.582544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m17:03:02.582544 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m17:03:02.585541 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m17:03:02.586506 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 17:03:02.583508 => 17:03:02.586506
[0m17:03:02.586506 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m17:03:02.611170 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m17:03:02.613172 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:03:02.613172 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m17:03:02.614169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:02.664954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.664954 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:03:02.665962 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:03:02.672600 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:02.675601 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:03:02.675601 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:03:02.676600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.679565 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:03:02.680565 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:03:02.681566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.683601 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:03:02.683601 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:03:02.684602 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:03:02.687004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.690015 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:03:02.690015 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:03:02.692846 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:02.693898 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 17:03:02.587545 => 17:03:02.693898
[0m17:03:02.694895 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m17:03:02.695856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C40FAC90>]}
[0m17:03:02.696858 [info ] [Thread-1 (]: 3 of 4 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.11s]
[0m17:03:02.697860 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m17:03:02.698860 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m17:03:02.699886 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:03:02.701857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m17:03:02.701857 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m17:03:02.704894 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m17:03:02.705856 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 17:03:02.701857 => 17:03:02.705856
[0m17:03:02.705856 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m17:03:02.711767 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m17:03:02.712735 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:03:02.713735 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m17:03:02.714776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:02.765957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.765957 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:03:02.766991 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:03:02.773256 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:03:02.778289 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:03:02.778289 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:03:02.779291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:03:02.781293 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:03:02.782255 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:03:02.782255 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:03:02.784256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.787255 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:03:02.787255 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:03:02.788417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:03:02.789428 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 17:03:02.706856 => 17:03:02.789428
[0m17:03:02.790467 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m17:03:02.791429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b862c6-42dd-4260-bba4-3ae982463d62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C411BFD0>]}
[0m17:03:02.792427 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m17:03:02.794429 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m17:03:02.796430 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:02.796430 [debug] [MainThread]: On master: BEGIN
[0m17:03:02.797428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:02.862067 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:02.862067 [debug] [MainThread]: On master: COMMIT
[0m17:03:02.863069 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:02.864107 [debug] [MainThread]: On master: COMMIT
[0m17:03:02.865066 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:02.865066 [debug] [MainThread]: On master: Close
[0m17:03:02.866068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:02.867115 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m17:03:02.868068 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m17:03:02.868068 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m17:03:02.869103 [info ] [MainThread]: 
[0m17:03:02.870103 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m17:03:02.872069 [debug] [MainThread]: Command end result
[0m17:03:02.884067 [info ] [MainThread]: 
[0m17:03:02.886069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:02.887067 [info ] [MainThread]: 
[0m17:03:02.888068 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:03:02.889068 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:02.889068 after 1.31 seconds
[0m17:03:02.889068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C32D1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239BD2AA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239C143FB50>]}
[0m17:03:02.890067 [debug] [MainThread]: Flushing usage events
[0m17:05:05.447121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606EF69090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606E84C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606E84E950>]}


============================== 17:05:05.447121 | a01f50d1-08f6-4c83-815c-1387f01c3548 ==============================
[0m17:05:05.447121 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:05:05.447121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:05:05.544296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606EB94D50>]}
[0m17:05:05.566264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606E611F90>]}
[0m17:05:05.568265 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m17:05:05.573221 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:05:05.650108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:05.651108 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\dim_aircraft.sql
[0m17:05:05.677076 [debug] [MainThread]: 1603: static parser failed on dimentions\dim_aircraft.sql
[0m17:05:05.689624 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimentions\dim_aircraft.sql
[0m17:05:05.736555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606F3A24D0>]}
[0m17:05:05.736555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606F2D9810>]}
[0m17:05:05.736555 [info ] [MainThread]: Found 4 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:05:05.736555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606AF88710>]}
[0m17:05:05.752164 [info ] [MainThread]: 
[0m17:05:05.752164 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:05:05.752164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:05:05.752164 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:05:05.752164 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:05:05.752164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:05.826068 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:05:05.828028 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:05:05.831020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m17:05:05.836019 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:05:05.837020 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:05:05.837020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:05.882177 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:05:05.882177 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:05:05.883181 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:05:05.889480 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:05:05.889480 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:05:05.889480 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:05:05.889480 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:05.889480 [debug] [MainThread]: On master: BEGIN
[0m17:05:05.889480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:05.936402 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:05:05.936402 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:05.936402 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:05:05.967610 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:05:05.967610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606EAFAED0>]}
[0m17:05:05.967610 [debug] [MainThread]: On master: ROLLBACK
[0m17:05:05.967610 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:05.967610 [debug] [MainThread]: On master: BEGIN
[0m17:05:05.967610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:05:05.967610 [debug] [MainThread]: On master: COMMIT
[0m17:05:05.967610 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:05.967610 [debug] [MainThread]: On master: COMMIT
[0m17:05:05.967610 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:05:05.983235 [debug] [MainThread]: On master: Close
[0m17:05:05.983235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:05.983235 [info ] [MainThread]: 
[0m17:05:05.983235 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m17:05:05.983235 [info ] [Thread-1 (]: 1 of 4 START sql table model flights_wh.dim_aircraft ........................... [RUN]
[0m17:05:05.993594 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m17:05:05.993594 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m17:05:05.997607 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m17:05:05.999621 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 17:05:05.994604 => 17:05:05.998609
[0m17:05:06.000609 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m17:05:06.049601 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m17:05:06.050603 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:05:06.051604 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m17:05:06.051604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:05:06.096564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:05:06.097562 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:05:06.097562 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp"
  
  
    as
  
  (
    select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 14:05:05' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
[0m17:05:06.111632 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:05:06.121672 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:05:06.121672 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft" rename to "dim_aircraft__dbt_backup"
[0m17:05:06.121672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:06.121672 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:05:06.121672 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */
alter table "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_tmp" rename to "dim_aircraft"
[0m17:05:06.121672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:06.152983 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:05:06.152983 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:05:06.152983 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:05:06.152983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:05:06.152983 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:05:06.152983 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_aircraft__dbt_backup" cascade
[0m17:05:06.168558 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:05:06.168558 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 17:05:06.000609 => 17:05:06.168558
[0m17:05:06.168558 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m17:05:06.168558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606F2BC610>]}
[0m17:05:06.168558 [info ] [Thread-1 (]: 1 of 4 OK created sql table model flights_wh.dim_aircraft ...................... [[32mSELECT 1339[0m in 0.19s]
[0m17:05:06.168558 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m17:05:06.168558 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m17:05:06.168558 [info ] [Thread-1 (]: 2 of 4 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m17:05:06.168558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m17:05:06.168558 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m17:05:06.168558 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m17:05:06.168558 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 17:05:06.168558 => 17:05:06.168558
[0m17:05:06.168558 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m17:05:06.189349 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m17:05:06.191351 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:05:06.192345 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m17:05:06.193358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:06.243481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:05:06.244517 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:05:06.244517 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    

select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 14:05:05' as run_time
from stg.airports_data
  );
  
[0m17:05:06.254957 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:05:06.259958 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:05:06.260995 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m17:05:06.261963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:06.265994 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:05:06.265994 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m17:05:06.266992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:06.268957 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:05:06.269993 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:05:06.270957 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:05:06.271956 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:05:06.274994 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:05:06.275992 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m17:05:06.278958 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:05:06.280992 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 17:05:06.184185 => 17:05:06.280992
[0m17:05:06.280992 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m17:05:06.281962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606F3AED50>]}
[0m17:05:06.282957 [info ] [Thread-1 (]: 2 of 4 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.11s]
[0m17:05:06.284959 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m17:05:06.285958 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m17:05:06.285958 [info ] [Thread-1 (]: 3 of 4 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m17:05:06.287960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m17:05:06.287960 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m17:05:06.290995 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m17:05:06.291993 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 17:05:06.288957 => 17:05:06.291993
[0m17:05:06.292957 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m17:05:06.314918 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m17:05:06.316920 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:05:06.317920 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m17:05:06.317920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:06.365913 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:05:06.365913 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:05:06.366913 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:05:06.371910 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:05:06.374945 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:05:06.375914 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:05:06.376913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:06.378945 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:05:06.379946 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:05:06.380911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:06.382954 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:05:06.383911 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:05:06.383911 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:05:06.386843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:05:06.389892 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:05:06.389892 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:05:06.392245 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:05:06.393256 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 17:05:06.292957 => 17:05:06.393256
[0m17:05:06.394298 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m17:05:06.395257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606F411650>]}
[0m17:05:06.396263 [info ] [Thread-1 (]: 3 of 4 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.11s]
[0m17:05:06.398257 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m17:05:06.399256 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m17:05:06.400256 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:05:06.401262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m17:05:06.401262 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m17:05:06.404292 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m17:05:06.405713 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 17:05:06.402257 => 17:05:06.405713
[0m17:05:06.406900 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m17:05:06.411912 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m17:05:06.413913 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:05:06.414922 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m17:05:06.415954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:06.463910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:05:06.464947 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:05:06.464947 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:05:06.470912 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:05:06.474945 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:05:06.475950 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:05:06.475950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:06.477946 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:05:06.478948 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:05:06.478948 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:05:06.481163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:05:06.484260 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:05:06.484260 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:05:06.485215 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:05:06.487255 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 17:05:06.407914 => 17:05:06.487255
[0m17:05:06.487255 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m17:05:06.489220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a01f50d1-08f6-4c83-815c-1387f01c3548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606F455B90>]}
[0m17:05:06.490223 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m17:05:06.491217 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m17:05:06.493220 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:06.494217 [debug] [MainThread]: On master: BEGIN
[0m17:05:06.494217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:06.540231 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:05:06.541234 [debug] [MainThread]: On master: COMMIT
[0m17:05:06.542238 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:06.542238 [debug] [MainThread]: On master: COMMIT
[0m17:05:06.544245 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:05:06.544245 [debug] [MainThread]: On master: Close
[0m17:05:06.546262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:06.547232 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m17:05:06.548230 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m17:05:06.549235 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m17:05:06.549235 [info ] [MainThread]: 
[0m17:05:06.551231 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m17:05:06.553265 [debug] [MainThread]: Command end result
[0m17:05:06.561268 [info ] [MainThread]: 
[0m17:05:06.563233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:06.564122 [info ] [MainThread]: 
[0m17:05:06.565135 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:05:06.566134 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:06.566134 after 1.13 seconds
[0m17:05:06.566134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606ED1F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260685CA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260685CADD0>]}
[0m17:05:06.567131 [debug] [MainThread]: Flushing usage events
[0m17:06:48.447297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37EFEC2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37ECD7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37ECD7690>]}


============================== 17:06:48.447297 | 1a9259de-1436-4b81-b6be-71e19985d9f4 ==============================
[0m17:06:48.447297 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:06:48.447297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:06:48.544109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37ED83250>]}
[0m17:06:48.567111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37ECC2CD0>]}
[0m17:06:48.569069 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m17:06:48.571527 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:06:48.648208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:06:48.649208 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\dim_aircraft.sql
[0m17:06:48.676216 [debug] [MainThread]: 1603: static parser failed on dimentions\dim_aircraft.sql
[0m17:06:48.688035 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimentions\dim_aircraft.sql
[0m17:06:48.734405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37F863D10>]}
[0m17:06:48.734405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37F73C090>]}
[0m17:06:48.734405 [info ] [MainThread]: Found 4 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:06:48.749977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37B438590>]}
[0m17:06:48.749977 [info ] [MainThread]: 
[0m17:06:48.749977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:06:48.749977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:06:48.765654 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:06:48.765654 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:06:48.767250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:48.825579 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:06:48.827611 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:06:48.829608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m17:06:48.835577 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:06:48.835577 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:06:48.836583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:48.887883 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:06:48.887883 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:06:48.887883 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:06:48.887883 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:06:48.887883 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:06:48.887883 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:06:48.903523 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:48.903523 [debug] [MainThread]: On master: BEGIN
[0m17:06:48.903523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:48.950427 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:06:48.950427 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:48.950427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:06:48.981676 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:06:48.981676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37F80F590>]}
[0m17:06:48.981676 [debug] [MainThread]: On master: ROLLBACK
[0m17:06:48.981676 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:48.981676 [debug] [MainThread]: On master: BEGIN
[0m17:06:48.981676 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:06:48.981676 [debug] [MainThread]: On master: COMMIT
[0m17:06:48.981676 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:48.981676 [debug] [MainThread]: On master: COMMIT
[0m17:06:48.981676 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:06:48.981676 [debug] [MainThread]: On master: Close
[0m17:06:48.981676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:48.981676 [info ] [MainThread]: 
[0m17:06:48.997271 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m17:06:48.997271 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m17:06:49.004907 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m17:06:49.004907 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m17:06:49.008916 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m17:06:49.010917 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 17:06:49.005948 => 17:06:49.009952
[0m17:06:49.010917 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m17:06:49.081951 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:06:49.082951 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp170649047971"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 14:06:48' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m17:06:49.083916 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:49.261812 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:06:49.261812 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:06:49.261812 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m17:06:49.261812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:06:49.261812 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:06:49.261812 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp170649047971'
        
      order by ordinal_position

  
[0m17:06:49.295065 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:06:49.295065 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:06:49.295065 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:06:49.295065 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:06:49.310741 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:06:49.310741 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:06:49.310741 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:06:49.341992 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m17:06:49.341992 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:06:49.341992 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp170649047971"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp170649047971"
    )
  
[0m17:06:49.341992 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m17:06:49.367084 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:06:49.368086 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m17:06:49.369378 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:06:49.370391 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:06:49.371390 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:06:49.371390 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:06:49.373714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:06:49.374724 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 17:06:49.011914 => 17:06:49.374724
[0m17:06:49.375766 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m17:06:49.376727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37EFC7450>]}
[0m17:06:49.377726 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.38s]
[0m17:06:49.379726 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m17:06:49.379726 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m17:06:49.380727 [info ] [Thread-1 (]: 2 of 4 START sql table model flights_wh.dim_airport ............................ [RUN]
[0m17:06:49.382724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m17:06:49.382724 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m17:06:49.385759 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m17:06:49.387667 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 17:06:49.383727 => 17:06:49.386760
[0m17:06:49.387667 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m17:06:49.387667 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m17:06:49.387667 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:06:49.402678 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m17:06:49.402678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:49.453201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:06:49.453201 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:06:49.454202 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp"
  
  
    as
  
  (
    

select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 14:06:48' as run_time
from stg.airports_data
  );
  
[0m17:06:49.466047 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:06:49.473084 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:06:49.473084 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport" rename to "dim_airport__dbt_backup"
[0m17:06:49.474048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:06:49.477082 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:06:49.478046 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
alter table "flights_dbt_course"."flights_wh"."dim_airport__dbt_tmp" rename to "dim_airport"
[0m17:06:49.479048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:06:49.486090 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:06:49.487425 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:06:49.487425 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:06:49.487425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:06:49.487425 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:06:49.487425 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */
drop table if exists "flights_dbt_course"."flights_wh"."dim_airport__dbt_backup" cascade
[0m17:06:49.487425 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:06:49.487425 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 17:06:49.387667 => 17:06:49.487425
[0m17:06:49.487425 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m17:06:49.487425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37ECFE350>]}
[0m17:06:49.503052 [info ] [Thread-1 (]: 2 of 4 OK created sql table model flights_wh.dim_airport ....................... [[32mSELECT 104[0m in 0.11s]
[0m17:06:49.503052 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m17:06:49.503052 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m17:06:49.503052 [info ] [Thread-1 (]: 3 of 4 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m17:06:49.503052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m17:06:49.503052 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m17:06:49.503052 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m17:06:49.503052 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 17:06:49.503052 => 17:06:49.503052
[0m17:06:49.503052 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m17:06:49.536125 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m17:06:49.538092 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:06:49.539095 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m17:06:49.540164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:49.590820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:06:49.591823 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:06:49.592831 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:06:49.600139 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:06:49.603174 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:06:49.603174 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:06:49.604138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:06:49.609171 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:06:49.609171 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:06:49.610138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:06:49.612173 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:06:49.613172 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:06:49.614174 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:06:49.616183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:06:49.619194 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:06:49.619194 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:06:49.621514 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:06:49.623560 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 17:06:49.503052 => 17:06:49.622525
[0m17:06:49.623560 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m17:06:49.624525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37F92BB90>]}
[0m17:06:49.625527 [info ] [Thread-1 (]: 3 of 4 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:06:49.627528 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m17:06:49.628530 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m17:06:49.629526 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:06:49.630526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m17:06:49.630526 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m17:06:49.633561 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m17:06:49.634525 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 17:06:49.631536 => 17:06:49.634525
[0m17:06:49.635524 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m17:06:49.641297 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m17:06:49.643270 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:06:49.644263 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m17:06:49.644263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:49.694746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:06:49.695792 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:06:49.695792 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:06:49.701612 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:06:49.705857 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:06:49.705857 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:06:49.707868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:06:49.710892 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:06:49.710892 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:06:49.711860 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:06:49.714139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:06:49.717151 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:06:49.717151 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:06:49.718151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:06:49.720152 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 17:06:49.635524 => 17:06:49.720152
[0m17:06:49.721152 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m17:06:49.721152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a9259de-1436-4b81-b6be-71e19985d9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37F906150>]}
[0m17:06:49.722152 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m17:06:49.724484 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m17:06:49.725481 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:49.726480 [debug] [MainThread]: On master: BEGIN
[0m17:06:49.726480 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:49.891528 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:06:49.892552 [debug] [MainThread]: On master: COMMIT
[0m17:06:49.892552 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:49.893512 [debug] [MainThread]: On master: COMMIT
[0m17:06:49.893512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:06:49.894510 [debug] [MainThread]: On master: Close
[0m17:06:49.895512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:49.895512 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m17:06:49.896512 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m17:06:49.896512 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m17:06:49.897512 [info ] [MainThread]: 
[0m17:06:49.898510 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 2 view models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m17:06:49.900544 [debug] [MainThread]: Command end result
[0m17:06:49.903843 [info ] [MainThread]: 
[0m17:06:49.903843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:49.903843 [info ] [MainThread]: 
[0m17:06:49.903843 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:06:49.903843 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:49.903843 after 1.48 seconds
[0m17:06:49.903843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B37EEFE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B378A5AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B378A5A210>]}
[0m17:06:49.903843 [debug] [MainThread]: Flushing usage events
[0m17:09:13.381686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9E92AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9E2B66D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9E4CBC10>]}


============================== 17:09:13.397261 | f1e0841e-1595-427d-b7dc-b8bded2fd45f ==============================
[0m17:09:13.397261 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:09:13.397261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:09:13.484394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9E21F750>]}
[0m17:09:13.505395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9B93A1D0>]}
[0m17:09:13.507395 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m17:09:13.518600 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:09:13.588430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:13.590465 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\dim_airport.sql
[0m17:09:13.617470 [debug] [MainThread]: 1603: static parser failed on dimentions\dim_airport.sql
[0m17:09:13.635220 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimentions\dim_airport.sql
[0m17:09:13.681575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9ED8D6D0>]}
[0m17:09:13.681575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9EC7DD90>]}
[0m17:09:13.681575 [info ] [MainThread]: Found 4 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:09:13.681575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9ED73810>]}
[0m17:09:13.681575 [info ] [MainThread]: 
[0m17:09:13.681575 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:13.698510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:09:13.711551 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:09:13.711551 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:09:13.712559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:13.776911 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:09:13.777917 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:09:13.780908 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m17:09:13.786945 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:09:13.787966 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:09:13.788908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:13.832546 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:09:13.832546 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:09:13.833546 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:09:13.839289 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:09:13.839289 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:09:13.839289 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:09:13.850326 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:13.850326 [debug] [MainThread]: On master: BEGIN
[0m17:09:13.850326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:13.897212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:13.897212 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:13.897212 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:13.912838 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:09:13.928505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9E417FD0>]}
[0m17:09:13.928505 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:13.928505 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:13.928505 [debug] [MainThread]: On master: BEGIN
[0m17:09:13.928505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:13.928505 [debug] [MainThread]: On master: COMMIT
[0m17:09:13.928505 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:13.928505 [debug] [MainThread]: On master: COMMIT
[0m17:09:13.928505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:09:13.928505 [debug] [MainThread]: On master: Close
[0m17:09:13.928505 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:13.928505 [info ] [MainThread]: 
[0m17:09:13.928505 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m17:09:13.944087 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m17:09:13.946435 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m17:09:13.946435 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m17:09:13.950437 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m17:09:13.951700 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 17:09:13.947461 => 17:09:13.951585
[0m17:09:13.953719 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m17:09:14.031707 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:09:14.032734 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp170913989710"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 14:09:13' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m17:09:14.032734 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:09:14.101008 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:09:14.108006 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:09:14.109007 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m17:09:14.110003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:14.110003 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:09:14.111002 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp170913989710'
        
      order by ordinal_position

  
[0m17:09:14.118426 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:09:14.134096 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:09:14.134096 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:09:14.134096 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:09:14.134096 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:09:14.134096 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:09:14.149724 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:09:14.165354 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m17:09:14.165354 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:09:14.165354 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp170913989710"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp170913989710"
    )
  
[0m17:09:14.165354 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m17:09:14.196597 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:09:14.196597 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m17:09:14.196597 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:09:14.196597 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:09:14.196597 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:09:14.196597 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:09:14.196597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:14.196597 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 17:09:13.953719 => 17:09:14.196597
[0m17:09:14.196597 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m17:09:14.196597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9ED5C8D0>]}
[0m17:09:14.196597 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.25s]
[0m17:09:14.196597 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m17:09:14.212181 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m17:09:14.212181 [info ] [Thread-1 (]: 2 of 4 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m17:09:14.212181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m17:09:14.212181 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m17:09:14.212181 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m17:09:14.212181 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 17:09:14.212181 => 17:09:14.212181
[0m17:09:14.212181 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m17:09:14.212181 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:09:14.212181 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp170914212181"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 14:09:13' as run_time
from stg.airports_data
  );
  
  
[0m17:09:14.227850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:14.413142 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:09:14.413142 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:09:14.413142 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m17:09:14.413142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:14.413142 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:09:14.413142 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp170914212181'
        
      order by ordinal_position

  
[0m17:09:14.428769 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:09:14.444434 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:09:14.444434 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:09:14.444434 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:09:14.444434 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:09:14.444434 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:09:14.444434 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:09:14.460059 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m17:09:14.460059 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:09:14.460059 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp170914212181"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp170914212181"
    )
  
[0m17:09:14.460059 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m17:09:14.460059 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:09:14.460059 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m17:09:14.460059 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:09:14.460059 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:09:14.460059 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:09:14.460059 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:09:14.475694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:14.475694 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 17:09:14.212181 => 17:09:14.475694
[0m17:09:14.475694 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m17:09:14.475694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9E92AE50>]}
[0m17:09:14.475694 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.26s]
[0m17:09:14.475694 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m17:09:14.475694 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m17:09:14.475694 [info ] [Thread-1 (]: 3 of 4 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m17:09:14.475694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m17:09:14.475694 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m17:09:14.475694 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m17:09:14.475694 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 17:09:14.475694 => 17:09:14.475694
[0m17:09:14.491270 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m17:09:14.513411 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m17:09:14.515373 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:09:14.515373 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m17:09:14.516412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:14.567089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:14.568090 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:09:14.568090 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:09:14.575118 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:14.581135 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:09:14.582127 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:09:14.583088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:14.588126 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:09:14.588126 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:09:14.589128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:14.593130 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:09:14.594129 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:09:14.595130 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:09:14.597588 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:14.601169 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:09:14.601169 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:09:14.601169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:14.601169 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 17:09:14.492367 => 17:09:14.601169
[0m17:09:14.601169 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m17:09:14.601169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9EE61290>]}
[0m17:09:14.601169 [info ] [Thread-1 (]: 3 of 4 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.13s]
[0m17:09:14.601169 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m17:09:14.601169 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m17:09:14.601169 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:09:14.601169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m17:09:14.601169 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m17:09:14.616714 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m17:09:14.616714 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 17:09:14.601169 => 17:09:14.616714
[0m17:09:14.616714 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m17:09:14.616714 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m17:09:14.616714 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:09:14.616714 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m17:09:14.616714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:14.677039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:09:14.677039 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:09:14.678036 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:09:14.684532 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:14.688568 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:09:14.689581 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:09:14.690535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:14.692569 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:09:14.693567 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:09:14.693567 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:09:14.695533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:14.697568 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:09:14.698567 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:09:14.699533 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:14.701534 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 17:09:14.616714 => 17:09:14.700567
[0m17:09:14.701534 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m17:09:14.704546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1e0841e-1595-427d-b7dc-b8bded2fd45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9EE7BE50>]}
[0m17:09:14.705536 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m17:09:14.708552 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m17:09:14.710532 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:14.710532 [debug] [MainThread]: On master: BEGIN
[0m17:09:14.711533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:14.758086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:14.759111 [debug] [MainThread]: On master: COMMIT
[0m17:09:14.760115 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:14.760115 [debug] [MainThread]: On master: COMMIT
[0m17:09:14.761074 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:09:14.762071 [debug] [MainThread]: On master: Close
[0m17:09:14.763073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:14.763073 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m17:09:14.764073 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m17:09:14.764073 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m17:09:14.765073 [info ] [MainThread]: 
[0m17:09:14.766075 [info ] [MainThread]: Finished running 2 incremental models, 2 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m17:09:14.767073 [debug] [MainThread]: Command end result
[0m17:09:14.777169 [info ] [MainThread]: 
[0m17:09:14.778207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:14.779188 [info ] [MainThread]: 
[0m17:09:14.779783 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:09:14.780795 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:14.780795 after 1.40 seconds
[0m17:09:14.781825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9E417D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E97FAB310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9E92AE50>]}
[0m17:09:14.781825 [debug] [MainThread]: Flushing usage events
[0m17:18:23.907454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C39FF5EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A1FC6BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A01C20D0>]}


============================== 17:18:23.907454 | 84dec249-537b-4f4f-aced-eedb550942e0 ==============================
[0m17:18:23.907454 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:18:23.907454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:18:23.998242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A2738910>]}
[0m17:18:24.018282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A2738810>]}
[0m17:18:24.019245 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m17:18:24.031505 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:18:24.052807 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:18:24.053804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A207FAD0>]}
[0m17:18:24.722333 [debug] [MainThread]: 1603: static parser failed on dimentions\dim_aircraft.sql
[0m17:18:24.737960 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimentions\dim_aircraft.sql
[0m17:18:24.737960 [debug] [MainThread]: 1603: static parser failed on dimentions\dim_airport.sql
[0m17:18:24.753583 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimentions\dim_airport.sql
[0m17:18:24.753583 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m17:18:24.753583 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m17:18:24.769208 [debug] [MainThread]: 1699: static parser successfully parsed facts\fact_flights.sql
[0m17:18:24.863002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A2013C10>]}
[0m17:18:24.878588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A29D6490>]}
[0m17:18:24.878588 [info ] [MainThread]: Found 5 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:18:24.878588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A22FBAD0>]}
[0m17:18:24.878588 [info ] [MainThread]: 
[0m17:18:24.878588 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:18:24.878588 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:18:24.899023 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:18:24.900029 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:18:24.901030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:24.957776 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:18:24.959780 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:18:24.961776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m17:18:24.969815 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:18:24.970811 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:18:24.970811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:25.014051 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:18:25.014051 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:18:25.014051 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:18:25.014051 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:18:25.014051 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:18:25.014051 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:18:25.029713 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:25.029713 [debug] [MainThread]: On master: BEGIN
[0m17:18:25.029713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:25.239365 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:25.239365 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:25.239365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:18:25.270613 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:18:25.270613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A2AC4310>]}
[0m17:18:25.270613 [debug] [MainThread]: On master: ROLLBACK
[0m17:18:25.270613 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:25.270613 [debug] [MainThread]: On master: BEGIN
[0m17:18:25.270613 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:25.270613 [debug] [MainThread]: On master: COMMIT
[0m17:18:25.270613 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:25.270613 [debug] [MainThread]: On master: COMMIT
[0m17:18:25.270613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:18:25.270613 [debug] [MainThread]: On master: Close
[0m17:18:25.270613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:25.270613 [info ] [MainThread]: 
[0m17:18:25.286249 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m17:18:25.286249 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m17:18:25.289924 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m17:18:25.289924 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m17:18:25.293932 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m17:18:25.294932 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 17:18:25.290954 => 17:18:25.294932
[0m17:18:25.295935 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m17:18:25.369973 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:18:25.370944 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp171825334967"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 14:18:23' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m17:18:25.370944 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:18:25.428699 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:18:25.428699 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:18:25.428699 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m17:18:25.428699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:25.428699 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:18:25.428699 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp171825334967'
        
      order by ordinal_position

  
[0m17:18:25.459958 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:18:25.459958 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:18:25.459958 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:18:25.459958 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:18:25.475626 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:18:25.475626 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:18:25.475626 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:18:25.491256 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m17:18:25.491256 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:18:25.491256 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp171825334967"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp171825334967"
    )
  
[0m17:18:25.506839 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m17:18:25.522505 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:18:25.522505 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m17:18:25.522505 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:18:25.522505 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:18:25.522505 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:18:25.522505 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:18:25.522505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:18:25.538089 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 17:18:25.295935 => 17:18:25.538089
[0m17:18:25.538089 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m17:18:25.538089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A2AB4A90>]}
[0m17:18:25.538089 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.25s]
[0m17:18:25.538089 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m17:18:25.538089 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m17:18:25.538089 [info ] [Thread-1 (]: 2 of 4 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m17:18:25.538089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m17:18:25.538089 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m17:18:25.538089 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m17:18:25.538089 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 17:18:25.538089 => 17:18:25.538089
[0m17:18:25.538089 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m17:18:25.559866 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:18:25.559866 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp171825555901"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 14:18:23' as run_time
from stg.airports_data
  );
  
  
[0m17:18:25.560902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:25.757857 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:18:25.757857 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:18:25.757857 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m17:18:25.757857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:25.757857 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:18:25.757857 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp171825555901'
        
      order by ordinal_position

  
[0m17:18:25.773492 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:18:25.789158 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:18:25.789158 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:18:25.789158 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:18:25.789158 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:18:25.789158 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:18:25.789158 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:18:25.804788 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m17:18:25.804788 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:18:25.804788 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp171825555901"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp171825555901"
    )
  
[0m17:18:25.804788 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m17:18:25.804788 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:18:25.804788 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m17:18:25.804788 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:18:25.804788 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:18:25.804788 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:18:25.804788 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:18:25.820414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:18:25.820414 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 17:18:25.538089 => 17:18:25.820414
[0m17:18:25.820414 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m17:18:25.820414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A2C33650>]}
[0m17:18:25.820414 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.28s]
[0m17:18:25.820414 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m17:18:25.820414 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m17:18:25.820414 [info ] [Thread-1 (]: 3 of 4 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m17:18:25.820414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.my_first_dbt_model)
[0m17:18:25.820414 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m17:18:25.820414 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m17:18:25.836031 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 17:18:25.820414 => 17:18:25.836031
[0m17:18:25.837199 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m17:18:25.860242 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m17:18:25.861208 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:18:25.861208 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m17:18:25.862245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:25.913278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:25.914278 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:18:25.916308 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:18:25.921563 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:18:25.927568 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:18:25.928568 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:18:25.929528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:25.933532 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:18:25.933532 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:18:25.934529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:25.938567 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:18:25.939566 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:18:25.939566 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:18:25.942379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:18:25.946559 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:18:25.946559 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:18:25.946559 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:18:25.946559 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 17:18:25.837199 => 17:18:25.946559
[0m17:18:25.946559 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m17:18:25.946559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A22FB590>]}
[0m17:18:25.946559 [info ] [Thread-1 (]: 3 of 4 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.13s]
[0m17:18:25.946559 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m17:18:25.946559 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m17:18:25.946559 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:18:25.946559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m17:18:25.946559 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m17:18:25.962189 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m17:18:25.962189 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 17:18:25.946559 => 17:18:25.962189
[0m17:18:25.962189 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m17:18:25.962189 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m17:18:25.962189 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:18:25.962189 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m17:18:25.962189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:26.021169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:26.022203 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:18:26.023169 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:18:26.030054 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:18:26.034089 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:18:26.035054 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:18:26.036089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:26.038086 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:18:26.038086 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:18:26.039086 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:18:26.040050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:18:26.043087 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:18:26.044086 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:18:26.044086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:18:26.046086 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 17:18:25.962189 => 17:18:26.046086
[0m17:18:26.047087 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m17:18:26.049071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84dec249-537b-4f4f-aced-eedb550942e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A2C11E50>]}
[0m17:18:26.051052 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m17:18:26.053052 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m17:18:26.055408 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:26.055408 [debug] [MainThread]: On master: BEGIN
[0m17:18:26.055408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:26.101035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:26.102037 [debug] [MainThread]: On master: COMMIT
[0m17:18:26.102037 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:26.103076 [debug] [MainThread]: On master: COMMIT
[0m17:18:26.104037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:18:26.105039 [debug] [MainThread]: On master: Close
[0m17:18:26.106061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:26.107041 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m17:18:26.107041 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m17:18:26.108037 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m17:18:26.108037 [info ] [MainThread]: 
[0m17:18:26.109035 [info ] [MainThread]: Finished running 2 incremental models, 2 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m17:18:26.111073 [debug] [MainThread]: Command end result
[0m17:18:26.121043 [info ] [MainThread]: 
[0m17:18:26.122036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:26.123178 [info ] [MainThread]: 
[0m17:18:26.124190 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:18:26.125188 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:26.125188 after 2.24 seconds
[0m17:18:26.126218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C39FF5F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A1DB7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A1FE6810>]}
[0m17:18:26.126218 [debug] [MainThread]: Flushing usage events
[0m17:30:12.373422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E94E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E333550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E67BC90>]}


============================== 17:30:12.373422 | cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f ==============================
[0m17:30:12.373422 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:30:12.373422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:30:12.463829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E5B9850>]}
[0m17:30:12.485831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E60FDD0>]}
[0m17:30:12.487815 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m17:30:12.500619 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:30:12.571650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:30:12.572627 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\facts\schema.yml
[0m17:30:12.572627 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\facts\fact_flights.sql
[0m17:30:12.597293 [debug] [MainThread]: 1699: static parser successfully parsed facts\fact_flights.sql
[0m17:30:12.643656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E896B10>]}
[0m17:30:12.659287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2F0B4BD0>]}
[0m17:30:12.659287 [info ] [MainThread]: Found 5 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:30:12.659287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2AD48710>]}
[0m17:30:12.659287 [info ] [MainThread]: 
[0m17:30:12.659287 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:12.659287 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:30:12.687964 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:30:12.687964 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:30:12.688976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:12.860044 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:30:12.860044 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:30:12.860044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m17:30:12.875646 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:30:12.875646 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:30:12.875646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:12.922510 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:30:12.922510 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:30:12.922510 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:30:12.922510 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:30:12.922510 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:30:12.922510 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:30:12.938134 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:12.938134 [debug] [MainThread]: On master: BEGIN
[0m17:30:12.938134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:12.985045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:30:12.985045 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:12.985045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:30:13.016296 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:30:13.016296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DEC8650>]}
[0m17:30:13.016296 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:13.016296 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:13.016296 [debug] [MainThread]: On master: BEGIN
[0m17:30:13.016296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:30:13.016296 [debug] [MainThread]: On master: COMMIT
[0m17:30:13.016296 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:13.016296 [debug] [MainThread]: On master: COMMIT
[0m17:30:13.016296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:30:13.016296 [debug] [MainThread]: On master: Close
[0m17:30:13.016296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:13.016296 [info ] [MainThread]: 
[0m17:30:13.033199 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m17:30:13.034213 [info ] [Thread-1 (]: 1 of 5 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m17:30:13.035214 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m17:30:13.036211 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m17:30:13.040216 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m17:30:13.042211 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 17:30:13.036211 => 17:30:13.041216
[0m17:30:13.043212 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m17:30:13.110242 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:13.110242 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp173013076215"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 14:30:12' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m17:30:13.111214 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:30:13.164495 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:30:13.178198 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:13.180209 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m17:30:13.180209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:13.180209 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:13.180209 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp173013076215'
        
      order by ordinal_position

  
[0m17:30:13.195847 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:13.195847 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:13.195847 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:30:13.195847 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:13.211472 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:13.211472 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:30:13.211472 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:13.227099 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m17:30:13.242722 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:13.242722 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp173013076215"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp173013076215"
    )
  
[0m17:30:13.242722 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m17:30:13.258349 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:13.258349 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m17:30:13.258349 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:30:13.258349 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:30:13.258349 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:13.258349 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:30:13.274022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:13.274022 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 17:30:13.043212 => 17:30:13.274022
[0m17:30:13.274022 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m17:30:13.274022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2F161C50>]}
[0m17:30:13.274022 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.24s]
[0m17:30:13.274022 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m17:30:13.274022 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m17:30:13.274022 [info ] [Thread-1 (]: 2 of 5 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m17:30:13.274022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m17:30:13.274022 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m17:30:13.274022 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m17:30:13.290882 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 17:30:13.274022 => 17:30:13.289605
[0m17:30:13.290882 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m17:30:13.298908 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:13.299908 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp173013294896"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 14:30:12' as run_time
from stg.airports_data
  );
  
  
[0m17:30:13.301909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:13.359598 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:30:13.363599 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:13.363599 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m17:30:13.365601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:13.365601 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:13.366598 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp173013294896'
        
      order by ordinal_position

  
[0m17:30:13.383585 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:13.387617 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:13.387617 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:30:13.392586 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:13.395623 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:13.395623 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:30:13.396726 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:13.396726 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m17:30:13.396726 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:13.396726 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp173013294896"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp173013294896"
    )
  
[0m17:30:13.396726 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m17:30:13.412395 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:13.412395 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m17:30:13.412395 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:30:13.412395 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:30:13.412395 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:13.412395 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:30:13.412395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:13.412395 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 17:30:13.291899 => 17:30:13.412395
[0m17:30:13.412395 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m17:30:13.412395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2F04EED0>]}
[0m17:30:13.412395 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.14s]
[0m17:30:13.412395 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m17:30:13.412395 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m17:30:13.412395 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m17:30:13.427979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_flights)
[0m17:30:13.427979 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m17:30:13.427979 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m17:30:13.427979 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 17:30:13.427979 => 17:30:13.427979
[0m17:30:13.427979 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m17:30:13.447172 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m17:30:13.449139 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:30:13.450144 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m17:30:13.451152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:13.503169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:13.504168 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:30:13.504168 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    
  );
  
[0m17:30:13.505298 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 13:   );
           ^

[0m17:30:13.505298 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: ROLLBACK
[0m17:30:13.506309 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 17:30:13.427979 => 17:30:13.506309
[0m17:30:13.507312 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m17:30:13.512346 [debug] [Thread-1 (]: Database Error in model fact_flights (models\facts\fact_flights.sql)
  syntax error at or near ")"
  LINE 13:   );
             ^
  compiled Code at target\run\flight_dbt\models\facts\fact_flights.sql
[0m17:30:13.513309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2F161D50>]}
[0m17:30:13.514309 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model flights_wh.fact_flights .................. [[31mERROR[0m in 0.09s]
[0m17:30:13.516332 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m17:30:13.517311 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m17:30:13.517311 [info ] [Thread-1 (]: 4 of 5 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m17:30:13.519314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.my_first_dbt_model)
[0m17:30:13.520343 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m17:30:13.523347 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m17:30:13.524311 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 17:30:13.520343 => 17:30:13.524311
[0m17:30:13.525344 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m17:30:13.549355 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m17:30:13.551317 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:13.552316 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m17:30:13.552316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:13.601308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:13.602350 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:13.602350 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:30:13.608531 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:30:13.614533 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:13.615532 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:30:13.616495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:13.619533 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:13.620517 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:30:13.621538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:13.625535 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:30:13.626533 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:13.626533 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:30:13.628752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:13.629860 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:13.629860 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:30:13.629860 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:30:13.629860 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 17:30:13.525344 => 17:30:13.629860
[0m17:30:13.645483 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m17:30:13.645483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2F243410>]}
[0m17:30:13.645483 [info ] [Thread-1 (]: 4 of 5 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.13s]
[0m17:30:13.645483 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m17:30:13.645483 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m17:30:13.645483 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:30:13.645483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m17:30:13.645483 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m17:30:13.645483 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m17:30:13.645483 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 17:30:13.645483 => 17:30:13.645483
[0m17:30:13.645483 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m17:30:13.663305 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m17:30:13.664334 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:13.665303 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m17:30:13.666311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:13.716992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:13.716992 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:13.719031 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:30:13.723989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:30:13.727028 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:13.727028 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:30:13.727989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:13.729991 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:30:13.730990 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:13.731993 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:30:13.733990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:13.737026 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:13.738024 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:30:13.738989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:30:13.740041 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 17:30:13.645483 => 17:30:13.740041
[0m17:30:13.741025 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m17:30:13.741989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf409e1b-341d-45d4-a9fd-0ae4e6b1ec2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2F633BD0>]}
[0m17:30:13.742991 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m17:30:13.744995 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m17:30:13.745992 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:13.747026 [debug] [MainThread]: On master: BEGIN
[0m17:30:13.747026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:13.912011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:30:13.912011 [debug] [MainThread]: On master: COMMIT
[0m17:30:13.912011 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:13.912011 [debug] [MainThread]: On master: COMMIT
[0m17:30:13.912011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:30:13.912011 [debug] [MainThread]: On master: Close
[0m17:30:13.912011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:13.912011 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m17:30:13.912011 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m17:30:13.912011 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m17:30:13.912011 [info ] [MainThread]: 
[0m17:30:13.912011 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 2 view models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m17:30:13.912011 [debug] [MainThread]: Command end result
[0m17:30:13.927598 [info ] [MainThread]: 
[0m17:30:13.927598 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:30:13.935493 [info ] [MainThread]: 
[0m17:30:13.936517 [error] [MainThread]: [33mDatabase Error in model fact_flights (models\facts\fact_flights.sql)[0m
[0m17:30:13.937513 [error] [MainThread]:   syntax error at or near ")"
[0m17:30:13.938503 [error] [MainThread]:   LINE 13:   );
[0m17:30:13.939508 [error] [MainThread]:              ^
[0m17:30:13.940506 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\facts\fact_flights.sql
[0m17:30:13.941509 [info ] [MainThread]: 
[0m17:30:13.942507 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:30:13.945503 [debug] [MainThread]: Command `dbt run` failed at 17:30:13.944511 after 1.59 seconds
[0m17:30:13.945503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2AD48590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2E5DB350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2C53F810>]}
[0m17:30:13.947502 [debug] [MainThread]: Flushing usage events
[0m17:30:46.776274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188418AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021884051690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021883E39DD0>]}


============================== 17:30:46.776274 | 7f006d1a-3a39-425f-97fd-ad1a532779c7 ==============================
[0m17:30:46.776274 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:30:46.776274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:30:46.867727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021883D2B190>]}
[0m17:30:46.889725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218811DA1D0>]}
[0m17:30:46.891420 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m17:30:46.903409 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:30:46.970297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:46.972305 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\facts\fact_flights.sql
[0m17:30:46.998293 [debug] [MainThread]: 1699: static parser successfully parsed facts\fact_flights.sql
[0m17:30:47.049652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021883A6CC10>]}
[0m17:30:47.065279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218844D9D90>]}
[0m17:30:47.065279 [info ] [MainThread]: Found 5 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:30:47.065279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021880218710>]}
[0m17:30:47.065279 [info ] [MainThread]: 
[0m17:30:47.065279 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:47.065279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:30:47.085694 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:30:47.086698 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:30:47.087694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:47.152800 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:30:47.155008 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:30:47.158038 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m17:30:47.164016 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:30:47.165017 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:30:47.165690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:47.202124 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:30:47.202124 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:30:47.202124 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:30:47.202124 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:30:47.217755 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:30:47.217755 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:30:47.217755 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:47.217755 [debug] [MainThread]: On master: BEGIN
[0m17:30:47.217755 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:47.264662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:30:47.264662 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:47.264662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:30:47.295919 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:30:47.295919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021883DC4310>]}
[0m17:30:47.295919 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:47.295919 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:47.295919 [debug] [MainThread]: On master: BEGIN
[0m17:30:47.295919 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:30:47.295919 [debug] [MainThread]: On master: COMMIT
[0m17:30:47.295919 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:47.295919 [debug] [MainThread]: On master: COMMIT
[0m17:30:47.295919 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:30:47.295919 [debug] [MainThread]: On master: Close
[0m17:30:47.295919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:47.295919 [info ] [MainThread]: 
[0m17:30:47.311524 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m17:30:47.312908 [info ] [Thread-1 (]: 1 of 5 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m17:30:47.313921 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m17:30:47.314954 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m17:30:47.318921 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m17:30:47.321928 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 17:30:47.314954 => 17:30:47.320948
[0m17:30:47.322924 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m17:30:47.400917 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:47.400917 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp173047363916"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 14:30:46' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m17:30:47.401917 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:30:47.450974 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:30:47.466589 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:47.466589 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m17:30:47.466589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:47.466589 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:47.466589 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp173047363916'
        
      order by ordinal_position

  
[0m17:30:47.482222 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:47.482222 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:47.482222 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:30:47.482222 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:47.497841 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:47.497841 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:30:47.497841 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:47.526008 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m17:30:47.526008 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:47.526008 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp173047363916"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp173047363916"
    )
  
[0m17:30:47.546652 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m17:30:47.565657 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:47.566665 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m17:30:47.568620 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:30:47.569873 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:30:47.569873 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:30:47.569873 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:30:47.569873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:47.569873 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 17:30:47.322924 => 17:30:47.569873
[0m17:30:47.569873 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m17:30:47.569873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218845D1710>]}
[0m17:30:47.569873 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.26s]
[0m17:30:47.569873 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m17:30:47.569873 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m17:30:47.569873 [info ] [Thread-1 (]: 2 of 5 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m17:30:47.569873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m17:30:47.569873 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m17:30:47.589653 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m17:30:47.591660 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 17:30:47.569873 => 17:30:47.590652
[0m17:30:47.592656 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m17:30:47.600689 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:47.601654 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp173047597656"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 14:30:46' as run_time
from stg.airports_data
  );
  
  
[0m17:30:47.602690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:47.662987 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:30:47.667022 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:47.667022 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m17:30:47.667989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:47.668992 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:47.668992 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp173047597656'
        
      order by ordinal_position

  
[0m17:30:47.687590 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:47.691621 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:47.691621 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:30:47.695589 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:47.698630 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:47.699630 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:30:47.701810 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:30:47.701810 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m17:30:47.701810 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:47.701810 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp173047597656"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp173047597656"
    )
  
[0m17:30:47.712538 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m17:30:47.715549 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:47.715549 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m17:30:47.716550 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:30:47.717550 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:30:47.718549 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:30:47.718549 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:30:47.720943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:47.721814 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 17:30:47.593654 => 17:30:47.721814
[0m17:30:47.722804 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m17:30:47.723766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218845B4D50>]}
[0m17:30:47.724766 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.15s]
[0m17:30:47.725769 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m17:30:47.726770 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m17:30:47.727770 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m17:30:47.728770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_flights)
[0m17:30:47.729770 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m17:30:47.732800 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m17:30:47.733764 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 17:30:47.729770 => 17:30:47.733764
[0m17:30:47.734765 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m17:30:47.737043 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m17:30:47.737043 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:30:47.737043 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m17:30:47.737043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:47.803462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:47.803462 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:30:47.804463 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

select *
from stg.flights
  );
  
[0m17:30:47.858313 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m17:30:47.865312 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:30:47.866360 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m17:30:47.867312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:47.868231 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m17:30:47.868231 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:30:47.868231 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m17:30:47.868231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:47.883286 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:30:47.883286 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m17:30:47.883286 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:30:47.883286 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 17:30:47.734765 => 17:30:47.883286
[0m17:30:47.883286 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m17:30:47.883286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218846BB010>]}
[0m17:30:47.883286 [info ] [Thread-1 (]: 3 of 5 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.15s]
[0m17:30:47.883286 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m17:30:47.883286 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m17:30:47.883286 [info ] [Thread-1 (]: 4 of 5 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m17:30:47.898922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.my_first_dbt_model)
[0m17:30:47.898922 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m17:30:47.898922 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m17:30:47.898922 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 17:30:47.898922 => 17:30:47.898922
[0m17:30:47.898922 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m17:30:47.926362 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m17:30:47.927326 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:47.928329 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m17:30:47.929320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:47.979509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:47.979509 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:47.980473 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:30:47.987086 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:30:47.993121 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:47.993121 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:30:47.994124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:47.997119 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:47.998123 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:30:47.999049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:48.003061 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:30:48.003061 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:48.004060 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:30:48.006246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:48.009298 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:30:48.010281 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:30:48.011283 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:30:48.013285 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 17:30:47.898922 => 17:30:48.013285
[0m17:30:48.014245 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m17:30:48.015246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218846BBB90>]}
[0m17:30:48.016246 [info ] [Thread-1 (]: 4 of 5 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:30:48.017246 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m17:30:48.019248 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m17:30:48.020283 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:30:48.021246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m17:30:48.021246 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m17:30:48.025252 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m17:30:48.026251 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 17:30:48.022284 => 17:30:48.026251
[0m17:30:48.027251 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m17:30:48.031245 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m17:30:48.032246 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:48.033247 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m17:30:48.033247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:48.083338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:30:48.084337 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:48.084337 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:30:48.093271 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:30:48.096306 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:48.096306 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:30:48.097269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:30:48.099318 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:30:48.100305 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:48.100305 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:30:48.102271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:30:48.105317 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:30:48.106304 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:30:48.107271 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:30:48.108316 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 17:30:48.027251 => 17:30:48.108316
[0m17:30:48.109305 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m17:30:48.110270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f006d1a-3a39-425f-97fd-ad1a532779c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188468EB10>]}
[0m17:30:48.111273 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m17:30:48.112276 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m17:30:48.114270 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:48.115271 [debug] [MainThread]: On master: BEGIN
[0m17:30:48.115271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:48.161159 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:30:48.162206 [debug] [MainThread]: On master: COMMIT
[0m17:30:48.163160 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:48.164184 [debug] [MainThread]: On master: COMMIT
[0m17:30:48.164184 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:30:48.165161 [debug] [MainThread]: On master: Close
[0m17:30:48.165161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:48.166161 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m17:30:48.167160 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m17:30:48.167160 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m17:30:48.168160 [info ] [MainThread]: 
[0m17:30:48.169162 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 2 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m17:30:48.172198 [debug] [MainThread]: Command end result
[0m17:30:48.180159 [info ] [MainThread]: 
[0m17:30:48.181163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:48.182547 [info ] [MainThread]: 
[0m17:30:48.183559 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:30:48.184562 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:48.184562 after 1.42 seconds
[0m17:30:48.185566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021883DC4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218838CB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021883ADF210>]}
[0m17:30:48.185566 [debug] [MainThread]: Flushing usage events
[0m17:56:37.389954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9463EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C93ED9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9426FC50>]}


============================== 17:56:37.389954 | 84158634-2ea8-407b-9875-e9fe1eb5ceb6 ==============================
[0m17:56:37.389954 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:56:37.389954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:56:37.484100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9463E9D0>]}
[0m17:56:37.501100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C948CD2D0>]}
[0m17:56:37.503105 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m17:56:37.516107 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:56:37.592718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:37.593720 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\facts\fact_flights.sql
[0m17:56:37.618721 [debug] [MainThread]: 1699: static parser successfully parsed facts\fact_flights.sql
[0m17:56:37.670924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C94655510>]}
[0m17:56:37.686557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C94978110>]}
[0m17:56:37.686557 [info ] [MainThread]: Found 5 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:56:37.686557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C90668710>]}
[0m17:56:37.686557 [info ] [MainThread]: 
[0m17:56:37.686557 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:56:37.686557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:56:37.711365 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:56:37.711365 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:56:37.712283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:37.906164 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:56:37.906164 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:56:37.906164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m17:56:37.906164 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:56:37.906164 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:56:37.906164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:37.968664 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:56:37.968664 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:56:37.968664 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:56:37.968664 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:56:37.968664 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:56:37.968664 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:56:37.984290 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:37.984290 [debug] [MainThread]: On master: BEGIN
[0m17:56:37.984290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:38.031182 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:38.031182 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:38.031182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:56:38.062416 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:56:38.062416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C94951290>]}
[0m17:56:38.062416 [debug] [MainThread]: On master: ROLLBACK
[0m17:56:38.062416 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:38.062416 [debug] [MainThread]: On master: BEGIN
[0m17:56:38.062416 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:38.062416 [debug] [MainThread]: On master: COMMIT
[0m17:56:38.062416 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:38.062416 [debug] [MainThread]: On master: COMMIT
[0m17:56:38.062416 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:56:38.062416 [debug] [MainThread]: On master: Close
[0m17:56:38.062416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:56:38.078048 [info ] [MainThread]: 
[0m17:56:38.078048 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m17:56:38.078048 [info ] [Thread-1 (]: 1 of 5 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m17:56:38.086007 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m17:56:38.086007 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m17:56:38.089908 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m17:56:38.091508 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 17:56:38.086007 => 17:56:38.091508
[0m17:56:38.092504 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m17:56:38.165505 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:56:38.166515 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp175638131507"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 14:56:37' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m17:56:38.167506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:56:38.220915 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:56:38.220915 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:56:38.220915 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m17:56:38.220915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:38.220915 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:56:38.220915 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp175638131507'
        
      order by ordinal_position

  
[0m17:56:38.236561 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:56:38.256502 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:56:38.257016 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:56:38.258659 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:56:38.268213 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:56:38.268213 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:56:38.268213 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:56:38.283905 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m17:56:38.283905 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:56:38.283905 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp175638131507"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp175638131507"
    )
  
[0m17:56:38.299520 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m17:56:38.315142 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:56:38.315142 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m17:56:38.315142 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:56:38.315142 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:56:38.315142 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:56:38.315142 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:56:38.324973 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:56:38.324973 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 17:56:38.094518 => 17:56:38.324973
[0m17:56:38.324973 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m17:56:38.324973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C94934350>]}
[0m17:56:38.324973 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.25s]
[0m17:56:38.330987 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m17:56:38.330987 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m17:56:38.330987 [info ] [Thread-1 (]: 2 of 5 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m17:56:38.330987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m17:56:38.330987 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m17:56:38.330987 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m17:56:38.330987 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 17:56:38.330987 => 17:56:38.330987
[0m17:56:38.330987 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m17:56:38.330987 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:56:38.330987 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp175638330987"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 14:56:37' as run_time
from stg.airports_data
  );
  
  
[0m17:56:38.330987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:38.405404 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:56:38.411483 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:56:38.412472 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m17:56:38.413404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:38.414449 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:56:38.414449 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp175638330987'
        
      order by ordinal_position

  
[0m17:56:38.435673 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:56:38.438692 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:56:38.439692 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:56:38.444043 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:56:38.447054 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:56:38.448053 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:56:38.451884 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:56:38.454894 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m17:56:38.455895 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:56:38.456700 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp175638330987"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp175638330987"
    )
  
[0m17:56:38.456700 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m17:56:38.456700 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:56:38.456700 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m17:56:38.456700 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:56:38.456700 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:56:38.456700 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:56:38.456700 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:56:38.456700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:56:38.456700 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 17:56:38.330987 => 17:56:38.456700
[0m17:56:38.456700 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m17:56:38.471711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C949CBC10>]}
[0m17:56:38.471711 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.14s]
[0m17:56:38.471711 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m17:56:38.471711 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m17:56:38.471711 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m17:56:38.471711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_flights)
[0m17:56:38.471711 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m17:56:38.471711 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m17:56:38.471711 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 17:56:38.471711 => 17:56:38.471711
[0m17:56:38.471711 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m17:56:38.497637 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m17:56:38.499665 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:56:38.499665 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m17:56:38.500628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:38.669355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:38.669355 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:56:38.669355 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *
from cte2
  );
  
[0m17:56:38.956388 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m17:56:38.971445 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:56:38.971445 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m17:56:38.971445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:56:38.971445 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:56:38.971445 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m17:56:38.971445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:56:38.987125 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m17:56:38.987125 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:56:38.987125 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m17:56:38.987125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:56:39.002750 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:56:39.002750 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m17:56:39.002750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:56:39.002750 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 17:56:38.471711 => 17:56:39.002750
[0m17:56:39.002750 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m17:56:39.002750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C94B7B2D0>]}
[0m17:56:39.002750 [info ] [Thread-1 (]: 3 of 5 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.53s]
[0m17:56:39.002750 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m17:56:39.002750 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m17:56:39.002750 [info ] [Thread-1 (]: 4 of 5 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m17:56:39.018329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.my_first_dbt_model)
[0m17:56:39.018329 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m17:56:39.018329 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m17:56:39.018329 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 17:56:39.018329 => 17:56:39.018329
[0m17:56:39.018329 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m17:56:39.044456 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m17:56:39.045396 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:56:39.046393 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m17:56:39.046393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:39.097006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:39.097006 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:56:39.098037 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:56:39.104043 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:56:39.107424 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:56:39.109422 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:56:39.110383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:56:39.114381 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:56:39.114381 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:56:39.115383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:56:39.118416 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:56:39.118416 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:56:39.119386 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:56:39.120645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:56:39.123661 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:56:39.124660 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:56:39.126671 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:56:39.127661 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 17:56:39.018329 => 17:56:39.127661
[0m17:56:39.128660 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m17:56:39.129660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C94B41C90>]}
[0m17:56:39.131662 [info ] [Thread-1 (]: 4 of 5 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.11s]
[0m17:56:39.132659 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m17:56:39.134660 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m17:56:39.134660 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:56:39.136660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m17:56:39.136660 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m17:56:39.139661 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m17:56:39.140663 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 17:56:39.136660 => 17:56:39.140663
[0m17:56:39.140663 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m17:56:39.145660 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m17:56:39.146661 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:56:39.146661 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m17:56:39.147661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:39.196898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:39.197897 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:56:39.197897 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:56:39.204347 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:56:39.207350 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:56:39.208349 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:56:39.210407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:56:39.213377 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:56:39.213377 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:56:39.214373 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:56:39.216375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:56:39.218373 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:56:39.219372 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:56:39.219372 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:56:39.221348 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 17:56:39.141661 => 17:56:39.221348
[0m17:56:39.222347 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m17:56:39.222347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84158634-2ea8-407b-9875-e9fe1eb5ceb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C94B7DF50>]}
[0m17:56:39.223350 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m17:56:39.225350 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m17:56:39.227374 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:39.227374 [debug] [MainThread]: On master: BEGIN
[0m17:56:39.227374 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:39.278422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:39.279422 [debug] [MainThread]: On master: COMMIT
[0m17:56:39.279422 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:39.279422 [debug] [MainThread]: On master: COMMIT
[0m17:56:39.280428 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:56:39.280428 [debug] [MainThread]: On master: Close
[0m17:56:39.281422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:39.282423 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m17:56:39.282423 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m17:56:39.283422 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m17:56:39.283422 [info ] [MainThread]: 
[0m17:56:39.284423 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 2 view models in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m17:56:39.286420 [debug] [MainThread]: Command end result
[0m17:56:39.296420 [info ] [MainThread]: 
[0m17:56:39.297420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:39.298460 [info ] [MainThread]: 
[0m17:56:39.299420 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:56:39.300420 [debug] [MainThread]: Command `dbt run` succeeded at 17:56:39.300420 after 1.92 seconds
[0m17:56:39.301447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C942DF050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C9426FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C8DD2A210>]}
[0m17:56:39.301447 [debug] [MainThread]: Flushing usage events
[0m17:57:10.677469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A863448DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8636F9F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A863670DD0>]}


============================== 17:57:10.677469 | 05dfc9d8-ed90-45b3-b637-8e2e64738551 ==============================
[0m17:57:10.677469 [info ] [MainThread]: Running with dbt=1.5.2
[0m17:57:10.693043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:57:10.775495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A86405BE50>]}
[0m17:57:10.801491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A864074E50>]}
[0m17:57:10.802491 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m17:57:10.814593 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m17:57:10.889388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:10.890391 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\facts\fact_flights.sql
[0m17:57:10.917394 [debug] [MainThread]: 1603: static parser failed on facts\fact_flights.sql
[0m17:57:10.929863 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts\fact_flights.sql
[0m17:57:10.976794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8641E7B90>]}
[0m17:57:10.976794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8640E4E10>]}
[0m17:57:10.976794 [info ] [MainThread]: Found 5 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:57:10.976794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A85FDD8710>]}
[0m17:57:10.992368 [info ] [MainThread]: 
[0m17:57:10.992368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:57:10.992368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m17:57:10.992368 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m17:57:11.008039 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:57:11.008039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:11.065457 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:57:11.067461 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m17:57:11.070491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m17:57:11.076487 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:57:11.076487 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m17:57:11.077452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:11.255091 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:57:11.255091 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m17:57:11.255091 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:57:11.270713 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:57:11.270713 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m17:57:11.270713 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m17:57:11.286339 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:11.286339 [debug] [MainThread]: On master: BEGIN
[0m17:57:11.286339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:11.333322 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:57:11.333322 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:11.333322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:57:11.364583 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:57:11.364583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A864093E50>]}
[0m17:57:11.364583 [debug] [MainThread]: On master: ROLLBACK
[0m17:57:11.364583 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:11.364583 [debug] [MainThread]: On master: BEGIN
[0m17:57:11.364583 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:57:11.364583 [debug] [MainThread]: On master: COMMIT
[0m17:57:11.364583 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:11.364583 [debug] [MainThread]: On master: COMMIT
[0m17:57:11.364583 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:57:11.364583 [debug] [MainThread]: On master: Close
[0m17:57:11.364583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:11.364583 [info ] [MainThread]: 
[0m17:57:11.381027 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m17:57:11.381027 [info ] [Thread-1 (]: 1 of 5 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m17:57:11.383037 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m17:57:11.384035 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m17:57:11.388041 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m17:57:11.390037 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 17:57:11.384035 => 17:57:11.390037
[0m17:57:11.391037 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m17:57:11.461034 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:57:11.461034 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp175711424034"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 14:57:10' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m17:57:11.462035 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:11.511573 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:57:11.511573 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:57:11.511573 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m17:57:11.511573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:57:11.511573 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:57:11.511573 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp175711424034'
        
      order by ordinal_position

  
[0m17:57:11.543785 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:57:11.549610 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:57:11.550125 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:57:11.552788 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:57:11.558796 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:57:11.558796 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:57:11.558796 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:57:11.574436 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m17:57:11.574436 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:57:11.574436 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp175711424034"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp175711424034"
    )
  
[0m17:57:11.590098 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m17:57:11.605687 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:57:11.605687 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m17:57:11.605687 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:57:11.605687 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:57:11.605687 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m17:57:11.605687 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m17:57:11.605687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:57:11.605687 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 17:57:11.391037 => 17:57:11.605687
[0m17:57:11.621310 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m17:57:11.621310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A864136350>]}
[0m17:57:11.621310 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.24s]
[0m17:57:11.621310 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m17:57:11.621310 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m17:57:11.621310 [info ] [Thread-1 (]: 2 of 5 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m17:57:11.621310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m17:57:11.621310 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m17:57:11.621310 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m17:57:11.621310 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 17:57:11.621310 => 17:57:11.621310
[0m17:57:11.621310 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m17:57:11.639174 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:57:11.640172 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp175711621310"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 14:57:10' as run_time
from stg.airports_data
  );
  
  
[0m17:57:11.641170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:11.704519 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:57:11.707552 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:57:11.708516 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m17:57:11.709515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:57:11.709515 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:57:11.709515 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp175711621310'
        
      order by ordinal_position

  
[0m17:57:11.727421 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:57:11.731461 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:57:11.731461 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:57:11.735460 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:57:11.739461 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:57:11.739461 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:57:11.743460 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:57:11.745880 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m17:57:11.745880 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:57:11.745880 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp175711621310"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp175711621310"
    )
  
[0m17:57:11.745880 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m17:57:11.745880 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:57:11.745880 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m17:57:11.745880 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m17:57:11.745880 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:57:11.745880 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m17:57:11.745880 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m17:57:11.745880 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:57:11.761534 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 17:57:11.621310 => 17:57:11.761534
[0m17:57:11.761534 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m17:57:11.761534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A863DCF4D0>]}
[0m17:57:11.761534 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.14s]
[0m17:57:11.761534 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m17:57:11.761534 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m17:57:11.761534 [info ] [Thread-1 (]: 3 of 5 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m17:57:11.761534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_flights)
[0m17:57:11.761534 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m17:57:11.761534 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m17:57:11.761534 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 17:57:11.761534 => 17:57:11.761534
[0m17:57:11.761534 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m17:57:11.791637 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m17:57:11.793600 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:57:11.793600 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m17:57:11.794600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:11.845825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:57:11.846828 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:57:11.847830 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-15 14:57:10' as run_time
from cte2
  );
  
[0m17:57:12.132790 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m17:57:12.132790 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:57:12.132790 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m17:57:12.132790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:57:12.148413 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:57:12.148413 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m17:57:12.148413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:57:12.148413 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m17:57:12.148413 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:57:12.148413 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m17:57:12.164039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:57:12.164039 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m17:57:12.164039 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m17:57:12.164039 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:57:12.164039 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 17:57:11.761534 => 17:57:12.164039
[0m17:57:12.164039 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m17:57:12.164039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8642D5710>]}
[0m17:57:12.179663 [info ] [Thread-1 (]: 3 of 5 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.40s]
[0m17:57:12.179663 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m17:57:12.179663 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m17:57:12.179663 [info ] [Thread-1 (]: 4 of 5 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m17:57:12.179663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.my_first_dbt_model)
[0m17:57:12.179663 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m17:57:12.179663 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m17:57:12.179663 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 17:57:12.179663 => 17:57:12.179663
[0m17:57:12.179663 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m17:57:12.210382 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m17:57:12.212349 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:57:12.213352 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m17:57:12.213352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:12.263702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:57:12.263702 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:57:12.264742 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m17:57:12.270649 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:57:12.273694 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:57:12.274688 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:57:12.275667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:57:12.278649 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:57:12.279686 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:57:12.280649 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:57:12.282690 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:57:12.283688 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:57:12.283688 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m17:57:12.286501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:57:12.289539 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m17:57:12.289539 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:57:12.291542 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:57:12.293537 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 17:57:12.179663 => 17:57:12.293537
[0m17:57:12.294497 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m17:57:12.295446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8642DB1D0>]}
[0m17:57:12.295446 [info ] [Thread-1 (]: 4 of 5 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:57:12.295446 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m17:57:12.295446 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m17:57:12.295446 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:57:12.295446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m17:57:12.295446 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m17:57:12.295446 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m17:57:12.295446 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 17:57:12.295446 => 17:57:12.295446
[0m17:57:12.295446 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m17:57:12.310499 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m17:57:12.312296 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:57:12.313313 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m17:57:12.314314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:12.494224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:57:12.494224 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:57:12.494224 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:57:12.494224 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:57:12.494224 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:57:12.494224 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:57:12.494224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:57:12.494224 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:57:12.494224 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:57:12.494224 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m17:57:12.509919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:57:12.509919 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m17:57:12.509919 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:57:12.509919 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:57:12.509919 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 17:57:12.295446 => 17:57:12.509919
[0m17:57:12.509919 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m17:57:12.509919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05dfc9d8-ed90-45b3-b637-8e2e64738551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A863436F90>]}
[0m17:57:12.509919 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.21s]
[0m17:57:12.509919 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m17:57:12.509919 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:12.509919 [debug] [MainThread]: On master: BEGIN
[0m17:57:12.509919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:12.571604 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:57:12.572601 [debug] [MainThread]: On master: COMMIT
[0m17:57:12.572601 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:12.573603 [debug] [MainThread]: On master: COMMIT
[0m17:57:12.573603 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:57:12.574601 [debug] [MainThread]: On master: Close
[0m17:57:12.575602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:12.575602 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m17:57:12.575602 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m17:57:12.576605 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m17:57:12.576605 [info ] [MainThread]: 
[0m17:57:12.577607 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 2 view models in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m17:57:12.580612 [debug] [MainThread]: Command end result
[0m17:57:12.590608 [info ] [MainThread]: 
[0m17:57:12.591603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:12.592288 [info ] [MainThread]: 
[0m17:57:12.593300 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:57:12.594299 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:12.594299 after 1.92 seconds
[0m17:57:12.595299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A863737090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8633BE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A85D49A210>]}
[0m17:57:12.596304 [debug] [MainThread]: Flushing usage events
[0m18:07:17.621531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F0C32C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F0D38990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F0927910>]}


============================== 18:07:17.625533 | 48d326f4-9032-45e9-b4fe-583d4a58a372 ==============================
[0m18:07:17.625533 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:07:17.626532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:07:17.743535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F09561D0>]}
[0m18:07:17.769092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F09561D0>]}
[0m18:07:17.771049 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m18:07:17.786049 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:07:17.895256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:07:17.896259 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\facts\fact_boarding_passes.sql
[0m18:07:17.932263 [debug] [MainThread]: 1699: static parser successfully parsed facts\fact_boarding_passes.sql
[0m18:07:17.961179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F13BA810>]}
[0m18:07:17.976820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F13383D0>]}
[0m18:07:17.976820 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:07:17.976820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6ED0B8710>]}
[0m18:07:17.976820 [info ] [MainThread]: 
[0m18:07:17.992442 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:07:17.992442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:07:18.008070 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:07:18.009879 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:07:18.010897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:18.090889 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:07:18.092926 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:07:18.095890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m18:07:18.101891 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:07:18.102892 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:07:18.103895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:18.144925 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:07:18.144925 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:07:18.144925 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:07:18.160510 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:07:18.160510 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:07:18.160510 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:07:18.160510 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:18.160510 [debug] [MainThread]: On master: BEGIN
[0m18:07:18.160510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:18.227664 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:18.227664 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:18.228667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:18.269830 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:07:18.271827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F02382D0>]}
[0m18:07:18.272825 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:18.273827 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:18.273827 [debug] [MainThread]: On master: BEGIN
[0m18:07:18.274826 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:18.275827 [debug] [MainThread]: On master: COMMIT
[0m18:07:18.275827 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:18.276827 [debug] [MainThread]: On master: COMMIT
[0m18:07:18.277827 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:18.277827 [debug] [MainThread]: On master: Close
[0m18:07:18.278825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:07:18.280828 [info ] [MainThread]: 
[0m18:07:18.290826 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m18:07:18.291826 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m18:07:18.293829 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m18:07:18.293829 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m18:07:18.297835 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m18:07:18.300831 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 18:07:18.294825 => 18:07:18.299836
[0m18:07:18.301835 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m18:07:18.392867 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:07:18.393863 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp180718354825"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 15:07:17' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m18:07:18.394827 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:07:18.443525 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:07:18.459146 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:07:18.459146 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m18:07:18.459146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:07:18.459146 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:07:18.459146 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp180718354825'
        
      order by ordinal_position

  
[0m18:07:18.490396 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:07:18.506078 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:07:18.507041 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:07:18.512500 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:07:18.522015 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:07:18.522015 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:07:18.522015 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:07:18.537661 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m18:07:18.553278 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:07:18.553278 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp180718354825"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp180718354825"
    )
  
[0m18:07:18.553278 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:07:18.568907 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:07:18.568907 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m18:07:18.568907 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m18:07:18.568907 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m18:07:18.568907 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:07:18.584572 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m18:07:18.584572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:07:18.584572 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 18:07:18.302832 => 18:07:18.584572
[0m18:07:18.584572 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m18:07:18.584572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F139FCD0>]}
[0m18:07:18.584572 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.29s]
[0m18:07:18.584572 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m18:07:18.584572 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m18:07:18.584572 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m18:07:18.584572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m18:07:18.584572 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m18:07:18.605372 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m18:07:18.606374 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 18:07:18.600151 => 18:07:18.606374
[0m18:07:18.607380 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m18:07:18.614584 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:07:18.616607 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp180718611370"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 15:07:17' as run_time
from stg.airports_data
  );
  
  
[0m18:07:18.617586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:18.690583 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:07:18.695586 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:07:18.696613 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m18:07:18.697582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:07:18.698582 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:07:18.698582 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp180718611370'
        
      order by ordinal_position

  
[0m18:07:18.717582 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:07:18.722582 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:07:18.722582 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:07:18.727582 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:07:18.728750 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:07:18.728750 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:07:18.728750 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:07:18.728750 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m18:07:18.728750 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:07:18.728750 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp180718611370"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp180718611370"
    )
  
[0m18:07:18.744381 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:07:18.744381 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:07:18.744381 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m18:07:18.744381 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m18:07:18.744381 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m18:07:18.744381 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:07:18.744381 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m18:07:18.744381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:07:18.744381 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 18:07:18.608377 => 18:07:18.744381
[0m18:07:18.760005 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m18:07:18.760005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F1434C90>]}
[0m18:07:18.760005 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.18s]
[0m18:07:18.760005 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m18:07:18.760005 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_boarding_passes
[0m18:07:18.760005 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m18:07:18.760005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_boarding_passes)
[0m18:07:18.760005 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_boarding_passes
[0m18:07:18.760005 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_boarding_passes"
[0m18:07:18.760005 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (compile): 18:07:18.760005 => 18:07:18.760005
[0m18:07:18.775629 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_boarding_passes
[0m18:07:18.794786 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_boarding_passes"
[0m18:07:18.797762 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:07:18.799754 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: BEGIN
[0m18:07:18.799754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:18.853751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:07:18.854751 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:07:18.855753 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select bp.ticket_no,bp.flight_id,bp.boarding_no,bp.seat_no,
tf.fare_conditions,tf.amount,bp.last_update as bp_last_update,tf.last_update as tf_last_update
from stg.boarding_passes bp
join stg.ticket_flights tf on bp.ticket_no=tf.ticket_no and bp.flight_id =tf.flight_id
  );
  
[0m18:07:21.069758 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 2.0 seconds
[0m18:07:21.085381 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:07:21.085381 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m18:07:21.085381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:21.085381 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m18:07:21.085381 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:07:21.085381 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m18:07:21.085381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:07:21.101011 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:07:21.101011 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m18:07:21.101011 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:07:21.101011 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (execute): 18:07:18.776740 => 18:07:21.101011
[0m18:07:21.101011 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: Close
[0m18:07:21.101011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F15A4D90>]}
[0m18:07:21.116632 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 2.34s]
[0m18:07:21.116632 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_boarding_passes
[0m18:07:21.116632 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m18:07:21.116632 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m18:07:21.116632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_boarding_passes, now model.flight_dbt.fact_flights)
[0m18:07:21.116632 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m18:07:21.116632 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m18:07:21.116632 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 18:07:21.116632 => 18:07:21.116632
[0m18:07:21.116632 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m18:07:21.132256 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m18:07:21.133353 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:07:21.134363 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m18:07:21.135365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:21.184645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:07:21.184645 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:07:21.185674 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-15 15:07:17' as run_time
from cte2
  );
  
[0m18:07:21.478121 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:07:21.481160 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:07:21.482167 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m18:07:21.483120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:21.485157 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:07:21.486158 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m18:07:21.487159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:21.493488 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m18:07:21.493488 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:07:21.493488 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m18:07:21.493488 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:07:21.493488 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:07:21.493488 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m18:07:21.509119 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:07:21.509119 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 18:07:21.116632 => 18:07:21.509119
[0m18:07:21.509119 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m18:07:21.509119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F15DB9D0>]}
[0m18:07:21.509119 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.39s]
[0m18:07:21.509119 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m18:07:21.509119 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m18:07:21.509119 [info ] [Thread-1 (]: 5 of 6 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:07:21.509119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.my_first_dbt_model)
[0m18:07:21.509119 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m18:07:21.509119 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m18:07:21.509119 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 18:07:21.509119 => 18:07:21.509119
[0m18:07:21.509119 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m18:07:21.544840 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m18:07:21.547837 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:07:21.548857 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m18:07:21.549839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:21.600074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:07:21.600074 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:07:21.601087 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:07:21.607867 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:07:21.610905 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:07:21.610905 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:07:21.611909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:21.614900 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:07:21.615900 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:07:21.616866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:21.618900 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m18:07:21.619868 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:07:21.619868 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m18:07:21.621750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:07:21.623761 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:07:21.624761 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:07:21.626761 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:07:21.628796 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 18:07:21.509119 => 18:07:21.627761
[0m18:07:21.628796 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m18:07:21.629760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F15BBD90>]}
[0m18:07:21.630791 [info ] [Thread-1 (]: 5 of 6 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:07:21.631761 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m18:07:21.632764 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m18:07:21.633789 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:07:21.635806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m18:07:21.635806 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m18:07:21.638795 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m18:07:21.639760 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 18:07:21.636761 => 18:07:21.638795
[0m18:07:21.639760 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m18:07:21.644978 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m18:07:21.645941 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:07:21.645941 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m18:07:21.646940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:21.696174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:07:21.697228 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:07:21.698186 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:07:21.705393 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:07:21.708385 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:07:21.708385 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:07:21.710358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:21.711393 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m18:07:21.712391 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:07:21.712391 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m18:07:21.714359 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:07:21.716391 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:07:21.717397 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:07:21.718364 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:07:21.719358 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 18:07:21.640760 => 18:07:21.719358
[0m18:07:21.720396 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m18:07:21.721359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d326f4-9032-45e9-b4fe-583d4a58a372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F15A8C90>]}
[0m18:07:21.722403 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m18:07:21.724365 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m18:07:21.726358 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:21.727359 [debug] [MainThread]: On master: BEGIN
[0m18:07:21.727359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:21.772620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:21.772620 [debug] [MainThread]: On master: COMMIT
[0m18:07:21.773640 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:21.773640 [debug] [MainThread]: On master: COMMIT
[0m18:07:21.774584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:21.774584 [debug] [MainThread]: On master: Close
[0m18:07:21.775584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:21.776585 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m18:07:21.776585 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m18:07:21.777586 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m18:07:21.778586 [info ] [MainThread]: 
[0m18:07:21.779586 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m18:07:21.783613 [debug] [MainThread]: Command end result
[0m18:07:21.791593 [info ] [MainThread]: 
[0m18:07:21.792586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:21.793586 [info ] [MainThread]: 
[0m18:07:21.794587 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:07:21.795584 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:21.795584 after 4.20 seconds
[0m18:07:21.796584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6F0C97890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EA79AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EA79A210>]}
[0m18:07:21.796584 [debug] [MainThread]: Flushing usage events
[0m18:09:40.076173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C9D69210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA48A910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C9D7BC10>]}


============================== 18:09:40.091759 | fc2bd45a-8ba6-497b-a8f9-168f30ccce38 ==============================
[0m18:09:40.091759 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:09:40.091759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:09:40.177675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA0AFC50>]}
[0m18:09:40.195640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA0AFC50>]}
[0m18:09:40.197051 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m18:09:40.210101 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:09:40.272367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:40.273368 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:40.280337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C9DEC2D0>]}
[0m18:09:40.290368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA787E10>]}
[0m18:09:40.291338 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:09:40.291913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C64A8710>]}
[0m18:09:40.293974 [info ] [MainThread]: 
[0m18:09:40.295940 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:40.297950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:09:40.307979 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:09:40.307979 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:09:40.308994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:40.359732 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:09:40.360700 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:09:40.363701 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m18:09:40.371737 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:09:40.371737 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:09:40.371737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:40.411990 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:09:40.411990 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:09:40.411990 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:09:40.411990 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:09:40.411990 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:09:40.411990 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:09:40.427619 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:40.427619 [debug] [MainThread]: On master: BEGIN
[0m18:09:40.427619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:40.609629 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:40.610629 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:40.611627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:40.650710 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:09:40.652663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA3423D0>]}
[0m18:09:40.653667 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:40.653667 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:40.654628 [debug] [MainThread]: On master: BEGIN
[0m18:09:40.655627 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:40.655627 [debug] [MainThread]: On master: COMMIT
[0m18:09:40.655627 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:40.656630 [debug] [MainThread]: On master: COMMIT
[0m18:09:40.656630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:40.657628 [debug] [MainThread]: On master: Close
[0m18:09:40.658627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:40.659631 [info ] [MainThread]: 
[0m18:09:40.669771 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m18:09:40.670817 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m18:09:40.671784 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m18:09:40.672783 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m18:09:40.675808 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m18:09:40.676807 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 18:09:40.672783 => 18:09:40.676807
[0m18:09:40.677784 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m18:09:40.752816 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:40.753821 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp180940713786"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 15:09:40' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m18:09:40.753821 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:09:40.822868 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:09:40.832927 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:40.833870 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m18:09:40.834870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:40.834870 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:40.835867 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp180940713786'
        
      order by ordinal_position

  
[0m18:09:40.858074 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:40.866124 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:40.867128 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:09:40.871075 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:40.880115 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:40.881076 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:09:40.886110 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:40.906109 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m18:09:40.907113 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:40.908075 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp180940713786"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp180940713786"
    )
  
[0m18:09:40.915626 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:09:40.935594 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:40.935594 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m18:09:40.937284 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m18:09:40.938296 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m18:09:40.938296 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:40.939295 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m18:09:40.945192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:40.948193 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 18:09:40.677784 => 18:09:40.947192
[0m18:09:40.948193 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m18:09:40.950198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA829C90>]}
[0m18:09:40.951237 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.28s]
[0m18:09:40.953193 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m18:09:40.954192 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m18:09:40.955194 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m18:09:40.957190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m18:09:40.958190 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m18:09:40.961225 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m18:09:40.964199 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 18:09:40.958190 => 18:09:40.963216
[0m18:09:40.965196 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m18:09:40.971225 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:40.972226 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp180940969224"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 15:09:40' as run_time
from stg.airports_data
  );
  
  
[0m18:09:40.973190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:41.035863 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:09:41.038860 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:41.038860 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m18:09:41.040861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:41.040861 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:41.040861 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp180940969224'
        
      order by ordinal_position

  
[0m18:09:41.064170 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:41.069162 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:41.070159 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:09:41.074165 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:41.077123 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:41.078124 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:09:41.085159 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:41.089122 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m18:09:41.090122 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:41.090122 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp180940969224"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp180940969224"
    )
  
[0m18:09:41.094122 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:09:41.099125 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:41.100132 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m18:09:41.101125 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m18:09:41.102123 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m18:09:41.103122 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:41.103122 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m18:09:41.106123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:41.108128 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 18:09:40.966207 => 18:09:41.108128
[0m18:09:41.109125 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m18:09:41.110123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA841E10>]}
[0m18:09:41.111126 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.15s]
[0m18:09:41.115130 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m18:09:41.117150 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_boarding_passes
[0m18:09:41.118126 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m18:09:41.120126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_boarding_passes)
[0m18:09:41.121125 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_boarding_passes
[0m18:09:41.124160 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_boarding_passes"
[0m18:09:41.125157 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (compile): 18:09:41.121125 => 18:09:41.125157
[0m18:09:41.126123 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_boarding_passes
[0m18:09:41.141157 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_boarding_passes"
[0m18:09:41.143122 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:41.143122 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: BEGIN
[0m18:09:41.144131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:41.199638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:41.200573 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:41.201570 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select bp.ticket_no,bp.flight_id,bp.boarding_no,bp.seat_no,
tf.fare_conditions,tf.amount,bp.last_update as bp_last_update,tf.last_update as tf_last_update
from stg.boarding_passes bp
join stg.ticket_flights tf on bp.ticket_no=tf.ticket_no and bp.flight_id =tf.flight_id
  );
  
[0m18:09:43.505882 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 2.0 seconds
[0m18:09:43.521509 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:43.521509 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m18:09:43.521509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:43.521509 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:43.521509 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m18:09:43.521509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:43.537135 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m18:09:43.537135 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:43.537135 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m18:09:43.537135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:43.537135 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:43.537135 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m18:09:43.552761 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:09:43.552761 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (execute): 18:09:41.126123 => 18:09:43.552761
[0m18:09:43.552761 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: Close
[0m18:09:43.552761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA981C90>]}
[0m18:09:43.552761 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 2.43s]
[0m18:09:43.568382 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_boarding_passes
[0m18:09:43.568994 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m18:09:43.570006 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m18:09:43.571004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_boarding_passes, now model.flight_dbt.fact_flights)
[0m18:09:43.572004 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m18:09:43.577085 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m18:09:43.578001 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 18:09:43.573006 => 18:09:43.578001
[0m18:09:43.578999 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m18:09:43.583038 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m18:09:43.584000 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:43.585001 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m18:09:43.585001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:43.638001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:43.638001 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:43.639002 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-15 15:09:40' as run_time
from cte2
  );
  
[0m18:09:43.925867 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:09:43.925867 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:43.925867 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m18:09:43.925867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:43.940920 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:43.940920 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m18:09:43.940920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:43.940920 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m18:09:43.940920 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:43.940920 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m18:09:43.956559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:43.956559 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:43.956559 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m18:09:43.956559 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:09:43.956559 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 18:09:43.578999 => 18:09:43.956559
[0m18:09:43.956559 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m18:09:43.956559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA9913D0>]}
[0m18:09:43.956559 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.39s]
[0m18:09:43.956559 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m18:09:43.972180 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m18:09:43.972180 [info ] [Thread-1 (]: 5 of 6 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:09:43.972180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.my_first_dbt_model)
[0m18:09:43.972180 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m18:09:43.972180 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m18:09:43.972180 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 18:09:43.972180 => 18:09:43.972180
[0m18:09:43.972180 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m18:09:44.003375 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m18:09:44.004335 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:44.005337 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m18:09:44.005337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:44.052896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:44.053897 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:44.053897 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:09:44.060628 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:09:44.064652 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:44.065628 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:09:44.066666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:44.069627 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:44.069627 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:09:44.071627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:44.073627 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m18:09:44.073627 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:44.073627 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m18:09:44.075628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:44.078630 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:44.079632 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:09:44.082659 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:09:44.085662 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 18:09:43.972180 => 18:09:44.085662
[0m18:09:44.085662 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m18:09:44.086664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA94B190>]}
[0m18:09:44.087662 [info ] [Thread-1 (]: 5 of 6 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.11s]
[0m18:09:44.089628 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m18:09:44.090662 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m18:09:44.091628 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:09:44.092507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m18:09:44.093552 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m18:09:44.095555 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m18:09:44.097518 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 18:09:44.093552 => 18:09:44.096554
[0m18:09:44.097518 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m18:09:44.104521 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m18:09:44.105563 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:44.106520 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m18:09:44.107531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:44.160608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:44.161596 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:44.162596 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:09:44.168594 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:09:44.172593 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:44.172593 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:09:44.173593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:44.175594 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m18:09:44.176595 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:44.177621 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m18:09:44.179336 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:44.181347 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:44.182347 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:09:44.183199 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:09:44.184210 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 18:09:44.097518 => 18:09:44.184210
[0m18:09:44.185246 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m18:09:44.186210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2bd45a-8ba6-497b-a8f9-168f30ccce38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CA8F0890>]}
[0m18:09:44.187215 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.09s]
[0m18:09:44.188213 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m18:09:44.190210 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:44.190210 [debug] [MainThread]: On master: BEGIN
[0m18:09:44.191210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:44.339888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:44.340874 [debug] [MainThread]: On master: COMMIT
[0m18:09:44.340874 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:44.341832 [debug] [MainThread]: On master: COMMIT
[0m18:09:44.341832 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:44.342833 [debug] [MainThread]: On master: Close
[0m18:09:44.343872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:44.344834 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m18:09:44.344834 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m18:09:44.345837 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m18:09:44.345837 [info ] [MainThread]: 
[0m18:09:44.346832 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m18:09:44.348838 [debug] [MainThread]: Command end result
[0m18:09:44.356435 [info ] [MainThread]: 
[0m18:09:44.356842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:44.357894 [info ] [MainThread]: 
[0m18:09:44.358855 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:09:44.360857 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:44.360857 after 4.29 seconds
[0m18:09:44.360857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C9DD7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C3AB9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C3AFA210>]}
[0m18:09:44.361881 [debug] [MainThread]: Flushing usage events
[0m18:09:53.080987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398B679B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398B65ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398B67A010>]}


============================== 18:09:53.080987 | f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6 ==============================
[0m18:09:53.080987 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:09:53.080987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:09:53.175025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398B163490>]}
[0m18:09:53.201388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023988B0F3D0>]}
[0m18:09:53.201388 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m18:09:53.230156 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:09:53.325328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:09:53.326327 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\facts\schema.yml
[0m18:09:53.397161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398BDA6350>]}
[0m18:09:53.397161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398BE1F610>]}
[0m18:09:53.412826 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:09:53.412826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398958F450>]}
[0m18:09:53.412826 [info ] [MainThread]: 
[0m18:09:53.412826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:53.412826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:09:53.431852 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:09:53.431852 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:09:53.432849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:53.493231 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:09:53.494232 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:09:53.497238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m18:09:53.504315 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:09:53.505279 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:09:53.505279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:53.552613 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:09:53.553657 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:09:53.554616 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:09:53.562219 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:09:53.564259 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:09:53.565218 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:09:53.568199 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:53.568199 [debug] [MainThread]: On master: BEGIN
[0m18:09:53.568199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:53.614488 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:53.614488 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:53.614488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:53.645738 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:09:53.645738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398BE03E50>]}
[0m18:09:53.645738 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:53.645738 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:53.645738 [debug] [MainThread]: On master: BEGIN
[0m18:09:53.645738 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:53.645738 [debug] [MainThread]: On master: COMMIT
[0m18:09:53.645738 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:53.645738 [debug] [MainThread]: On master: COMMIT
[0m18:09:53.645738 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:53.645738 [debug] [MainThread]: On master: Close
[0m18:09:53.645738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:53.645738 [info ] [MainThread]: 
[0m18:09:53.661363 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m18:09:53.661363 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m18:09:53.665771 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m18:09:53.665771 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m18:09:53.669783 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m18:09:53.671792 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 18:09:53.666777 => 18:09:53.670780
[0m18:09:53.671792 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m18:09:53.762661 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:53.762661 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp180953722665"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 15:09:53' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m18:09:53.763659 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:09:53.815923 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:09:53.815923 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:53.815923 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m18:09:53.815923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:53.815923 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:53.815923 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp180953722665'
        
      order by ordinal_position

  
[0m18:09:53.847182 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:53.847182 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:53.847182 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:09:53.847182 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:53.862847 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:53.862847 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:09:53.862847 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:53.894103 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m18:09:53.894103 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:53.894103 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp180953722665"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp180953722665"
    )
  
[0m18:09:53.894103 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:09:53.909725 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:53.909725 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m18:09:53.909725 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m18:09:53.925363 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m18:09:53.925363 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:09:53.925363 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m18:09:53.925363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:53.925363 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 18:09:53.672781 => 18:09:53.925363
[0m18:09:53.925363 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m18:09:53.925363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398BF726D0>]}
[0m18:09:53.925363 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.26s]
[0m18:09:53.925363 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m18:09:53.925363 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m18:09:53.925363 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m18:09:53.925363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m18:09:53.940968 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m18:09:53.945168 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m18:09:53.947169 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 18:09:53.942153 => 18:09:53.946170
[0m18:09:53.948164 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m18:09:53.957174 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:53.958167 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp180953953165"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 15:09:53' as run_time
from stg.airports_data
  );
  
  
[0m18:09:53.959167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:54.015735 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:09:54.021706 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:54.022760 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m18:09:54.023704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:54.024740 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:54.024740 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp180953953165'
        
      order by ordinal_position

  
[0m18:09:54.044377 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:54.047383 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:54.048382 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:09:54.053015 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:54.056029 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:54.057026 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:09:54.061199 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:09:54.064210 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m18:09:54.066211 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:54.067216 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp180953953165"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp180953953165"
    )
  
[0m18:09:54.067517 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:09:54.067517 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:54.067517 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m18:09:54.067517 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m18:09:54.067517 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m18:09:54.067517 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:09:54.067517 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m18:09:54.067517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:54.067517 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 18:09:53.949174 => 18:09:54.067517
[0m18:09:54.067517 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m18:09:54.067517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398BF9C510>]}
[0m18:09:54.067517 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.14s]
[0m18:09:54.083151 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m18:09:54.083151 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_boarding_passes
[0m18:09:54.083151 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m18:09:54.083151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_boarding_passes)
[0m18:09:54.083151 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_boarding_passes
[0m18:09:54.083151 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_boarding_passes"
[0m18:09:54.083151 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (compile): 18:09:54.083151 => 18:09:54.083151
[0m18:09:54.083151 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_boarding_passes
[0m18:09:54.109483 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_boarding_passes"
[0m18:09:54.111440 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:54.111440 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: BEGIN
[0m18:09:54.112467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:54.161558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:54.162559 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:54.162559 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select bp.ticket_no,bp.flight_id,bp.boarding_no,bp.seat_no,
tf.fare_conditions,tf.amount,bp.last_update as bp_last_update,tf.last_update as tf_last_update
from stg.boarding_passes bp
join stg.ticket_flights tf on bp.ticket_no=tf.ticket_no and bp.flight_id =tf.flight_id
  );
  
[0m18:09:56.355326 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 2.0 seconds
[0m18:09:56.355326 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:56.355326 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m18:09:56.355326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:56.370952 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:56.370952 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m18:09:56.370952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:56.370952 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m18:09:56.370952 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:56.370952 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m18:09:56.386574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:56.386574 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:09:56.386574 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m18:09:56.386574 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:09:56.402203 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (execute): 18:09:54.083151 => 18:09:56.402203
[0m18:09:56.402203 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: Close
[0m18:09:56.402203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398BEA8B10>]}
[0m18:09:56.402203 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 2.32s]
[0m18:09:56.402203 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_boarding_passes
[0m18:09:56.402203 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m18:09:56.402203 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m18:09:56.402203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_boarding_passes, now model.flight_dbt.fact_flights)
[0m18:09:56.402203 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m18:09:56.402203 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m18:09:56.402203 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 18:09:56.402203 => 18:09:56.402203
[0m18:09:56.402203 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m18:09:56.421141 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m18:09:56.422140 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:56.423141 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m18:09:56.423141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:56.474144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:56.474144 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:56.475181 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-15 15:09:53' as run_time
from cte2
  );
  
[0m18:09:56.777855 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:09:56.779979 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:56.779979 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m18:09:56.779979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:56.779979 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:56.779979 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m18:09:56.779979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:56.779979 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m18:09:56.779979 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:56.779979 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m18:09:56.794030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:56.794030 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:09:56.794030 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m18:09:56.794030 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:09:56.794030 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 18:09:56.402203 => 18:09:56.794030
[0m18:09:56.809705 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m18:09:56.809705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398C034AD0>]}
[0m18:09:56.809705 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.41s]
[0m18:09:56.809705 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m18:09:56.809705 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m18:09:56.809705 [info ] [Thread-1 (]: 5 of 6 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:09:56.809705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.my_first_dbt_model)
[0m18:09:56.809705 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m18:09:56.809705 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m18:09:56.809705 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 18:09:56.809705 => 18:09:56.809705
[0m18:09:56.809705 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m18:09:56.846572 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m18:09:56.848531 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:56.849554 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m18:09:56.850531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:56.903496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:56.904528 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:56.904528 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:09:56.910254 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:09:56.913289 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:56.913289 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:09:56.914262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:56.918301 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:56.919254 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:09:56.920256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:56.922254 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m18:09:56.922254 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:56.923257 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m18:09:56.925557 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:56.928569 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:09:56.928569 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:09:56.930828 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:09:56.931704 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 18:09:56.809705 => 18:09:56.931704
[0m18:09:56.931704 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m18:09:56.931704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398BDA6310>]}
[0m18:09:56.931704 [info ] [Thread-1 (]: 5 of 6 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:09:56.931704 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m18:09:56.931704 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m18:09:56.931704 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:09:56.931704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m18:09:56.931704 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m18:09:56.931704 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m18:09:56.931704 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 18:09:56.931704 => 18:09:56.931704
[0m18:09:56.931704 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m18:09:56.949897 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m18:09:56.950899 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:56.951866 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m18:09:56.952868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:57.005938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:57.006940 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:57.006940 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:09:57.011943 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:09:57.014938 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:57.015938 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:09:57.018017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:57.019985 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m18:09:57.020973 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:57.021939 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m18:09:57.023554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:57.026565 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:09:57.026565 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:09:57.027565 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:09:57.029604 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 18:09:56.931704 => 18:09:57.029604
[0m18:09:57.030564 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m18:09:57.031565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b6f5a9-ed51-4f62-90eb-4d0ab180f3e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398BEB3350>]}
[0m18:09:57.032565 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m18:09:57.034567 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m18:09:57.036603 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:57.036603 [debug] [MainThread]: On master: BEGIN
[0m18:09:57.037566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:57.088122 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:57.089089 [debug] [MainThread]: On master: COMMIT
[0m18:09:57.089089 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:57.089089 [debug] [MainThread]: On master: COMMIT
[0m18:09:57.090087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:57.091087 [debug] [MainThread]: On master: Close
[0m18:09:57.091087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:57.092088 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m18:09:57.092088 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m18:09:57.093089 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m18:09:57.093089 [info ] [MainThread]: 
[0m18:09:57.094087 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m18:09:57.097121 [debug] [MainThread]: Command end result
[0m18:09:57.108087 [info ] [MainThread]: 
[0m18:09:57.109090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:57.110090 [info ] [MainThread]: 
[0m18:09:57.111088 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:09:57.113088 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:57.113088 after 4.05 seconds
[0m18:09:57.113088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398930F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398522CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398BA70110>]}
[0m18:09:57.114115 [debug] [MainThread]: Flushing usage events
[0m18:11:02.068400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BF85FAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFE86B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFE869290>]}


============================== 18:11:02.068400 | a5ac7b14-e04b-4e79-88dd-9d6e51fa8828 ==============================
[0m18:11:02.068400 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:11:02.068400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:11:02.158210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFEAD55D0>]}
[0m18:11:02.178211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFE5D1D10>]}
[0m18:11:02.180228 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m18:11:02.193211 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m18:11:02.286464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:11:02.287465 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\facts\fact_boarding_passes.sql
[0m18:11:02.310168 [debug] [MainThread]: 1603: static parser failed on facts\fact_boarding_passes.sql
[0m18:11:02.325793 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts\fact_boarding_passes.sql
[0m18:11:02.372674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFF37E490>]}
[0m18:11:02.388254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFF2E4D90>]}
[0m18:11:02.388254 [info ] [MainThread]: Found 6 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:11:02.388254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFAF48590>]}
[0m18:11:02.388254 [info ] [MainThread]: 
[0m18:11:02.388254 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:11:02.388254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m18:11:02.415209 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m18:11:02.416211 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:11:02.417212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:02.475206 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:11:02.477206 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m18:11:02.480205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m18:11:02.486242 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:11:02.487241 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m18:11:02.487241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:02.651793 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:11:02.651793 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m18:11:02.651793 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:11:02.667408 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:11:02.667408 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m18:11:02.667408 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m18:11:02.683041 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:02.683041 [debug] [MainThread]: On master: BEGIN
[0m18:11:02.683041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:02.729932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:02.729932 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:02.729932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:11:02.745541 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:11:02.745541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFF24EB90>]}
[0m18:11:02.761124 [debug] [MainThread]: On master: ROLLBACK
[0m18:11:02.761124 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:02.761124 [debug] [MainThread]: On master: BEGIN
[0m18:11:02.761124 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:02.761124 [debug] [MainThread]: On master: COMMIT
[0m18:11:02.761124 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:02.761124 [debug] [MainThread]: On master: COMMIT
[0m18:11:02.761124 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:02.761124 [debug] [MainThread]: On master: Close
[0m18:11:02.761124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:02.761124 [info ] [MainThread]: 
[0m18:11:02.761124 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m18:11:02.761124 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m18:11:02.777046 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m18:11:02.778046 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m18:11:02.781051 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m18:11:02.782048 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 18:11:02.778046 => 18:11:02.782048
[0m18:11:02.783053 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m18:11:02.855084 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:11:02.856083 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp181102816048"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 15:11:02' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m18:11:02.857048 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:11:03.039037 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:11:03.046073 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:11:03.047075 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m18:11:03.048036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:03.048036 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:11:03.049036 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp181102816048'
        
      order by ordinal_position

  
[0m18:11:03.054563 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:11:03.070238 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:11:03.070238 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:11:03.070238 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:11:03.091130 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:11:03.091879 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:11:03.096250 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:11:03.115355 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m18:11:03.116356 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:11:03.116356 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp181102816048"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp181102816048"
    )
  
[0m18:11:03.117745 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:11:03.133414 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:11:03.133414 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m18:11:03.133414 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m18:11:03.133414 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m18:11:03.133414 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m18:11:03.133414 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m18:11:03.133414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:03.133414 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 18:11:02.784084 => 18:11:03.133414
[0m18:11:03.133414 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m18:11:03.133414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFF1E6D50>]}
[0m18:11:03.148999 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.37s]
[0m18:11:03.148999 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m18:11:03.148999 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m18:11:03.148999 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m18:11:03.148999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m18:11:03.148999 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m18:11:03.148999 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m18:11:03.148999 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 18:11:03.148999 => 18:11:03.148999
[0m18:11:03.148999 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m18:11:03.164660 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:11:03.166157 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp181103148999"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 15:11:02' as run_time
from stg.airports_data
  );
  
  
[0m18:11:03.167168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:03.227352 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:11:03.232381 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:11:03.233375 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m18:11:03.234347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:03.234347 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:11:03.235348 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp181103148999'
        
      order by ordinal_position

  
[0m18:11:03.253100 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:11:03.256132 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:11:03.257113 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:11:03.260528 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:11:03.260528 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:11:03.260528 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:11:03.260528 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:11:03.260528 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m18:11:03.260528 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:11:03.260528 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp181103148999"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp181103148999"
    )
  
[0m18:11:03.276159 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:11:03.276159 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:11:03.276159 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m18:11:03.276159 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m18:11:03.276159 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m18:11:03.276159 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m18:11:03.276159 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m18:11:03.276159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:03.276159 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 18:11:03.148999 => 18:11:03.276159
[0m18:11:03.276159 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m18:11:03.276159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFF354090>]}
[0m18:11:03.276159 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.13s]
[0m18:11:03.291783 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m18:11:03.291783 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_boarding_passes
[0m18:11:03.291783 [info ] [Thread-1 (]: 3 of 6 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m18:11:03.291783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_boarding_passes)
[0m18:11:03.291783 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_boarding_passes
[0m18:11:03.291783 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_boarding_passes"
[0m18:11:03.291783 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (compile): 18:11:03.291783 => 18:11:03.291783
[0m18:11:03.291783 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_boarding_passes
[0m18:11:03.319571 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_boarding_passes"
[0m18:11:03.321569 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:11:03.321569 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: BEGIN
[0m18:11:03.322568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:03.373022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:03.373022 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:11:03.374022 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select bp.ticket_no,bp.flight_id,bp.boarding_no,bp.seat_no,
tf.fare_conditions,tf.amount,bp.last_update as bp_last_update,tf.last_update as tf_last_update
,'23-08-15 15:11:02' as run_time
from stg.boarding_passes bp
join stg.ticket_flights tf on bp.ticket_no=tf.ticket_no and bp.flight_id =tf.flight_id
  );
  
[0m18:11:05.801171 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 2.0 seconds
[0m18:11:05.801171 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:11:05.816843 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m18:11:05.816843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:05.816843 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:11:05.816843 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m18:11:05.816843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:05.816843 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m18:11:05.816843 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:11:05.816843 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m18:11:05.832420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:05.832420 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m18:11:05.832420 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m18:11:05.848086 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:11:05.848086 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (execute): 18:11:03.291783 => 18:11:05.848086
[0m18:11:05.848086 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: Close
[0m18:11:05.848086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFF44CB10>]}
[0m18:11:05.848086 [info ] [Thread-1 (]: 3 of 6 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 2.56s]
[0m18:11:05.848086 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_boarding_passes
[0m18:11:05.848086 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m18:11:05.848086 [info ] [Thread-1 (]: 4 of 6 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m18:11:05.848086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_boarding_passes, now model.flight_dbt.fact_flights)
[0m18:11:05.848086 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m18:11:05.863670 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m18:11:05.863670 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 18:11:05.848086 => 18:11:05.863670
[0m18:11:05.863670 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m18:11:05.863670 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m18:11:05.863670 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:11:05.863670 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m18:11:05.863670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:05.927127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:05.928122 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:11:05.929122 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-15 15:11:02' as run_time
from cte2
  );
  
[0m18:11:06.268418 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:11:06.268418 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:11:06.268418 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m18:11:06.268418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:06.284082 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:11:06.284082 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m18:11:06.284082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:06.284082 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m18:11:06.284082 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:11:06.284082 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m18:11:06.299668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:06.299668 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m18:11:06.299668 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m18:11:06.315298 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:11:06.315298 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 18:11:05.863670 => 18:11:06.315298
[0m18:11:06.315298 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m18:11:06.315298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFF459B50>]}
[0m18:11:06.315298 [info ] [Thread-1 (]: 4 of 6 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.47s]
[0m18:11:06.315298 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m18:11:06.330920 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m18:11:06.330920 [info ] [Thread-1 (]: 5 of 6 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:11:06.330920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.my_first_dbt_model)
[0m18:11:06.330920 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m18:11:06.330920 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m18:11:06.330920 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 18:11:06.330920 => 18:11:06.330920
[0m18:11:06.330920 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m18:11:06.360053 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m18:11:06.361052 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:11:06.363083 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m18:11:06.364092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:06.413929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:06.414918 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:11:06.414918 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:11:06.419917 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:06.422952 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:11:06.422952 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:11:06.423917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:06.427950 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:11:06.428952 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:11:06.429949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:06.431954 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m18:11:06.431954 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:11:06.432916 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m18:11:06.435032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:06.441052 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m18:11:06.442059 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:11:06.445051 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:06.447052 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 18:11:06.330920 => 18:11:06.447052
[0m18:11:06.448052 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m18:11:06.449052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFF26BA50>]}
[0m18:11:06.450053 [info ] [Thread-1 (]: 5 of 6 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:11:06.452575 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m18:11:06.454606 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m18:11:06.455574 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:11:06.456572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m18:11:06.457683 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m18:11:06.460771 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m18:11:06.461737 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 18:11:06.457683 => 18:11:06.461737
[0m18:11:06.462738 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m18:11:06.469775 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m18:11:06.470769 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:11:06.471736 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m18:11:06.471736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:06.637234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:06.637234 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:11:06.637234 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:11:06.653888 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:06.653888 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:11:06.653888 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:11:06.653888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:06.653888 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m18:11:06.653888 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:11:06.653888 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m18:11:06.653888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:06.653888 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m18:11:06.668940 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:11:06.668940 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:06.668940 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 18:11:06.462738 => 18:11:06.668940
[0m18:11:06.668940 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m18:11:06.668940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5ac7b14-e04b-4e79-88dd-9d6e51fa8828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFF1ED850>]}
[0m18:11:06.668940 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.21s]
[0m18:11:06.668940 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m18:11:06.668940 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:06.668940 [debug] [MainThread]: On master: BEGIN
[0m18:11:06.668940 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:06.724946 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:06.725951 [debug] [MainThread]: On master: COMMIT
[0m18:11:06.726958 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:06.726958 [debug] [MainThread]: On master: COMMIT
[0m18:11:06.728962 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:06.729947 [debug] [MainThread]: On master: Close
[0m18:11:06.729947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:06.731967 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m18:11:06.731967 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m18:11:06.732974 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m18:11:06.732974 [info ] [MainThread]: 
[0m18:11:06.733976 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m18:11:06.735980 [debug] [MainThread]: Command end result
[0m18:11:06.744955 [info ] [MainThread]: 
[0m18:11:06.745959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:06.747981 [info ] [MainThread]: 
[0m18:11:06.749048 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:11:06.750063 [debug] [MainThread]: Command `dbt run` succeeded at 18:11:06.750063 after 4.70 seconds
[0m18:11:06.751103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFE5A7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFEF1BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BFEF1BFD0>]}
[0m18:11:06.751103 [debug] [MainThread]: Flushing usage events
[0m19:28:50.433670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB25E9CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB1F2B210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB1C7A3D0>]}


============================== 19:28:50.453081 | 455b72ef-8303-4039-a095-6568103a22c0 ==============================
[0m19:28:50.453081 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:28:50.454048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:28:50.534115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB25EBF50>]}
[0m19:28:50.553113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB2280E10>]}
[0m19:28:50.555116 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m19:28:50.567117 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:28:50.638991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:28:50.639589 [debug] [MainThread]: Partial parsing: added file: flight_dbt://models\facts\fact_tickets.sql
[0m19:28:50.662669 [debug] [MainThread]: 1699: static parser successfully parsed facts\fact_tickets.sql
[0m19:28:50.675523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB1EB83D0>]}
[0m19:28:50.695742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB29EB890>]}
[0m19:28:50.695742 [info ] [MainThread]: Found 7 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:28:50.695742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AAE608710>]}
[0m19:28:50.695742 [info ] [MainThread]: 
[0m19:28:50.695742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:50.695742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:28:50.719384 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:28:50.719384 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:28:50.720343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:50.775554 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:28:50.777553 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:28:50.781558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m19:28:50.787585 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:28:50.787585 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:28:50.788579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:50.834148 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:28:50.835148 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:28:50.835148 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:28:50.842075 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:28:50.842075 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:28:50.842075 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:28:50.842075 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:50.842075 [debug] [MainThread]: On master: BEGIN
[0m19:28:50.842075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:50.888955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:50.888955 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:50.888955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:50.920246 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:28:50.920246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB290F590>]}
[0m19:28:50.920246 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:50.920246 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:50.920246 [debug] [MainThread]: On master: BEGIN
[0m19:28:50.920246 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:50.935835 [debug] [MainThread]: On master: COMMIT
[0m19:28:50.935835 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:50.935835 [debug] [MainThread]: On master: COMMIT
[0m19:28:50.935835 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:50.935835 [debug] [MainThread]: On master: Close
[0m19:28:50.935835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:50.935835 [info ] [MainThread]: 
[0m19:28:50.935835 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m19:28:50.935835 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m19:28:50.935835 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m19:28:50.949016 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m19:28:50.953027 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m19:28:50.954025 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 19:28:50.950058 => 19:28:50.954025
[0m19:28:50.955028 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m19:28:51.025024 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:28:51.026025 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp192850989023"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 16:28:50' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m19:28:51.027023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:51.074167 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:28:51.089796 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:28:51.089796 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m19:28:51.089796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:51.089796 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:28:51.089796 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp192850989023'
        
      order by ordinal_position

  
[0m19:28:51.105421 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:28:51.105421 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:28:51.105421 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:28:51.121080 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:28:51.121080 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:28:51.121080 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:28:51.136709 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:28:51.152298 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m19:28:51.152298 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:28:51.152298 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp192850989023"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp192850989023"
    )
  
[0m19:28:51.152298 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m19:28:51.167959 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:28:51.167959 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m19:28:51.167959 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m19:28:51.167959 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:28:51.167959 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:28:51.167959 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:28:51.189040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:51.189040 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 19:28:50.955028 => 19:28:51.189040
[0m19:28:51.189040 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m19:28:51.189040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB28F2D50>]}
[0m19:28:51.189040 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.25s]
[0m19:28:51.189040 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m19:28:51.189040 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m19:28:51.199585 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m19:28:51.199585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m19:28:51.199585 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m19:28:51.199585 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m19:28:51.199585 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 19:28:51.199585 => 19:28:51.199585
[0m19:28:51.199585 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m19:28:51.199585 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:28:51.199585 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp192851199585"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 16:28:50' as run_time
from stg.airports_data
  );
  
  
[0m19:28:51.199585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:51.402746 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:28:51.402746 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:28:51.402746 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m19:28:51.402746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:51.402746 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:28:51.402746 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp192851199585'
        
      order by ordinal_position

  
[0m19:28:51.418320 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:28:51.418320 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:28:51.418320 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:28:51.433987 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:28:51.433987 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:28:51.433987 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:28:51.433987 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:28:51.433987 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m19:28:51.433987 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:28:51.433987 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp192851199585"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp192851199585"
    )
  
[0m19:28:51.449573 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m19:28:51.449573 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:28:51.449573 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m19:28:51.449573 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m19:28:51.449573 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m19:28:51.449573 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:28:51.449573 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m19:28:51.449573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:51.449573 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 19:28:51.199585 => 19:28:51.449573
[0m19:28:51.449573 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m19:28:51.449573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB2A7F910>]}
[0m19:28:51.465199 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.25s]
[0m19:28:51.465199 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m19:28:51.465199 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_boarding_passes
[0m19:28:51.465199 [info ] [Thread-1 (]: 3 of 7 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:28:51.465199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_boarding_passes)
[0m19:28:51.465199 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_boarding_passes
[0m19:28:51.465199 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_boarding_passes"
[0m19:28:51.465199 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (compile): 19:28:51.465199 => 19:28:51.465199
[0m19:28:51.465199 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_boarding_passes
[0m19:28:51.489986 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_boarding_passes"
[0m19:28:51.492018 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:28:51.492980 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: BEGIN
[0m19:28:51.492980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:51.544619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:51.544619 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:28:51.546615 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select bp.ticket_no,bp.flight_id,bp.boarding_no,bp.seat_no,
tf.fare_conditions,tf.amount,bp.last_update as bp_last_update,tf.last_update as tf_last_update
,'23-08-15 16:28:50' as run_time
from stg.boarding_passes bp
join stg.ticket_flights tf on bp.ticket_no=tf.ticket_no and bp.flight_id =tf.flight_id
  );
  
[0m19:28:53.672434 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 2.0 seconds
[0m19:28:53.672434 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:28:53.672434 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m19:28:53.672434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:53.688091 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:28:53.688091 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m19:28:53.688091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:53.688091 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:28:53.688091 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:28:53.688091 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:28:53.703680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:53.703680 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:28:53.703680 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m19:28:53.719306 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:28:53.719306 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (execute): 19:28:51.465199 => 19:28:53.719306
[0m19:28:53.719306 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: Close
[0m19:28:53.719306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB299A710>]}
[0m19:28:53.719306 [info ] [Thread-1 (]: 3 of 7 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 2.25s]
[0m19:28:53.719306 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_boarding_passes
[0m19:28:53.719306 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m19:28:53.719306 [info ] [Thread-1 (]: 4 of 7 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m19:28:53.719306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_boarding_passes, now model.flight_dbt.fact_flights)
[0m19:28:53.719306 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m19:28:53.736058 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m19:28:53.737074 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 19:28:53.719306 => 19:28:53.737074
[0m19:28:53.738074 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m19:28:53.747091 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m19:28:53.748071 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:28:53.749071 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m19:28:53.749071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:53.798943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:53.798943 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:28:53.799945 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-15 16:28:50' as run_time
from cte2
  );
  
[0m19:28:54.064651 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m19:28:54.080316 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:28:54.080316 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m19:28:54.080316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:54.080316 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:28:54.080316 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m19:28:54.080316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:54.080316 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:28:54.080316 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:28:54.080316 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:28:54.095900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:54.095900 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:28:54.095900 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m19:28:54.095900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:28:54.111526 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 19:28:53.738074 => 19:28:54.111526
[0m19:28:54.111526 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m19:28:54.111526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB2B184D0>]}
[0m19:28:54.111526 [info ] [Thread-1 (]: 4 of 7 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.39s]
[0m19:28:54.111526 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m19:28:54.111526 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_tickets
[0m19:28:54.111526 [info ] [Thread-1 (]: 5 of 7 START sql table model flights_wh.fact_tickets ........................... [RUN]
[0m19:28:54.111526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.fact_tickets)
[0m19:28:54.111526 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_tickets
[0m19:28:54.111526 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_tickets"
[0m19:28:54.111526 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (compile): 19:28:54.111526 => 19:28:54.111526
[0m19:28:54.111526 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_tickets
[0m19:28:54.128432 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_tickets"
[0m19:28:54.130444 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:28:54.130444 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: BEGIN
[0m19:28:54.131443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:54.178908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:54.179893 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:28:54.179893 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp"
  
  
    as
  
  (
    

select t.*,b.book_date,b.total_amount 
,t.contact_data  -> 'phone' as phone_num
,t.contact_data  -> 'email' as email
from stg.bookings b
join stg.tickets t on b.book_ref =t.book_ref
  );
  
[0m19:28:55.912881 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 2.0 seconds
[0m19:28:55.912881 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:28:55.912881 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp" rename to "fact_tickets"
[0m19:28:55.912881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:55.912881 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:28:55.912881 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:28:55.912881 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:28:55.928503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:55.928503 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:28:55.928503 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_tickets__dbt_backup" cascade
[0m19:28:55.928503 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:28:55.928503 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (execute): 19:28:54.111526 => 19:28:55.928503
[0m19:28:55.928503 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: Close
[0m19:28:55.928503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB2AE6390>]}
[0m19:28:55.928503 [info ] [Thread-1 (]: 5 of 7 OK created sql table model flights_wh.fact_tickets ...................... [[32mSELECT 366733[0m in 1.82s]
[0m19:28:55.928503 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_tickets
[0m19:28:55.928503 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m19:28:55.928503 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m19:28:55.928503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_tickets, now model.flight_dbt.my_first_dbt_model)
[0m19:28:55.928503 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m19:28:55.946050 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m19:28:55.947045 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 19:28:55.928503 => 19:28:55.947045
[0m19:28:55.948045 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m19:28:55.969079 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m19:28:55.970081 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:28:55.971048 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m19:28:55.972048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:56.027729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:56.028709 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:28:56.028709 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:28:56.033755 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:56.036730 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:28:56.036730 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:28:56.038706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:56.042731 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:28:56.042731 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:28:56.043703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:56.045732 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:28:56.046731 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:28:56.046731 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:28:56.048447 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:56.051458 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:28:56.051458 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:28:56.053512 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:56.055459 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 19:28:55.948045 => 19:28:56.055459
[0m19:28:56.056478 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m19:28:56.057459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB2A73D90>]}
[0m19:28:56.058465 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.13s]
[0m19:28:56.060460 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m19:28:56.061472 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m19:28:56.062458 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:28:56.062984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m19:28:56.064020 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m19:28:56.067021 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m19:28:56.068020 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 19:28:56.064020 => 19:28:56.068020
[0m19:28:56.068020 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m19:28:56.071306 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m19:28:56.071306 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:28:56.071306 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m19:28:56.071306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:56.122723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:56.123732 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:28:56.124743 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:28:56.132261 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:56.135298 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:28:56.135298 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:28:56.136260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:56.138296 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:28:56.139296 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:28:56.139296 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:28:56.141263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:56.143295 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:28:56.144310 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:28:56.145262 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:56.146312 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 19:28:56.068996 => 19:28:56.146312
[0m19:28:56.147260 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m19:28:56.148260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '455b72ef-8303-4039-a095-6568103a22c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB2944F50>]}
[0m19:28:56.149269 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m19:28:56.151263 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m19:28:56.153261 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:56.153261 [debug] [MainThread]: On master: BEGIN
[0m19:28:56.153261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:56.201748 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:56.202749 [debug] [MainThread]: On master: COMMIT
[0m19:28:56.202749 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:56.202749 [debug] [MainThread]: On master: COMMIT
[0m19:28:56.203756 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:56.204755 [debug] [MainThread]: On master: Close
[0m19:28:56.205750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:56.206780 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m19:28:56.207754 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m19:28:56.209750 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m19:28:56.210751 [info ] [MainThread]: 
[0m19:28:56.211763 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 2 view models in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m19:28:56.213913 [debug] [MainThread]: Command end result
[0m19:28:56.222891 [info ] [MainThread]: 
[0m19:28:56.223879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:56.224878 [info ] [MainThread]: 
[0m19:28:56.225882 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:28:56.227909 [debug] [MainThread]: Command `dbt run` succeeded at 19:28:56.227909 after 5.80 seconds
[0m19:28:56.227909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AABBE9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AABC2A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AABC2AE10>]}
[0m19:28:56.228919 [debug] [MainThread]: Flushing usage events
[0m19:30:23.398607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3287DFD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F32878AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3288609D0>]}


============================== 19:30:23.414236 | 2005b1f2-4a39-440e-aac0-22e41dccf1db ==============================
[0m19:30:23.414236 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:30:23.414236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:30:23.498036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F328AA3750>]}
[0m19:30:23.521037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F328941B90>]}
[0m19:30:23.523042 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m19:30:23.536030 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:30:23.607103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:30:23.608108 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\facts\schema.yml
[0m19:30:23.664509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F329197E50>]}
[0m19:30:23.664509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F329219590>]}
[0m19:30:23.664509 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:30:23.664509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F324F18590>]}
[0m19:30:23.680137 [info ] [MainThread]: 
[0m19:30:23.680137 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:23.680137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:30:23.680137 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:30:23.680137 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:30:23.680137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:23.761638 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:30:23.763674 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:30:23.765638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m19:30:23.772672 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:30:23.772672 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:30:23.773674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:23.815435 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:23.815435 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:30:23.815435 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:30:23.815435 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:30:23.815435 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:30:23.831645 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:30:23.837651 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:23.838651 [debug] [MainThread]: On master: BEGIN
[0m19:30:23.838651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:23.880552 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:23.880552 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:23.880552 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:23.896230 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:30:23.911813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3289DAA50>]}
[0m19:30:23.911813 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:23.911813 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:23.911813 [debug] [MainThread]: On master: BEGIN
[0m19:30:23.911813 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:23.911813 [debug] [MainThread]: On master: COMMIT
[0m19:30:23.911813 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:23.911813 [debug] [MainThread]: On master: COMMIT
[0m19:30:23.911813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:23.911813 [debug] [MainThread]: On master: Close
[0m19:30:23.911813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:30:23.911813 [info ] [MainThread]: 
[0m19:30:23.927438 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m19:30:23.928410 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m19:30:23.929417 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m19:30:23.930441 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m19:30:23.935449 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m19:30:23.937422 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 19:30:23.930441 => 19:30:23.936423
[0m19:30:23.937422 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m19:30:24.006607 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:30:24.007608 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp193023971611"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 16:30:23' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m19:30:24.007608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:30:24.061601 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:30:24.065182 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:30:24.065182 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m19:30:24.065182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:24.065182 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:30:24.065182 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp193023971611'
        
      order by ordinal_position

  
[0m19:30:24.080690 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:30:24.080690 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:30:24.080690 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:30:24.096367 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:30:24.096367 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:30:24.096367 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:30:24.096367 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:30:24.127621 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m19:30:24.127621 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:30:24.127621 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp193023971611"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp193023971611"
    )
  
[0m19:30:24.127621 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m19:30:24.143250 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:30:24.143250 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m19:30:24.143250 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m19:30:24.158867 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:30:24.158867 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:30:24.158867 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:30:24.166740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:24.166740 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 19:30:23.938420 => 19:30:24.166740
[0m19:30:24.166740 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m19:30:24.166740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F328F05750>]}
[0m19:30:24.166740 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.24s]
[0m19:30:24.166740 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m19:30:24.174783 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m19:30:24.174783 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m19:30:24.174783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m19:30:24.174783 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m19:30:24.174783 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m19:30:24.174783 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 19:30:24.174783 => 19:30:24.174783
[0m19:30:24.174783 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m19:30:24.174783 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:30:24.174783 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp193024174783"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 16:30:23' as run_time
from stg.airports_data
  );
  
  
[0m19:30:24.174783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:24.248117 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:30:24.254181 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:30:24.255159 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m19:30:24.256105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:24.257141 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:30:24.257141 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp193024174783'
        
      order by ordinal_position

  
[0m19:30:24.275298 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:30:24.279290 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:30:24.279290 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:30:24.283290 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:30:24.287287 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:30:24.287287 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:30:24.291301 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:30:24.294296 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m19:30:24.295307 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:30:24.296263 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp193024174783"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp193024174783"
    )
  
[0m19:30:24.298360 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m19:30:24.298360 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:30:24.298360 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m19:30:24.298360 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m19:30:24.298360 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m19:30:24.298360 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:30:24.298360 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m19:30:24.298360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:24.298360 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 19:30:24.174783 => 19:30:24.298360
[0m19:30:24.298360 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m19:30:24.298360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F32936CD50>]}
[0m19:30:24.298360 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.12s]
[0m19:30:24.298360 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m19:30:24.298360 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_boarding_passes
[0m19:30:24.313989 [info ] [Thread-1 (]: 3 of 7 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:30:24.313989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_boarding_passes)
[0m19:30:24.313989 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_boarding_passes
[0m19:30:24.313989 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_boarding_passes"
[0m19:30:24.313989 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (compile): 19:30:24.313989 => 19:30:24.313989
[0m19:30:24.313989 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_boarding_passes
[0m19:30:24.335997 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_boarding_passes"
[0m19:30:24.337993 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:30:24.337993 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: BEGIN
[0m19:30:24.339001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:24.388339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:24.388339 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:30:24.389336 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select bp.ticket_no,bp.flight_id,bp.boarding_no,bp.seat_no,
tf.fare_conditions,tf.amount,bp.last_update as bp_last_update,tf.last_update as tf_last_update
,'23-08-15 16:30:23' as run_time
from stg.boarding_passes bp
join stg.ticket_flights tf on bp.ticket_no=tf.ticket_no and bp.flight_id =tf.flight_id
  );
  
[0m19:30:26.732101 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 2.0 seconds
[0m19:30:26.732101 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:30:26.732101 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m19:30:26.747729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:26.747729 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:30:26.747729 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m19:30:26.747729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:26.747729 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:30:26.747729 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:30:26.747729 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:30:26.763355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:26.763355 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:30:26.763355 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m19:30:26.778975 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:26.778975 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (execute): 19:30:24.313989 => 19:30:26.778975
[0m19:30:26.778975 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: Close
[0m19:30:26.778975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F32941B350>]}
[0m19:30:26.778975 [info ] [Thread-1 (]: 3 of 7 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 2.46s]
[0m19:30:26.778975 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_boarding_passes
[0m19:30:26.778975 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m19:30:26.778975 [info ] [Thread-1 (]: 4 of 7 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m19:30:26.778975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_boarding_passes, now model.flight_dbt.fact_flights)
[0m19:30:26.794603 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m19:30:26.794603 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m19:30:26.794603 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 19:30:26.794603 => 19:30:26.794603
[0m19:30:26.794603 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m19:30:26.794603 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m19:30:26.794603 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:30:26.794603 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m19:30:26.794603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:26.857906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:26.858919 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:30:26.858919 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-15 16:30:23' as run_time
from cte2
  );
  
[0m19:30:27.159126 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m19:30:27.162757 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:30:27.162757 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m19:30:27.162757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:27.162757 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:30:27.162757 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m19:30:27.162757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:27.162757 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:30:27.162757 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:30:27.162757 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:30:27.162757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:27.177815 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:30:27.185242 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m19:30:27.198687 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:27.202737 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 19:30:26.794603 => 19:30:27.202737
[0m19:30:27.203737 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m19:30:27.205681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F32940B310>]}
[0m19:30:27.207677 [info ] [Thread-1 (]: 4 of 7 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.43s]
[0m19:30:27.210682 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m19:30:27.211680 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_tickets
[0m19:30:27.212809 [info ] [Thread-1 (]: 5 of 7 START sql table model flights_wh.fact_tickets ........................... [RUN]
[0m19:30:27.212809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.fact_tickets)
[0m19:30:27.212809 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_tickets
[0m19:30:27.212809 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_tickets"
[0m19:30:27.212809 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (compile): 19:30:27.212809 => 19:30:27.212809
[0m19:30:27.212809 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_tickets
[0m19:30:27.212809 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_tickets"
[0m19:30:27.212809 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:30:27.212809 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: BEGIN
[0m19:30:27.212809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:27.278319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:27.279323 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:30:27.280326 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp"
  
  
    as
  
  (
    

select t.*,b.book_date,b.total_amount 
,t.contact_data  -> 'phone' as phone_num
,t.contact_data  -> 'email' as email
from stg.bookings b
join stg.tickets t on b.book_ref =t.book_ref
  );
  
[0m19:30:29.081297 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 2.0 seconds
[0m19:30:29.081297 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:30:29.081297 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets" rename to "fact_tickets__dbt_backup"
[0m19:30:29.081297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:29.081297 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:30:29.081297 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp" rename to "fact_tickets"
[0m19:30:29.081297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:29.081297 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:30:29.081297 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:30:29.096925 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:30:29.096925 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:29.096925 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:30:29.096925 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_tickets__dbt_backup" cascade
[0m19:30:29.112546 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:29.112546 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (execute): 19:30:27.212809 => 19:30:29.112546
[0m19:30:29.112546 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: Close
[0m19:30:29.112546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F329415210>]}
[0m19:30:29.112546 [info ] [Thread-1 (]: 5 of 7 OK created sql table model flights_wh.fact_tickets ...................... [[32mSELECT 366733[0m in 1.90s]
[0m19:30:29.112546 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_tickets
[0m19:30:29.112546 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m19:30:29.112546 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m19:30:29.128886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_tickets, now model.flight_dbt.my_first_dbt_model)
[0m19:30:29.129901 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m19:30:29.131899 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m19:30:29.132898 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 19:30:29.129901 => 19:30:29.132898
[0m19:30:29.133899 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m19:30:29.155899 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m19:30:29.156899 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:30:29.157900 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m19:30:29.157900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:29.205548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:29.206548 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:30:29.206548 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:30:29.213622 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:29.216600 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:30:29.217561 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:30:29.218562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:29.221595 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:30:29.221595 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:30:29.222561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:29.224599 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:30:29.225561 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:30:29.225561 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:30:29.228050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:29.232066 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:30:29.233066 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:30:29.234958 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:29.235969 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 19:30:29.133899 => 19:30:29.235969
[0m19:30:29.236969 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m19:30:29.237967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F328B95190>]}
[0m19:30:29.238970 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.11s]
[0m19:30:29.240970 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m19:30:29.242003 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m19:30:29.242968 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:30:29.244315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m19:30:29.244315 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m19:30:29.244315 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m19:30:29.244315 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 19:30:29.244315 => 19:30:29.244315
[0m19:30:29.244315 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m19:30:29.244315 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m19:30:29.244315 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:30:29.244315 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m19:30:29.244315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:29.303521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:29.304521 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:30:29.304521 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:30:29.310659 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:29.314715 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:30:29.315662 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:30:29.316679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:29.318695 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:30:29.319694 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:30:29.319694 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:30:29.321662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:29.324693 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:30:29.324693 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:30:29.325697 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:29.327661 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 19:30:29.244315 => 19:30:29.327661
[0m19:30:29.327661 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m19:30:29.328662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2005b1f2-4a39-440e-aac0-22e41dccf1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F329226B90>]}
[0m19:30:29.329661 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.08s]
[0m19:30:29.331661 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m19:30:29.333664 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:29.334696 [debug] [MainThread]: On master: BEGIN
[0m19:30:29.334696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:29.385644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:29.386663 [debug] [MainThread]: On master: COMMIT
[0m19:30:29.386663 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:29.386663 [debug] [MainThread]: On master: COMMIT
[0m19:30:29.387656 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:29.388656 [debug] [MainThread]: On master: Close
[0m19:30:29.388656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:29.389656 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m19:30:29.389656 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m19:30:29.390655 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m19:30:29.390655 [info ] [MainThread]: 
[0m19:30:29.391655 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 2 view models in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m19:30:29.393656 [debug] [MainThread]: Command end result
[0m19:30:29.403656 [info ] [MainThread]: 
[0m19:30:29.404578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:29.405739 [info ] [MainThread]: 
[0m19:30:29.406750 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:30:29.407752 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:29.407752 after 6.01 seconds
[0m19:30:29.408786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F328878D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F328A8B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3225DA210>]}
[0m19:30:29.408786 [debug] [MainThread]: Flushing usage events
[0m19:31:01.294120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA3CFA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA26A750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA543C10>]}


============================== 19:31:01.294120 | 2b9410e5-849e-4fe3-b2d0-fcb54b9018c0 ==============================
[0m19:31:01.294120 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:31:01.294120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:31:01.384999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA2D6050>]}
[0m19:31:01.404997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA2D6050>]}
[0m19:31:01.406684 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m19:31:01.419994 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:31:01.490020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:31:01.490992 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\facts\fact_tickets.sql
[0m19:31:01.516035 [debug] [MainThread]: 1603: static parser failed on facts\fact_tickets.sql
[0m19:31:01.533199 [debug] [MainThread]: 1602: parser fallback to jinja rendering on facts\fact_tickets.sql
[0m19:31:01.580128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FADD7890>]}
[0m19:31:01.595753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA258150>]}
[0m19:31:01.595753 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:31:01.595753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290F69A8710>]}
[0m19:31:01.595753 [info ] [MainThread]: 
[0m19:31:01.595753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:31:01.595753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:31:01.619620 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:31:01.620637 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:31:01.621646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:01.682763 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:31:01.683775 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:31:01.687796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m19:31:01.694774 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:31:01.694774 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:31:01.695775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:01.734122 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:31:01.734122 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:31:01.734122 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:31:01.734122 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:31:01.749752 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:31:01.749752 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:31:01.749752 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:01.749752 [debug] [MainThread]: On master: BEGIN
[0m19:31:01.749752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:31:01.796626 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:31:01.796626 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:01.796626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:31:01.827914 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:31:01.827914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA25AB50>]}
[0m19:31:01.827914 [debug] [MainThread]: On master: ROLLBACK
[0m19:31:01.843510 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:01.843510 [debug] [MainThread]: On master: BEGIN
[0m19:31:01.843510 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:31:01.843510 [debug] [MainThread]: On master: COMMIT
[0m19:31:01.843510 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:01.843510 [debug] [MainThread]: On master: COMMIT
[0m19:31:01.843510 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:31:01.843510 [debug] [MainThread]: On master: Close
[0m19:31:01.843510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:31:01.843510 [info ] [MainThread]: 
[0m19:31:01.843510 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m19:31:01.843510 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m19:31:01.860139 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m19:31:01.860139 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m19:31:01.864154 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m19:31:01.866157 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 19:31:01.861148 => 19:31:01.865154
[0m19:31:01.866157 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m19:31:01.951503 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:31:01.952504 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp193101911502"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-15 16:31:01' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m19:31:01.952504 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:31:01.998618 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:31:02.014256 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:31:02.014256 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m19:31:02.014256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:31:02.014256 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:31:02.014256 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp193101911502'
        
      order by ordinal_position

  
[0m19:31:02.029890 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:31:02.029890 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:31:02.029890 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:31:02.045546 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:31:02.045546 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:31:02.045546 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:31:02.045546 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:31:02.076758 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m19:31:02.076758 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:31:02.076758 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp193101911502"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp193101911502"
    )
  
[0m19:31:02.076758 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m19:31:02.092381 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:31:02.108008 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m19:31:02.108008 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m19:31:02.108008 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:31:02.108008 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:31:02.108008 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:31:02.108008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:31:02.108008 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 19:31:01.867503 => 19:31:02.108008
[0m19:31:02.108008 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m19:31:02.108008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FACD5790>]}
[0m19:31:02.108008 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.25s]
[0m19:31:02.108008 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m19:31:02.108008 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m19:31:02.108008 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m19:31:02.123635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m19:31:02.123635 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m19:31:02.123635 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m19:31:02.123635 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 19:31:02.123635 => 19:31:02.123635
[0m19:31:02.123635 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m19:31:02.123635 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:31:02.123635 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp193102123635"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-15 16:31:01' as run_time
from stg.airports_data
  );
  
  
[0m19:31:02.123635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:02.198143 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:31:02.201148 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:31:02.203202 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m19:31:02.205196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:31:02.206190 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:31:02.206190 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp193102123635'
        
      order by ordinal_position

  
[0m19:31:02.226479 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:31:02.229505 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:31:02.230509 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:31:02.235095 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:31:02.238111 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:31:02.239066 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:31:02.242912 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:31:02.245922 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m19:31:02.246923 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:31:02.247923 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp193102123635"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp193102123635"
    )
  
[0m19:31:02.250698 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m19:31:02.250698 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:31:02.250698 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m19:31:02.250698 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m19:31:02.250698 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m19:31:02.250698 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:31:02.250698 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m19:31:02.250698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:31:02.250698 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 19:31:02.123635 => 19:31:02.250698
[0m19:31:02.250698 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m19:31:02.250698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FAE433D0>]}
[0m19:31:02.250698 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.14s]
[0m19:31:02.265708 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m19:31:02.265708 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_boarding_passes
[0m19:31:02.265708 [info ] [Thread-1 (]: 3 of 7 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:31:02.265708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_boarding_passes)
[0m19:31:02.265708 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_boarding_passes
[0m19:31:02.265708 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_boarding_passes"
[0m19:31:02.265708 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (compile): 19:31:02.265708 => 19:31:02.265708
[0m19:31:02.265708 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_boarding_passes
[0m19:31:02.290794 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_boarding_passes"
[0m19:31:02.292778 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:31:02.293808 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: BEGIN
[0m19:31:02.293808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:02.343915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:31:02.344952 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:31:02.344952 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select bp.ticket_no,bp.flight_id,bp.boarding_no,bp.seat_no,
tf.fare_conditions,tf.amount,bp.last_update as bp_last_update,tf.last_update as tf_last_update
,'23-08-15 16:31:01' as run_time
from stg.boarding_passes bp
join stg.ticket_flights tf on bp.ticket_no=tf.ticket_no and bp.flight_id =tf.flight_id
  );
  
[0m19:31:04.753330 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 2.0 seconds
[0m19:31:04.769009 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:31:04.769009 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m19:31:04.769009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:31:04.769009 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:31:04.769009 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m19:31:04.769009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:31:04.784622 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:31:04.784622 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:31:04.784622 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:31:04.784622 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:31:04.800238 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:31:04.800238 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m19:31:04.800238 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:31:04.800238 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (execute): 19:31:02.265708 => 19:31:04.800238
[0m19:31:04.800238 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: Close
[0m19:31:04.800238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FAEC6B50>]}
[0m19:31:04.815883 [info ] [Thread-1 (]: 3 of 7 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 2.53s]
[0m19:31:04.815883 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_boarding_passes
[0m19:31:04.815883 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m19:31:04.815883 [info ] [Thread-1 (]: 4 of 7 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m19:31:04.815883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_boarding_passes, now model.flight_dbt.fact_flights)
[0m19:31:04.815883 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m19:31:04.815883 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m19:31:04.815883 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 19:31:04.815883 => 19:31:04.815883
[0m19:31:04.815883 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m19:31:04.815883 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m19:31:04.831462 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:31:04.832724 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m19:31:04.832724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:04.886886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:31:04.887975 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:31:04.887975 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-15 16:31:01' as run_time
from cte2
  );
  
[0m19:31:05.181388 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m19:31:05.197047 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:31:05.197047 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m19:31:05.197047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:31:05.197047 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:31:05.197047 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m19:31:05.197047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:31:05.197047 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:31:05.197047 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:31:05.197047 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:31:05.212632 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:31:05.212632 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:31:05.212632 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m19:31:05.212632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:31:05.212632 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 19:31:04.815883 => 19:31:05.212632
[0m19:31:05.212632 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m19:31:05.228262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FAE67290>]}
[0m19:31:05.228262 [info ] [Thread-1 (]: 4 of 7 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.41s]
[0m19:31:05.228262 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m19:31:05.228262 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_tickets
[0m19:31:05.228262 [info ] [Thread-1 (]: 5 of 7 START sql table model flights_wh.fact_tickets ........................... [RUN]
[0m19:31:05.228262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.fact_tickets)
[0m19:31:05.228262 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_tickets
[0m19:31:05.228262 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_tickets"
[0m19:31:05.228262 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (compile): 19:31:05.228262 => 19:31:05.228262
[0m19:31:05.228262 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_tickets
[0m19:31:05.243920 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_tickets"
[0m19:31:05.246644 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:31:05.247643 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: BEGIN
[0m19:31:05.247643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:05.297120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:31:05.298124 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:31:05.299122 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp"
  
  
    as
  
  (
    

select t.*,b.book_date,b.total_amount 
,t.contact_data  -> 'phone' as phone_num
,t.contact_data  -> 'email' as email
,'23-08-15 16:31:01' as run_time
from stg.bookings b
join stg.tickets t on b.book_ref =t.book_ref
  );
  
[0m19:31:07.638480 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 2.0 seconds
[0m19:31:07.638480 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:31:07.638480 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets" rename to "fact_tickets__dbt_backup"
[0m19:31:08.659045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.0 seconds
[0m19:31:08.659045 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:31:08.659045 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp" rename to "fact_tickets"
[0m19:31:08.659045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:31:08.674672 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:31:08.674672 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:31:08.674672 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:31:08.674672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:31:08.674672 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:31:08.674672 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_tickets__dbt_backup" cascade
[0m19:31:08.690339 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:31:08.690339 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (execute): 19:31:05.228262 => 19:31:08.690339
[0m19:31:08.690339 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: Close
[0m19:31:08.690339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FAE8B190>]}
[0m19:31:08.705925 [info ] [Thread-1 (]: 5 of 7 OK created sql table model flights_wh.fact_tickets ...................... [[32mSELECT 366733[0m in 3.46s]
[0m19:31:08.705925 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_tickets
[0m19:31:08.705925 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m19:31:08.705925 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m19:31:08.714534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_tickets, now model.flight_dbt.my_first_dbt_model)
[0m19:31:08.715546 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m19:31:08.721544 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m19:31:08.724556 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 19:31:08.716550 => 19:31:08.723548
[0m19:31:08.725547 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m19:31:08.772544 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m19:31:08.773544 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:31:08.774545 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m19:31:08.775544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:08.828257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:31:08.828257 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:31:08.828257 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:31:08.828257 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:31:08.828257 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:31:08.828257 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:31:08.828257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:31:08.843276 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:31:08.843276 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:31:08.843276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:31:08.843276 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:31:08.843276 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:31:08.843276 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:31:08.843276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:31:08.843276 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:31:08.843276 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:31:08.843276 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:31:08.858920 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 19:31:08.725547 => 19:31:08.843276
[0m19:31:08.858920 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m19:31:08.858920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA2F64D0>]}
[0m19:31:08.858920 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.15s]
[0m19:31:08.858920 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m19:31:08.858920 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m19:31:08.858920 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:31:08.858920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m19:31:08.858920 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m19:31:08.858920 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m19:31:08.858920 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 19:31:08.858920 => 19:31:08.858920
[0m19:31:08.858920 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m19:31:08.876686 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m19:31:08.878684 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:31:08.879684 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m19:31:08.880681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:08.935535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:31:08.935535 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:31:08.936499 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:31:08.941499 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:31:08.944533 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:31:08.945502 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:31:08.947553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:31:08.951500 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:31:08.951500 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:31:08.952536 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:31:08.954498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:31:08.957536 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:31:08.957536 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:31:08.958535 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:31:08.960533 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 19:31:08.858920 => 19:31:08.960533
[0m19:31:08.961502 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m19:31:08.962502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b9410e5-849e-4fe3-b2d0-fcb54b9018c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FAEA2D10>]}
[0m19:31:08.964510 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m19:31:08.966499 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m19:31:08.970499 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:08.971537 [debug] [MainThread]: On master: BEGIN
[0m19:31:08.971537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:31:09.023585 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:31:09.024552 [debug] [MainThread]: On master: COMMIT
[0m19:31:09.024552 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:09.025552 [debug] [MainThread]: On master: COMMIT
[0m19:31:09.025552 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:31:09.026548 [debug] [MainThread]: On master: Close
[0m19:31:09.027552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:09.028548 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m19:31:09.029584 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m19:31:09.029584 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m19:31:09.030567 [info ] [MainThread]: 
[0m19:31:09.032614 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 2 view models in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m19:31:09.036015 [debug] [MainThread]: Command end result
[0m19:31:09.043976 [info ] [MainThread]: 
[0m19:31:09.045946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:31:09.046942 [info ] [MainThread]: 
[0m19:31:09.048955 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:31:09.050941 [debug] [MainThread]: Command `dbt run` succeeded at 19:31:09.050941 after 7.77 seconds
[0m19:31:09.051994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA2ED890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290FA7EC090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290F4290290>]}
[0m19:31:09.051994 [debug] [MainThread]: Flushing usage events
[0m19:07:33.453684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618927B210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261892E63D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026188F88F10>]}


============================== 19:07:33.459277 | 75dc87e9-5765-4051-a7c8-66db8c4618a9 ==============================
[0m19:07:33.459277 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:07:33.460242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:07:33.603068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026188F9E590>]}
[0m19:07:33.621793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026188FA83D0>]}
[0m19:07:33.623754 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m19:07:33.646560 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:07:34.295694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:07:34.297211 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\dim_airport.sql
[0m19:07:34.324261 [debug] [MainThread]: 1603: static parser failed on dimentions\dim_airport.sql
[0m19:07:34.348375 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimentions\dim_airport.sql
[0m19:07:34.407603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026189572C50>]}
[0m19:07:34.418876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026189A06250>]}
[0m19:07:34.419878 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:07:34.420880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261856D8710>]}
[0m19:07:34.422875 [info ] [MainThread]: 
[0m19:07:34.424875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:07:34.426387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:07:34.446273 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:07:34.448286 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:07:34.449287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:34.530746 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:07:34.531745 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:07:34.534257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m19:07:34.541772 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:07:34.542772 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:07:34.542772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:34.594043 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:07:34.596571 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:07:34.597575 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:07:34.617698 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:07:34.619696 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:07:34.620734 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:07:34.627247 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:34.628286 [debug] [MainThread]: On master: BEGIN
[0m19:07:34.628286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:34.677357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:07:34.678400 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:34.679368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:07:34.716619 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:07:34.719585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618999BE50>]}
[0m19:07:34.719585 [debug] [MainThread]: On master: ROLLBACK
[0m19:07:34.720623 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:34.720623 [debug] [MainThread]: On master: BEGIN
[0m19:07:34.721620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:07:34.722584 [debug] [MainThread]: On master: COMMIT
[0m19:07:34.722584 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:34.723585 [debug] [MainThread]: On master: COMMIT
[0m19:07:34.724591 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:07:34.725588 [debug] [MainThread]: On master: Close
[0m19:07:34.728121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:07:34.729139 [info ] [MainThread]: 
[0m19:07:34.739856 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m19:07:34.740886 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m19:07:34.741856 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m19:07:34.741856 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m19:07:34.744883 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m19:07:34.747889 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 19:07:34.742884 => 19:07:34.746883
[0m19:07:34.747889 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m19:07:34.834708 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:07:34.835729 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp190734793001"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-16 16:07:33' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m19:07:34.837014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:07:34.909741 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:07:34.917006 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:07:34.918001 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m19:07:34.919004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:07:34.920011 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:07:34.921011 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp190734793001'
        
      order by ordinal_position

  
[0m19:07:34.948733 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:07:34.953715 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:07:34.954717 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:07:34.958821 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:07:34.970397 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:07:34.970397 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:07:34.976167 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:07:35.001282 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m19:07:35.003247 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:07:35.003247 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp190734793001"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp190734793001"
    )
  
[0m19:07:35.010793 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m19:07:35.028926 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:07:35.029929 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m19:07:35.030932 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m19:07:35.032895 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:07:35.034325 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:07:35.035843 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:07:35.040914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:07:35.041864 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 19:07:34.748885 => 19:07:35.041864
[0m19:07:35.042897 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m19:07:35.043862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026188F89410>]}
[0m19:07:35.044862 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.30s]
[0m19:07:35.045863 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m19:07:35.047385 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m19:07:35.048394 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m19:07:35.050400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m19:07:35.051396 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m19:07:35.054397 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m19:07:35.057954 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 19:07:35.051396 => 19:07:35.056956
[0m19:07:35.057954 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m19:07:35.065965 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:07:35.067497 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp190735061962"
  
  
    as
  
  (
    


select *
,airport_name  ->>'en' as english_airport_name
,airport_name  ->>'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-16 16:07:33' as run_time
from stg.airports_data
  );
  
  
[0m19:07:35.070511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:35.138493 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:07:35.142527 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:07:35.142527 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m19:07:35.143495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:07:35.144494 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:07:35.144494 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp190735061962'
        
      order by ordinal_position

  
[0m19:07:35.162535 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:07:35.166110 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:07:35.167118 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:07:35.171128 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:07:35.174164 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:07:35.174164 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:07:35.178737 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:07:35.181774 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m19:07:35.183738 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:07:35.183738 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp190735061962"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp190735061962"
    )
  
[0m19:07:35.192261 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "english_airport_name" is of type jsonb but expression is of type text
LINE 17: ..."city", "coordinates", "timezone", "last_update", "english_a...
                                                              ^
HINT:  You will need to rewrite or cast the expression.

[0m19:07:35.193259 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: ROLLBACK
[0m19:07:35.194259 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 19:07:35.058991 => 19:07:35.194259
[0m19:07:35.194259 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m19:07:35.293389 [debug] [Thread-1 (]: Database Error in model dim_airport (models\dimentions\dim_airport.sql)
  column "english_airport_name" is of type jsonb but expression is of type text
  LINE 17: ..."city", "coordinates", "timezone", "last_update", "english_a...
                                                                ^
  HINT:  You will need to rewrite or cast the expression.
  compiled Code at target\run\flight_dbt\models\dimentions\dim_airport.sql
[0m19:07:35.294378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026189B2FF50>]}
[0m19:07:35.294378 [error] [Thread-1 (]: 2 of 7 ERROR creating sql incremental model flights_wh.dim_airport ............. [[31mERROR[0m in 0.24s]
[0m19:07:35.295884 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m19:07:35.296895 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_boarding_passes
[0m19:07:35.297892 [info ] [Thread-1 (]: 3 of 7 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:07:35.298891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_boarding_passes)
[0m19:07:35.298891 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_boarding_passes
[0m19:07:35.301924 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_boarding_passes"
[0m19:07:35.303891 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (compile): 19:07:35.299926 => 19:07:35.302929
[0m19:07:35.303891 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_boarding_passes
[0m19:07:35.322965 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_boarding_passes"
[0m19:07:35.324969 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:07:35.325973 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: BEGIN
[0m19:07:35.326488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:35.379228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:07:35.380264 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:07:35.381229 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select bp.ticket_no,bp.flight_id,bp.boarding_no,bp.seat_no,
tf.fare_conditions,tf.amount,bp.last_update as bp_last_update,tf.last_update as tf_last_update
,'23-08-16 16:07:33' as run_time
from stg.boarding_passes bp
join stg.ticket_flights tf on bp.ticket_no=tf.ticket_no and bp.flight_id =tf.flight_id
  );
  
[0m19:07:38.148595 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 3.0 seconds
[0m19:07:38.157959 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:07:38.158956 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m19:07:38.159922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:07:38.163957 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:07:38.163957 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m19:07:38.167056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:07:38.174091 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:07:38.175635 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:07:38.176644 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:07:38.182649 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:07:38.191257 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:07:38.192257 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m19:07:38.197771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:07:38.199772 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (execute): 19:07:35.304891 => 19:07:38.199772
[0m19:07:38.200810 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: Close
[0m19:07:38.201796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026189BE9550>]}
[0m19:07:38.202773 [info ] [Thread-1 (]: 3 of 7 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 2.90s]
[0m19:07:38.204771 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_boarding_passes
[0m19:07:38.204771 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m19:07:38.206276 [info ] [Thread-1 (]: 4 of 7 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m19:07:38.207285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_boarding_passes, now model.flight_dbt.fact_flights)
[0m19:07:38.207285 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m19:07:38.211328 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m19:07:38.212296 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 19:07:38.208303 => 19:07:38.212296
[0m19:07:38.213292 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m19:07:38.220870 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m19:07:38.221869 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:07:38.222873 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m19:07:38.223876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:38.374641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:07:38.375674 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:07:38.376180 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-16 16:07:33' as run_time
from cte2
  );
  
[0m19:07:38.721214 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m19:07:38.724249 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:07:38.724249 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m19:07:38.725754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:07:38.729764 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:07:38.730764 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m19:07:38.732763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:07:38.734796 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:07:38.736328 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:07:38.736328 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:07:38.745871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:07:38.747879 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:07:38.748905 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m19:07:38.755882 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:07:38.758481 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 19:07:38.213292 => 19:07:38.757484
[0m19:07:38.759457 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m19:07:38.761437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026189FEBC10>]}
[0m19:07:38.762438 [info ] [Thread-1 (]: 4 of 7 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.55s]
[0m19:07:38.763442 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m19:07:38.764436 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_tickets
[0m19:07:38.764436 [info ] [Thread-1 (]: 5 of 7 START sql table model flights_wh.fact_tickets ........................... [RUN]
[0m19:07:38.766956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.fact_tickets)
[0m19:07:38.767997 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_tickets
[0m19:07:38.770955 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_tickets"
[0m19:07:38.772957 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (compile): 19:07:38.767997 => 19:07:38.771995
[0m19:07:38.773957 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_tickets
[0m19:07:38.779514 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_tickets"
[0m19:07:38.782498 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:07:38.783486 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: BEGIN
[0m19:07:38.784483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:38.897036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:07:38.898036 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:07:38.899037 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp"
  
  
    as
  
  (
    

select t.*,b.book_date,b.total_amount 
,t.contact_data  -> 'phone' as phone_num
,t.contact_data  -> 'email' as email
,'23-08-16 16:07:33' as run_time
from stg.bookings b
join stg.tickets t on b.book_ref =t.book_ref
  );
  
[0m19:07:41.619234 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 3.0 seconds
[0m19:07:41.624232 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:07:41.625811 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets" rename to "fact_tickets__dbt_backup"
[0m19:07:41.627768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:07:41.636292 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:07:41.637320 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp" rename to "fact_tickets"
[0m19:07:41.639831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:07:41.646362 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:07:41.648399 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:07:41.650394 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:07:41.654396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:07:41.662927 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:07:41.664930 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_tickets__dbt_backup" cascade
[0m19:07:41.680872 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:07:41.687449 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (execute): 19:07:38.773957 => 19:07:41.686422
[0m19:07:41.689465 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: Close
[0m19:07:41.692470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026189975C10>]}
[0m19:07:41.694461 [info ] [Thread-1 (]: 5 of 7 OK created sql table model flights_wh.fact_tickets ...................... [[32mSELECT 366733[0m in 2.93s]
[0m19:07:41.699020 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_tickets
[0m19:07:41.701019 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m19:07:41.703019 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m19:07:41.709565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_tickets, now model.flight_dbt.my_first_dbt_model)
[0m19:07:41.711569 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m19:07:41.723169 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m19:07:41.725736 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 19:07:41.712567 => 19:07:41.724166
[0m19:07:41.727699 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m19:07:41.785683 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m19:07:41.788660 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:07:41.789672 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m19:07:41.790656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:41.903582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:07:41.905579 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:07:41.907131 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:07:41.924716 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:07:41.933237 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:07:41.934238 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:07:41.937764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:07:41.944283 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:07:41.945796 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:07:41.948828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:07:41.953823 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:07:41.954824 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:07:41.956333 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:07:41.960362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:07:41.970933 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:07:41.971932 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:07:41.978535 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:07:41.983545 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 19:07:41.728714 => 19:07:41.983545
[0m19:07:41.985540 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m19:07:41.988723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026189B22610>]}
[0m19:07:41.991712 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.28s]
[0m19:07:41.997264 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m19:07:42.001281 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m19:07:42.003280 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:07:42.005801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m19:07:42.006815 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m19:07:42.014838 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m19:07:42.021379 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 19:07:42.007821 => 19:07:42.019384
[0m19:07:42.024381 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m19:07:42.044787 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m19:07:42.056863 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:07:42.059886 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m19:07:42.060882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:42.151572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:07:42.152578 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:07:42.154577 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:07:42.169670 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:07:42.173662 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:07:42.174662 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:07:42.177209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:07:42.181223 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:07:42.182226 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:07:42.183226 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:07:42.186756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:07:42.190770 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:07:42.191768 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:07:42.192772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:07:42.195767 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 19:07:42.024381 => 19:07:42.194768
[0m19:07:42.196832 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m19:07:42.197826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dc87e9-5765-4051-a7c8-66db8c4618a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618998F1D0>]}
[0m19:07:42.199837 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.19s]
[0m19:07:42.201840 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m19:07:42.203839 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:42.204836 [debug] [MainThread]: On master: BEGIN
[0m19:07:42.206354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:07:42.305586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:07:42.307829 [debug] [MainThread]: On master: COMMIT
[0m19:07:42.308851 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:42.308851 [debug] [MainThread]: On master: COMMIT
[0m19:07:42.309853 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:07:42.310845 [debug] [MainThread]: On master: Close
[0m19:07:42.311845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:42.312854 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m19:07:42.313845 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m19:07:42.314847 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m19:07:42.314847 [info ] [MainThread]: 
[0m19:07:42.315845 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 2 view models in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m19:07:42.320336 [debug] [MainThread]: Command end result
[0m19:07:42.331865 [info ] [MainThread]: 
[0m19:07:42.332860 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:07:42.333862 [info ] [MainThread]: 
[0m19:07:42.335864 [error] [MainThread]: [33mDatabase Error in model dim_airport (models\dimentions\dim_airport.sql)[0m
[0m19:07:42.337393 [error] [MainThread]:   column "english_airport_name" is of type jsonb but expression is of type text
[0m19:07:42.339392 [error] [MainThread]:   LINE 17: ..."city", "coordinates", "timezone", "last_update", "english_a...
[0m19:07:42.341095 [error] [MainThread]:                                                                 ^
[0m19:07:42.342938 [error] [MainThread]:   HINT:  You will need to rewrite or cast the expression.
[0m19:07:42.343943 [error] [MainThread]:   compiled Code at target\run\flight_dbt\models\dimentions\dim_airport.sql
[0m19:07:42.344935 [info ] [MainThread]: 
[0m19:07:42.346448 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m19:07:42.349485 [debug] [MainThread]: Command `dbt run` failed at 19:07:42.348504 after 8.93 seconds
[0m19:07:42.350481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026189353450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026182DCAE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026182DCA210>]}
[0m19:07:42.351480 [debug] [MainThread]: Flushing usage events
[0m19:08:05.353521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268927469D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026892A1BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026892CEBC10>]}


============================== 19:08:05.359787 | 816d4a8e-4ade-4328-b7be-d4aa99b8e11b ==============================
[0m19:08:05.359787 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:08:05.362790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flight_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\oa\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:08:05.509490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026892AAB210>]}
[0m19:08:05.544082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026892A10C90>]}
[0m19:08:05.546607 [info ] [MainThread]: Registered adapter: postgres=1.5.2
[0m19:08:05.579293 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:08:05.709495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:08:05.710496 [debug] [MainThread]: Partial parsing: updated file: flight_dbt://models\dimentions\dim_airport.sql
[0m19:08:05.753459 [debug] [MainThread]: 1603: static parser failed on dimentions\dim_airport.sql
[0m19:08:05.791193 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimentions\dim_airport.sql
[0m19:08:05.900912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268935BD9D0>]}
[0m19:08:05.919611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026893495A10>]}
[0m19:08:05.920640 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:08:05.922605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002688F178590>]}
[0m19:08:05.926144 [info ] [MainThread]: 
[0m19:08:05.929157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:08:05.934154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course'
[0m19:08:05.973536 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course"
[0m19:08:05.974519 [debug] [ThreadPool]: On list_flights_dbt_course: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m19:08:05.976031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:06.083060 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:08:06.087608 [debug] [ThreadPool]: On list_flights_dbt_course: Close
[0m19:08:06.093623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_dbt_course_flights_wh'
[0m19:08:06.104170 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:08:06.105771 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: BEGIN
[0m19:08:06.106706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:06.186913 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.187932 [debug] [ThreadPool]: Using postgres connection "list_flights_dbt_course_flights_wh"
[0m19:08:06.188926 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "list_flights_dbt_course_flights_wh"} */
select
      'flights_dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m19:08:06.203456 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:08:06.205455 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: ROLLBACK
[0m19:08:06.206917 [debug] [ThreadPool]: On list_flights_dbt_course_flights_wh: Close
[0m19:08:06.225936 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.229974 [debug] [MainThread]: On master: BEGIN
[0m19:08:06.231969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:06.313963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.315475 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.316488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:08:06.375864 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m19:08:06.381239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026892CEB590>]}
[0m19:08:06.383235 [debug] [MainThread]: On master: ROLLBACK
[0m19:08:06.383235 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.384228 [debug] [MainThread]: On master: BEGIN
[0m19:08:06.385796 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.386760 [debug] [MainThread]: On master: COMMIT
[0m19:08:06.387774 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:06.388793 [debug] [MainThread]: On master: COMMIT
[0m19:08:06.389785 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.390787 [debug] [MainThread]: On master: Close
[0m19:08:06.391789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:08:06.393791 [info ] [MainThread]: 
[0m19:08:06.404232 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_aircraft
[0m19:08:06.406761 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.dim_aircraft ..................... [RUN]
[0m19:08:06.410779 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flight_dbt.dim_aircraft'
[0m19:08:06.411781 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_aircraft
[0m19:08:06.420365 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_aircraft"
[0m19:08:06.422366 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (compile): 19:08:06.413785 => 19:08:06.421364
[0m19:08:06.423369 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_aircraft
[0m19:08:06.586842 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:08:06.587845 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

    
  
    

  create temporary table "dim_aircraft__dbt_tmp190806497493"
  
  
    as
  
  (
    

select ad.aircraft_code,ad.model,ad."range",ad.last_update as a_data_last_update,s.seat_no,s.fare_conditions 
,s.last_update as seats_last_update
,case 
	when ad."range" >5600 then 'high'
	when ad."range" <5600 then 'low'
	when ad."range" = 5600 then 'exactly_5600'
	else 'null'
end as range_desc
,ad.model -> 'en' as model_english
,ad.model -> 'ru' as model_russian
,'23-08-16 16:08:05' as run_time
from stg.aircrafts_data ad 
join stg.seats s on ad.aircraft_code = s.aircraft_code
  );
  
  
[0m19:08:06.589843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:08:06.708071 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m19:08:06.720601 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:08:06.722614 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: BEGIN
[0m19:08:06.724597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:06.726124 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:08:06.728152 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft__dbt_tmp190806497493'
        
      order by ordinal_position

  
[0m19:08:06.759368 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:08:06.768927 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:08:06.771936 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:08:06.779492 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:08:06.791805 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:08:06.792805 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:08:06.804342 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:08:06.858138 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_aircraft"
[0m19:08:06.860135 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:08:06.862131 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_aircraft"
            where (
                aircraft_code) in (
                select (aircraft_code)
                from "dim_aircraft__dbt_tmp190806497493"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_aircraft" ("aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time")
    (
        select "aircraft_code", "model", "range", "a_data_last_update", "seat_no", "fare_conditions", "seats_last_update", "range_desc", "model_english", "model_russian", "run_time"
        from "dim_aircraft__dbt_tmp190806497493"
    )
  
[0m19:08:06.877254 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m19:08:06.922430 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:08:06.924433 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_aircraft"} */

        insert into "flights_dbt_course"."flights_wh"."dim_aircraft"(aircraft_code) VALUES (-1)
      
[0m19:08:06.926636 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m19:08:06.928654 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:08:06.929653 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_aircraft"
[0m19:08:06.930657 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: COMMIT
[0m19:08:06.934660 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:06.937745 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_aircraft (execute): 19:08:06.423369 => 19:08:06.936738
[0m19:08:06.938763 [debug] [Thread-1 (]: On model.flight_dbt.dim_aircraft: Close
[0m19:08:06.941765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026892A19910>]}
[0m19:08:06.944765 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.53s]
[0m19:08:06.947287 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_aircraft
[0m19:08:06.949309 [debug] [Thread-1 (]: Began running node model.flight_dbt.dim_airport
[0m19:08:06.950303 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.dim_airport ...................... [RUN]
[0m19:08:06.954303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_aircraft, now model.flight_dbt.dim_airport)
[0m19:08:06.957354 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.dim_airport
[0m19:08:06.974056 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.dim_airport"
[0m19:08:06.979656 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (compile): 19:08:06.960383 => 19:08:06.978620
[0m19:08:06.983630 [debug] [Thread-1 (]: Began executing node model.flight_dbt.dim_airport
[0m19:08:07.014340 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:08:07.019959 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

    
  
    

  create temporary table "dim_airport__dbt_tmp190806998759"
  
  
    as
  
  (
    


select *
,airport_name  ->'en' as english_airport_name
,airport_name  ->'ru' as russian_airport_name
,city  ->'en' as english_city_name
,city  ->'ru' as russian_city_name
,'23-08-16 16:08:05' as run_time
from stg.airports_data
  );
  
  
[0m19:08:07.023927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:07.157500 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:08:07.166954 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:08:07.167952 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: BEGIN
[0m19:08:07.170957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.170957 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:08:07.171954 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport__dbt_tmp190806998759'
        
      order by ordinal_position

  
[0m19:08:07.205779 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:08:07.216263 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:08:07.218302 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:08:07.228846 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:08:07.233843 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:08:07.234845 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m19:08:07.243384 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m19:08:07.252921 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.dim_airport"
[0m19:08:07.253921 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:08:07.256455 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

      
        
            delete from "flights_dbt_course"."flights_wh"."dim_airport"
            where (
                airport_code) in (
                select (airport_code)
                from "dim_airport__dbt_tmp190806998759"
            );

        
    

    insert into "flights_dbt_course"."flights_wh"."dim_airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "english_airport_name", "russian_airport_name", "english_city_name", "russian_city_name", "run_time"
        from "dim_airport__dbt_tmp190806998759"
    )
  
[0m19:08:07.261973 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m19:08:07.266505 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:08:07.267503 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.dim_airport"} */

        insert into "flights_dbt_course"."flights_wh"."dim_airport"(airport_code) VALUES (-1)
      
[0m19:08:07.268500 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.0 seconds
[0m19:08:07.270497 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m19:08:07.271501 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.dim_airport"
[0m19:08:07.272502 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: COMMIT
[0m19:08:07.274501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:07.277032 [debug] [Thread-1 (]: Timing info for model.flight_dbt.dim_airport (execute): 19:08:06.985617 => 19:08:07.276017
[0m19:08:07.278048 [debug] [Thread-1 (]: On model.flight_dbt.dim_airport: Close
[0m19:08:07.280046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268935BF790>]}
[0m19:08:07.282045 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.dim_airport ................. [[32mINSERT 0 104[0m in 0.33s]
[0m19:08:07.284048 [debug] [Thread-1 (]: Finished running node model.flight_dbt.dim_airport
[0m19:08:07.286583 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_boarding_passes
[0m19:08:07.288594 [info ] [Thread-1 (]: 3 of 7 START sql table model flights_wh.fact_boarding_passes ................... [RUN]
[0m19:08:07.291599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.dim_airport, now model.flight_dbt.fact_boarding_passes)
[0m19:08:07.292599 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_boarding_passes
[0m19:08:07.302144 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_boarding_passes"
[0m19:08:07.304149 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (compile): 19:08:07.294603 => 19:08:07.304149
[0m19:08:07.305665 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_boarding_passes
[0m19:08:07.338343 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_boarding_passes"
[0m19:08:07.341342 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:08:07.342343 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: BEGIN
[0m19:08:07.344344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:07.431809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:07.432803 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:08:07.433802 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select bp.ticket_no,bp.flight_id,bp.boarding_no,bp.seat_no,
tf.fare_conditions,tf.amount,bp.last_update as bp_last_update,tf.last_update as tf_last_update
,'23-08-16 16:08:05' as run_time
from stg.boarding_passes bp
join stg.ticket_flights tf on bp.ticket_no=tf.ticket_no and bp.flight_id =tf.flight_id
  );
  
[0m19:08:11.524852 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 4.0 seconds
[0m19:08:11.541773 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:08:11.542773 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes" rename to "fact_boarding_passes__dbt_backup"
[0m19:08:11.544769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:11.554312 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:08:11.555908 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
alter table "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_tmp" rename to "fact_boarding_passes"
[0m19:08:11.559853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:11.578158 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:08:11.580171 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:08:11.581177 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: COMMIT
[0m19:08:11.590697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:11.603235 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_boarding_passes"
[0m19:08:11.604240 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_boarding_passes"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_boarding_passes__dbt_backup" cascade
[0m19:08:11.624294 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:08:11.628823 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_boarding_passes (execute): 19:08:07.306680 => 19:08:11.627823
[0m19:08:11.629820 [debug] [Thread-1 (]: On model.flight_dbt.fact_boarding_passes: Close
[0m19:08:11.631828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689369BF90>]}
[0m19:08:11.632822 [info ] [Thread-1 (]: 3 of 7 OK created sql table model flights_wh.fact_boarding_passes .............. [[32mSELECT 579686[0m in 4.34s]
[0m19:08:11.636336 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_boarding_passes
[0m19:08:11.637356 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_flights
[0m19:08:11.639375 [info ] [Thread-1 (]: 4 of 7 START sql table model flights_wh.fact_flights ........................... [RUN]
[0m19:08:11.643372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_boarding_passes, now model.flight_dbt.fact_flights)
[0m19:08:11.645378 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_flights
[0m19:08:11.658550 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_flights"
[0m19:08:11.662092 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (compile): 19:08:11.646918 => 19:08:11.661115
[0m19:08:11.664081 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_flights
[0m19:08:11.679225 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_flights"
[0m19:08:11.681221 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:08:11.682234 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: BEGIN
[0m19:08:11.683223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:11.785464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:11.786475 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:08:11.787476 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp"
  
  
    as
  
  (
    

with cte1 as 
(
select *,
ROUND((EXTRACT(EPOCH FROM (scheduled_arrival-scheduled_departure)) / 3600)::numeric, 2) AS flight_duration_expected
,ROUND((EXTRACT(EPOCH FROM (actual_arrival-actual_departure)) / 3600)::numeric, 2) AS flight_duration
from stg.flights 
)
, cte2 as 
(
select *,
case 
	when 	flight_duration_expected > flight_duration then 'shorter'
	when    flight_duration_expected < flight_duration then 'longer'
	when    flight_duration_expected = flight_duration then 'as_expected'
	else 'null'
end as actual_flight_duration
from cte1
)
select *,
'23-08-16 16:08:05' as run_time
from cte2
  );
  
[0m19:08:12.232896 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m19:08:12.236485 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:08:12.237487 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights" rename to "fact_flights__dbt_backup"
[0m19:08:12.238450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:12.242485 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:08:12.243485 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
alter table "flights_dbt_course"."flights_wh"."fact_flights__dbt_tmp" rename to "fact_flights"
[0m19:08:12.244448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:12.246965 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:08:12.247972 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:08:12.247972 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: COMMIT
[0m19:08:12.251009 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:12.254005 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_flights"
[0m19:08:12.254005 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_flights"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_flights__dbt_backup" cascade
[0m19:08:12.261521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:08:12.263806 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_flights (execute): 19:08:11.664081 => 19:08:12.263806
[0m19:08:12.264842 [debug] [Thread-1 (]: On model.flight_dbt.fact_flights: Close
[0m19:08:12.265809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689368B810>]}
[0m19:08:12.265809 [info ] [Thread-1 (]: 4 of 7 OK created sql table model flights_wh.fact_flights ...................... [[32mSELECT 33121[0m in 0.62s]
[0m19:08:12.269222 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_flights
[0m19:08:12.270219 [debug] [Thread-1 (]: Began running node model.flight_dbt.fact_tickets
[0m19:08:12.272218 [info ] [Thread-1 (]: 5 of 7 START sql table model flights_wh.fact_tickets ........................... [RUN]
[0m19:08:12.274232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_flights, now model.flight_dbt.fact_tickets)
[0m19:08:12.274232 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.fact_tickets
[0m19:08:12.283793 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.fact_tickets"
[0m19:08:12.285764 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (compile): 19:08:12.275739 => 19:08:12.284755
[0m19:08:12.286970 [debug] [Thread-1 (]: Began executing node model.flight_dbt.fact_tickets
[0m19:08:12.293972 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.fact_tickets"
[0m19:08:12.296494 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:08:12.297495 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: BEGIN
[0m19:08:12.298553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:12.360319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:12.360319 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:08:12.361861 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */

  
    

  create  table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp"
  
  
    as
  
  (
    

select t.*,b.book_date,b.total_amount 
,t.contact_data  -> 'phone' as phone_num
,t.contact_data  -> 'email' as email
,'23-08-16 16:08:05' as run_time
from stg.bookings b
join stg.tickets t on b.book_ref =t.book_ref
  );
  
[0m19:08:14.854281 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 2.0 seconds
[0m19:08:14.858807 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:08:14.858807 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets" rename to "fact_tickets__dbt_backup"
[0m19:08:14.860807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:14.863313 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:08:14.864321 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
alter table "flights_dbt_course"."flights_wh"."fact_tickets__dbt_tmp" rename to "fact_tickets"
[0m19:08:14.864321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:14.868850 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:08:14.869849 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:08:14.869849 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: COMMIT
[0m19:08:14.877455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:14.881454 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.fact_tickets"
[0m19:08:14.882456 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.fact_tickets"} */
drop table if exists "flights_dbt_course"."flights_wh"."fact_tickets__dbt_backup" cascade
[0m19:08:14.899138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:08:14.900138 [debug] [Thread-1 (]: Timing info for model.flight_dbt.fact_tickets (execute): 19:08:12.286970 => 19:08:14.900138
[0m19:08:14.901138 [debug] [Thread-1 (]: On model.flight_dbt.fact_tickets: Close
[0m19:08:14.902138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268929E6510>]}
[0m19:08:14.904140 [info ] [Thread-1 (]: 5 of 7 OK created sql table model flights_wh.fact_tickets ...................... [[32mSELECT 366733[0m in 2.63s]
[0m19:08:14.905647 [debug] [Thread-1 (]: Finished running node model.flight_dbt.fact_tickets
[0m19:08:14.905647 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_first_dbt_model
[0m19:08:14.906654 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m19:08:14.908656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.fact_tickets, now model.flight_dbt.my_first_dbt_model)
[0m19:08:14.908656 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_first_dbt_model
[0m19:08:14.911655 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_first_dbt_model"
[0m19:08:14.912656 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (compile): 19:08:14.908656 => 19:08:14.912656
[0m19:08:14.913659 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_first_dbt_model
[0m19:08:14.946812 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_first_dbt_model"
[0m19:08:14.948815 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:08:14.949814 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: BEGIN
[0m19:08:14.950815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:15.021219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:15.021219 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:08:15.022219 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:08:15.028773 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:08:15.032773 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:08:15.033774 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:08:15.034813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:15.039305 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:08:15.040302 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:08:15.042312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:15.045894 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:08:15.047846 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:08:15.048846 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: COMMIT
[0m19:08:15.050838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:15.054837 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_first_dbt_model"
[0m19:08:15.056345 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_first_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m19:08:15.058354 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:08:15.060354 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_first_dbt_model (execute): 19:08:14.914656 => 19:08:15.060354
[0m19:08:15.061352 [debug] [Thread-1 (]: On model.flight_dbt.my_first_dbt_model: Close
[0m19:08:15.062353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026893446410>]}
[0m19:08:15.063861 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.15s]
[0m19:08:15.064871 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_first_dbt_model
[0m19:08:15.065876 [debug] [Thread-1 (]: Began running node model.flight_dbt.my_second_dbt_model
[0m19:08:15.068251 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m19:08:15.069248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flight_dbt.my_first_dbt_model, now model.flight_dbt.my_second_dbt_model)
[0m19:08:15.071253 [debug] [Thread-1 (]: Began compiling node model.flight_dbt.my_second_dbt_model
[0m19:08:15.077807 [debug] [Thread-1 (]: Writing injected SQL for node "model.flight_dbt.my_second_dbt_model"
[0m19:08:15.080819 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (compile): 19:08:15.071253 => 19:08:15.079818
[0m19:08:15.080819 [debug] [Thread-1 (]: Began executing node model.flight_dbt.my_second_dbt_model
[0m19:08:15.088999 [debug] [Thread-1 (]: Writing runtime sql for node "model.flight_dbt.my_second_dbt_model"
[0m19:08:15.090001 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:08:15.090996 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: BEGIN
[0m19:08:15.090996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:15.155736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:08:15.156748 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:08:15.157749 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */

  create view "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_dbt_course"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m19:08:15.163327 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:08:15.167872 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:08:15.169873 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
alter table "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:08:15.170862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:08:15.173858 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:08:15.173858 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:08:15.174858 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: COMMIT
[0m19:08:15.177075 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:08:15.180108 [debug] [Thread-1 (]: Using postgres connection "model.flight_dbt.my_second_dbt_model"
[0m19:08:15.180108 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "flight_dbt", "target_name": "dev", "node_id": "model.flight_dbt.my_second_dbt_model"} */
drop view if exists "flights_dbt_course"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m19:08:15.181103 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:08:15.183073 [debug] [Thread-1 (]: Timing info for model.flight_dbt.my_second_dbt_model (execute): 19:08:15.081864 => 19:08:15.183073
[0m19:08:15.184074 [debug] [Thread-1 (]: On model.flight_dbt.my_second_dbt_model: Close
[0m19:08:15.184074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816d4a8e-4ade-4328-b7be-d4aa99b8e11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026893444AD0>]}
[0m19:08:15.186589 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.12s]
[0m19:08:15.188590 [debug] [Thread-1 (]: Finished running node model.flight_dbt.my_second_dbt_model
[0m19:08:15.190627 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:15.190627 [debug] [MainThread]: On master: BEGIN
[0m19:08:15.191624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:08:15.263704 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:08:15.264718 [debug] [MainThread]: On master: COMMIT
[0m19:08:15.265723 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:15.265723 [debug] [MainThread]: On master: COMMIT
[0m19:08:15.266942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:08:15.267959 [debug] [MainThread]: On master: Close
[0m19:08:15.268951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:15.269952 [debug] [MainThread]: Connection 'list_flights_dbt_course' was properly closed.
[0m19:08:15.270952 [debug] [MainThread]: Connection 'list_flights_dbt_course_flights_wh' was properly closed.
[0m19:08:15.270952 [debug] [MainThread]: Connection 'model.flight_dbt.my_second_dbt_model' was properly closed.
[0m19:08:15.271951 [info ] [MainThread]: 
[0m19:08:15.273961 [info ] [MainThread]: Finished running 2 incremental models, 3 table models, 2 view models in 0 hours 0 minutes and 9.34 seconds (9.34s).
[0m19:08:15.277484 [debug] [MainThread]: Command end result
[0m19:08:15.291922 [info ] [MainThread]: 
[0m19:08:15.297527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:08:15.316622 [info ] [MainThread]: 
[0m19:08:15.329233 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:08:15.348401 [debug] [MainThread]: Command `dbt run` succeeded at 19:08:15.348401 after 10.04 seconds
[0m19:08:15.350401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268926923D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026893438090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268907F6950>]}
[0m19:08:15.351400 [debug] [MainThread]: Flushing usage events
